<!DOCTYPE html>
<html>
<head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
<style>
<style>
#myProgress {
  width: 100%;
  background-color: #ddd;
}

#myBar {
  width: 1%;
  height: 30px;
  background-color: #04AA6D;
}
</style>
</head>
<body>
<!--
<h1>Download Today's paper </h1>

<button type="button" onclick="downloadTodaysMint()">Click Here for Today's Mint</button>

<p>
<button type="button" onclick="downloadTodaysHT()">Click Here for Today's HindustanTimes</button>

-->

<h1> Download Previous Editions </h1>

<p>

<form action="#" onsubmit="downloadPrevMintFile()">
  <label><strong>Download Mint:</label>
  <input type="date" id="prevdateMint" value="">
   <button type="button" onclick="downloadPrevMintFile()">Click Here for Previous Edition of Mint</button>
  <!-- input type="submit" -->
</form>
<p>
<p>
<!-- 
<form action="#" onsubmit="downloadPrevHTFile()" >
  <label><strong>Download HT   :  </label>
  <input type="date" id="prevdateHT" value="">
  <button type="button" onclick="downloadPrevHTFile()">Click Here for Previous Edition of HT</button>
  <!-- input type="submit" -->
<!-- /form -->
<p>
<div id="spinner"></div> 
<p>
<div id="myProgress">
  <div id="myBar"></div>
</div>

<p><strong>Note:</strong> type="date" is not supported in Safari or Internet Explorer 11 (or earlier).</p>


<script>

function downloadFile(urlToSend) {
     var req = new XMLHttpRequest();
     req.open("GET", urlToSend, true);
     req.responseType = "blob";
     req.onload = function (event) {
         var blob = req.response;
         var fileName = 'MINT-13/09/2021'
         var link=document.createElement('a');
		 link.setAttribute("id", "id1");
         link.href=window.URL.createObjectURL(blob);
         link.download=fileName;
         link.click();
     };

     req.send();
 }
 

 function downloadPrevMintFile() {

	 var date = new Date(document.getElementById('prevdateMint').value);
     var req = new XMLHttpRequest();
	 var i = 0;
	 req.addEventListener('progress', function(e) {
	 var percent_complete = (e.loaded / e.total)*100;
	 if (i == 0) {
		i = 1;
		var elem = document.getElementById("myBar");
		var width = 1;
		var id = setInterval(frame, 10);
		function frame() {
			if (width >= 100) {
				clearInterval(id);
				i = 0;
			} else {
				width++;
				elem.style.width = width + "%";
			}
		}	
		}
		document.getElementById("spinner").innerHTML =percent_complete;
		console.log(percent_complete);
	 });
	 var urltosend = "https://epaper.livemint.com/Home/Download?id=1&type=5&EditionId=1&Date=";
	 urltosend = urltosend.concat(formatDate(date));
     req.open("GET", urltosend, true);
     req.responseType = "blob";
     req.onload = function (event) {
         var blob = req.response;
         var fileName = 'MINT-';
		 fileName = fileName.concat(formatDate(date));
         var link=document.createElement('a');
		 link.setAttribute("id", "id1");
         link.href=window.URL.createObjectURL(blob);
         link.download=fileName;
         link.click();
		 return false;
     };
     req.send();
 }
 
  function downloadPrevHTFile() {

	 var date = new Date(document.getElementById('prevdateHT').value);
     var req = new XMLHttpRequest();
	 var i = 0;
	 req.addEventListener('progress', function(e) {
		var percent_complete = (e.loaded / e.total)*100;
		if (i == 0) {
		i = 1;
		var elem = document.getElementById("myBar");
		var width = 1;
		var id = setInterval(frame, 10);
		function frame() {
			if (width >= 100) {
				clearInterval(id);
				i = 0;
			} else {
				width++;
				elem.style.width = width + "%";
			}
		}	
		}
		document.getElementById("spinner").innerHTML =percent_complete;
		console.log(percent_complete);
	 });
	 var urltosend = "https://epaper.hindustantimes.com/Home/Download?id=1&type=5&EditionId=1&Date=";
	 urltosend = urltosend.concat(formatDate(date));
     req.open("GET", urltosend, true);
     req.responseType = "blob";
     req.onload = function (event) {
         var blob = req.response;
         var fileName = 'HT-';
		 fileName = fileName.concat(formatDate(date));
         var link=document.createElement('a');
		 link.setAttribute("id", "id1");
         link.href=window.URL.createObjectURL(blob);
         link.download=fileName;
         link.click();
     };
     req.send();
 }
 
 function downloadTodaysMint() {
	 var date = new Date();
     var req = new XMLHttpRequest();
	 var urltosend = "https://epaper.livemint.com/Home/Download?id=1&type=5&EditionId=1&Date=";
	 urltosend = urltosend.concat(formatDate(date));
     req.open("GET", urltosend, true);
     req.responseType = "blob";
     req.onload = function (event) {
         var blob = req.response;
         var fileName = 'MINT-';
		 fileName = fileName.concat(formatDate(date));
         var link=document.createElement('a');
		 link.setAttribute("id", "id1");
         link.href=window.URL.createObjectURL(blob);
         link.download=fileName;
         link.click();
     };
     req.send();
 }
 
  function downloadTodaysHT() {
	 var date = new Date();
     var req = new XMLHttpRequest();
	 var urltosend = "https://epaper.hindustantimes.com/Home/Download?id=1&type=5&EditionId=1&Date=";
	 urltosend = urltosend.concat(formatDate(date));
     req.open("GET", urltosend, true);
     req.responseType = "blob";
     req.onload = function (event) {
         var blob = req.response;
         var fileName = 'HT-';
		 fileName = fileName.concat(formatDate(date));
         var link=document.createElement('a');
		 link.setAttribute("id", "id1");
         link.href=window.URL.createObjectURL(blob);
         link.download=fileName;
         link.click();
     };
     req.send();
 }
 

 
 function formatDate(date) {
    var d = new Date(date),
        month = '' + (d.getMonth() + 1),
        day = '' + d.getDate(),
        year = d.getFullYear();

    if (month.length < 2) 
        month = '0' + month;
    if (day.length < 2) 
        day = '0' + day;

    //return [year, month, day].join('/');
	return [day, month, year].join('/');
}

function getDate() {
  var today = new Date();
  var dd = today.getDate();
  var mm = today.getMonth()+1; 
  var yyyy = today.getFullYear();

  if(dd<10) {
      dd = '0'+dd
  } 

  if(mm<10) {
      mm = '0'+mm
  } 

  //today = yyyy + '/' + mm + '/' + dd;
  today = mm + '/' + dd + '/' + yyyy;
  console.log(today);
  document.getElementById("prevdateMint").value = today;
  document.getElementById("prevdateHT").value = today;
}


window.onload = function() {
  getDate();
  document.getElementById("prevdateMint").valueAsDate = new Date();
  document.getElementById("prevdateHT").valueAsDate = new Date();
};

</script>

</body>
</html>