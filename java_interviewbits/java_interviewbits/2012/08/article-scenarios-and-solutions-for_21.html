<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<head>
  <title>Java-Success Blog: Article: Scenarios and solutions for better concurrency and thread safety part-2 CountDownLatch and CyclicBarrier</title>

  <link href='http://www.java-success.com' rel='canonical'/>

  


  <script type="text/javascript">(function() { (function(){function c(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(l){}};this.tick("start",null,a)}var a,e;window.performance&&(e=(a=window.performance.timing)&&a.responseStart);var h=0<e?new c(e):new c;window.jstiming={Timer:c,load:h};if(a){var b=a.navigationStart;0<b&&e>=b&&(window.jstiming.srt=e-b)}if(a){var d=window.jstiming.load;0<b&&e>=b&&(d.tick("_wtsrt",void 0,b),d.tick("wtsrt_","_wtsrt",
e),d.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),d&&0<b&&(d.tick("_tbnd",void 0,window.chrome.csi().startE),d.tick("tbnd_","_tbnd",b))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,d&&0<b&&(d.tick("_tbnd",void 0,window.external.startE),d.tick("tbnd_","_tbnd",b))),a&&(window.jstiming.pt=a)}catch(k){}})();window.tickAboveFold=function(c){var a=0;if(c.offsetParent){do a+=c.offsetTop;while(c=c.offsetParent)}c=a;750>=c&&window.jstiming.load.tick("aft")};var f=!1;function g(){f||(f=!0,window.jstiming.load.tick("firstScrollTime"))}window.addEventListener?window.addEventListener("scroll",g,!1):window.attachEvent("onscroll",g);
 })();</script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="Blogger" />
<link rel="icon" type="image/vnd.microsoft.icon" href="https://www.blogger.com/favicon.ico"/>
<link rel="alternate" type="application/atom+xml" title="Java-Success Blog - Atom" href="http://java-success.blogspot.com/feeds/posts/default" />
<link rel="alternate" type="application/rss+xml" title="Java-Success Blog - RSS" href="http://java-success.blogspot.com/feeds/posts/default?alt=rss" />
<link rel="service.post" type="application/atom+xml" title="Java-Success Blog - Atom" href="https://www.blogger.com/feeds/35897879/posts/default" />
<link rel="alternate" type="application/atom+xml" title="Java-Success Blog - Atom" href="http://java-success.blogspot.com/feeds/550338554755693482/comments/default" />
<link rel="stylesheet" type="text/css" href="https://www.blogger.com/static/v1/v-css/50269083-blog_controls.css"/>
<link rel="stylesheet" type="text/css" href="https://www.blogger.com/dyn-css/authorization.css?targetBlogID=35897879&zx=32ffd7df-5810-469f-a666-048e5011b3eb"/>
<script type="text/javascript" src="https://www.blogger.com/static/v1/v-js/979395223-backlink.js"></script>
<script type="text/javascript" src="https://www.blogger.com/static/v1/v-js/4080670514-backlink_control.js"></script>
<script type="text/javascript">var BL_backlinkURL = "https://www.blogger.com/dyn-js/backlink_count.js";var BL_blogId = "35897879";</script>


  <style type="text/css">
/*
-----------------------------------------------
Blogger Template Style
Name:     Harbor
Designer: Douglas Bowman
URL:      www.stopdesign.com
Date:     24 Feb 2004
----------------------------------------------- */


body {
  background:#fff url("http://www.blogblog.com/harbor/rocks.jpg") no-repeat right bottom;
  background-attachment:fixed;
  margin:0;
  padding:0;
  font:x-small Georgia,Serif;
  color:#333;
  font-size/* */:/**/small;
  font-size: /**/small;
  }
/* Commented Backslash Hack hides rule from IE5-Mac \*/
  body {background-attachment:scroll;}
  /* End IE5-Mac hack */
a:link {
  color:#36a;
  text-decoration:none;
  }
a:visited {
  color:#764;
  text-decoration:none;
  }
a:hover {
  color:#933;
  text-decoration:underline;
  }
a img {
  border-width:0;
  }


/* Page Structure
----------------------------------------------- */
#wrap {
  background:url("http://www.blogblog.com/harbor/sky.jpg") repeat-x left top;
  min-width:740px;
  margin:0;
  padding:0;
  text-align:left;
  }
#wrap2 {
  background:url("http://www.blogblog.com/harbor/lighthouse.jpg") no-repeat left top;
  }
#wrap3 {
  background:url("http://www.blogblog.com/harbor/cloud.jpg") no-repeat 100% 75px;
  }
#wrap4 {
  background:url("http://www.blogblog.com/harbor/center_cloud.jpg") no-repeat 50% 0;
  padding:15px;
  width:100%;
  width/* */:/**/auto;
  width: /**/auto;
  }
@media all {
  #content {
    max-width:890px;
    padding:0 30px 50px;
    width:100%;
    width/* */:/**/auto;
    width: /**/auto;
    }
  html>body #content {
    border:3px double #fff;
    }
  #main {
    width:64%;
    float:right;
    }
  #main2 {
    margin:0;
    padding:0;
    }
  #sidebar {
    width:32%;
    float:left;
    }
  #sidebar2 {
    margin:0;
    padding:170px 0 20px;
    }
  }
@media handheld {
  #content {
    width:90%;
    }
  #main {
    width:100%;
    float:none;
    }
  #sidebar {
    width:100%;
    float:none;
    }
  }

/* Header
----------------------------------------------- */
@media all {
  #header {
    padding:15px 0 10px 110px;
    }
  }
@media handheld {
  #header {
    width:100%;
    padding:15px 0 10px 0;
    }
  }
#blog-title {
  margin:0 0 .25em;
  font-size:270%;
  font-weight:normal;
  color:#678;
  }
#blog-title a {
  color:#678;
  text-decoration:none;
  }
#description {
  margin:0;
  max-width:700px;
  font-size:75%;
  line-height:1.8em;
  text-transform:uppercase;
  letter-spacing:.2em;
  color:#789;
  }


/* Headings
----------------------------------------------- */
h2 {
  margin:1.5em 0 .75em;
  font:78%/1.4em Georgia,Serif;
  text-transform:uppercase;
  letter-spacing:.2em;
  color:#933;
  }


/* Posts
----------------------------------------------- */
.date-header {
  margin:2em 0 .5em;
  }
.post {
  margin:.5em 0 1.5em;
  line-height:1.6em;
  }
.post-title {
  margin:.25em 0 0;
  padding:0 0 4px;
  font-size:140%;
  font-weight:normal;
  line-height:1.4em;
  }
.post-title a, .post-title strong {
  background:url("http://www.blogblog.com/harbor/icon_lighthouse.gif") no-repeat 0 .15em;
  display:block;
  padding-left:20px;
  text-decoration:none;
  color:#368;
  font-weight:normal;
  }
.post-title strong {
  background-image:url("http://www.blogblog.com/harbor/icon_lighthouse2.gif");
  color:#000;
  }
.post-title a:hover {
  color:#933;
  }
.post-body {
  background:url("http://www.blogblog.com/harbor/divider.gif") no-repeat center top;
  padding-top:12px;
  }
.post p {
  margin:0 0 .75em;
  }
p.post-footer {
  color:#999;
  }
.post-footer em, .comment-link {
  font:78%/1.4em Georgia,Serif;
  text-transform:uppercase;
  letter-spacing:.1em;
  }
.post-footer em {
  font-style:normal;
  color:#666;
  margin-right:.4em;
  }
.comment-link strong {
  font-size:130%;
  }
.comment-link {
  margin-left:.4em;
  }
.post img {
  padding:4px;
  border:1px solid #cde;
  }


/* Comments
----------------------------------------------- */
#comments {
  background:url("http://www.blogblog.com/harbor/divider.gif") no-repeat center top;
  padding:15px 0 0;
  }
#comments h4 {
  margin:1em 0;
  font:bold 78%/1.6em Georgia,Serif;
  text-transform:uppercase;
  letter-spacing:.2em;
  color:#933;
  }
#comments h4 strong {
  font-size:130%;
  }
#comments-block {
  margin:1em 0 1.5em;
  line-height:1.4em;
  }
#comments-block dt {
  margin:.5em 0;
  }
#comments-block dd {
  margin:.25em 20px 0;
  }
#comments-block dd.comment-timestamp {
  margin:-.25em 20px 1.5em;
  font:78%/1.4em Georgia,Serif;
  text-transform:uppercase;
  letter-spacing:.1em;
  }
#comments-block dd p {
  margin:0 0 .75em;
  }
.deleted-comment {
  font-style:italic;
  color:gray;
  }


/* Sidebar Content
----------------------------------------------- */
#sidebar ul {
  background:url("http://www.blogblog.com/harbor/divider.gif") no-repeat center bottom;
  margin:0 0 15px;
  padding:0 0 15px;
  list-style:none;
  }
#sidebar li {
  margin:0;
  padding:0 0 .25em 15px;
  text-indent:-15px;
  line-height:1.5em;
  }
#sidebar p {
  color:#666;
  line-height:1.5em;
  }


/* Profile
----------------------------------------------- */
#profile-container {
  background:url("http://www.blogblog.com/harbor/divider.gif") no-repeat center bottom;
  margin:0 0 2em;
  padding:0 0 15px;
  }
.profile-datablock {
  margin:.5em 0 .5em;
  }
.profile-img {
  display:inline;
  }
.profile-img img {
  float:left;
  padding:4px;
  border:1px solid #cde;
  margin:0 8px 3px 0;
  }
.profile-data {
  margin:0;
  font:bold 78%/1.6em Georgia,Serif;
  text-transform:uppercase;
  letter-spacing:.1em;
  }
.profile-data strong {
  display:none;
  }
.profile-textblock {
  margin:0 0 .5em;
  }
.profile-link {
  font:78%/1.4em Georgia,Serif;
  text-transform:uppercase;
  letter-spacing:.1em;
  }


/* Footer
----------------------------------------------- */
#footer {
  clear:both;
  padding:15px 30px 0 50px;
  }
#footer hr {
  display:none;
  }
#footer p {
  background:url("http://www.blogblog.com/harbor/divider.gif") no-repeat center top;
  margin:0;
  padding-top:15px;
  font:78%/1.6em Georgia,Serif;
  text-transform:uppercase;
  letter-spacing:.1em;
  }


/* Feeds
----------------------------------------------- */
#blogfeeds {
  }
#postfeeds {
  }
  </style>
<!-- --><style type="text/css">@import url(https://www.blogger.com/static/v1/v-css/navbar/3334278262-classic.css);
div.b-mobile {display:none;}
</style>

</head>

<body><script type="text/javascript">
    function setAttributeOnload(object, attribute, val) {
      if(window.addEventListener) {
        window.addEventListener('load',
          function(){ object[attribute] = val; }, false);
      } else {
        window.attachEvent('onload', function(){ object[attribute] = val; });
      }
    }
  </script>
<div id="navbar-iframe-container"></div>
<script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>
<script type="text/javascript">
      gapi.load("gapi.iframes:gapi.iframes.style.bubble", function() {
        if (gapi.iframes && gapi.iframes.getContext) {
          gapi.iframes.getContext().openChild({
              url: 'https://www.blogger.com/navbar.g?targetBlogID\x3d35897879\x26blogName\x3dJava-Success+Blog\x26publishMode\x3dPUBLISH_MODE_BLOGSPOT\x26navbarType\x3dBLUE\x26layoutType\x3dCLASSIC\x26searchRoot\x3dhttp://java-success.blogspot.com/search\x26blogLocale\x3den\x26v\x3d2\x26homepageUrl\x3dhttp://java-success.blogspot.com/\x26vt\x3d2978101103701820782',
              where: document.getElementById("navbar-iframe-container"),
              id: "navbar-iframe"
          });
        }
      });
    </script>

<!-- Begin wraps -->

<div id="wrap"><div id="wrap2"><div id="wrap3"><div id="wrap4">


<!-- Begin #content -->
<div id="content">


<div id="header">

  <h1 id="blog-title">
    <a href="http://java-success.blogspot.in/">
	Java-Success Blog
	</a>
  </h1>

  <p id="description">Java/JEE blog containing interview questions and answers and tutorials</p>

</div>


<!-- Begin #main -->
<div id="main"><div id="main2">

<div class='adsense' style='text-align:center; padding: 0px 3px 0.5em 3px;'>
<script type="text/javascript"><!--
google_ad_client="pub-3764234023451771";
google_ad_host="pub-1556223355139109";
google_ad_width=468;
google_ad_height=60;
google_ad_format="468x60_as";
google_ad_type="text";
google_color_border="FFFFFF";
google_color_bg="FFFFFF";
google_color_link="333333";
google_color_url="009900";
google_color_text="993333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>



</div>

<!-- Search Google -->
<center>
<form method="get" action="http://www.google.com/custom" target="_top">
<table bgcolor="#ffffff">
<tr><td nowrap="nowrap" valign="top" align="left" height="32">
<a href="http://www.google.com/">
<img src="http://www.google.com/logos/Logo_25wht.gif" border="0" alt="Google" align="middle"></img></a>
<label for="sbi" style="display: none">Enter your search terms</label>
<input type="text" name="q" size="31" maxlength="255" value="" id="sbi"></input>
<label for="sbb" style="display: none">Submit search form</label>
<input type="submit" name="sa" value="Search" id="sbb"></input>
<input type="hidden" name="client" value="pub-3764234023451771"></input>
<input type="hidden" name="forid" value="1"></input>
<input type="hidden" name="ie" value="ISO-8859-1"></input>
<input type="hidden" name="oe" value="ISO-8859-1"></input>
<input type="hidden" name="cof" value="GALT:#008000;GL:1;DIV:#336699;VLC:663399;AH:center;BGC:FFFFFF;LBGC:336699;ALC:0000FF;LC:0000FF;T:000000;GFNT:0000FF;GIMP:0000FF;FORID:1"></input>
<input type="hidden" name="hl" value="en"></input>
</td></tr></table>
</form>
</center>
<!-- Search Google -->









<script type="text/javascript"><!--
google_ad_client = "pub-3764234023451771";
google_ad_host = "pub-1556223355139109";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al";
google_ad_channel = "";
//-->
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>


  <h2 class="date-header">Aug 22, 2012</h2>

  
  
     
  <!-- Begin .post -->
  <div class="post"><a name="550338554755693482"></a>
    
         
    


    <h3 class="post-title">
	 
	 Article: Scenarios and solutions for better concurrency and thread safety part-2 CountDownLatch and CyclicBarrier
	 
    </h3>

    
     
    <div class="post-body">
    <p>
      <div style="clear:both;"></div>There are other<b> real life scenarios </b>where the java.util.concurrent package with the following classes can be put to great use.<br />
<ul>
<li><b>CountDownLatch</b></li>
<li><b>CyclicBarrier</b></li>
</ul>
Here are some real life scenarios discusssed below to make use of the above classes.<br />
<br />
<span style="font-size: large;"><b>Scenario</b></span>: A main thread creates 3 database connections and assigns each of those connection to  3 different child threads that are spawned from the main thread. The main thread must wait while all the child threads are completed and then close all the database connections. So, how will you accomplish this?<br />
<br />
<b><span style="font-size: large;">Solution</span></b>: This where the <b><i>CountDownLatch </i></b>comes in handy as you already know that there are finite (i.e 3) number of threads. &nbsp;<i>CountDownLatch </i>can be used by the main thread to wait on the child threads. A <i>CountDownLatch </i>will be created with 3 being the count.<br />
<br />
<pre class="brush: csharp">CountDownLatch countDownLatch = new CountDownLatch(MAX_THREADS);
</pre>
<br />
The main thread will spawn new threads and wait on the count to reach 0 with the awit( ) method.

<br />
<br />
<pre class="brush: csharp">countDownLatch.await();
</pre>
<br />
As the each child thread process within the run( ) method, as the child thread completes processing, the count can be decremented with

<br />
<br />
<pre class="brush: csharp">countDownLatch.countDown(); 
</pre>
<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="http://1.bp.blogspot.com/-mZQ-e_soHnk/UDLrO2T1zRI/AAAAAAAAAtg/dV0FchvipPE/s1600/CountDownLatches.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="474" src="http://1.bp.blogspot.com/-mZQ-e_soHnk/UDLrO2T1zRI/AAAAAAAAAtg/dV0FchvipPE/s640/CountDownLatches.jpg" width="640" /></a></div>
<br />
<br />
<br />
Here is a simplified example where the worker threads wait for all the other worker threads to start with the <b>startSignal </b>and the main thread waits for all the worker threads to complete with a <b>stopSignal </b>as illustrated in the above diagram&nbsp;. Firstly, define a worker thread class.<br />
<br />
<br />
<pre class="brush: csharp">import java.util.concurrent.CountDownLatch;

public class Worker implements Runnable {
 
    private CountDownLatch startLatch;
    private CountDownLatch stopLatch;

    public Worker(CountDownLatch startLatch, CountDownLatch stopLatch) {
       this.startLatch = startLatch;
       this.stopLatch = stopLatch;
    }

    @Override
    public void run() {
        try {
            startLatch.await(); // wait until the latch has counted down to zero
            System.out.println("Running: " + Thread.currentThread().getName());
        } catch (InterruptedException ex)  {
            ex.printStackTrace();
        }
        finally {
         //count down to let the main thread to continue once the count reaches 0 from MAX_THREADS (i.e. 5)
         stopLatch.countDown(); 
        }
 }

}
</pre>
<br />
<br />
Finally, define the <i>WaitForAllThreadsToStart </i>class that creates the worker thread.

<br />
<br />
<pre class="brush: csharp">import java.util.concurrent.CountDownLatch;

public class WaitForAllThreadsToStart {
 
 private static final int MAX_THREADS = 3;
 
 public static void main(String[] args) throws Exception {
     CountDownLatch startSignal = new CountDownLatch(1);   //count down from 1 to 0
     CountDownLatch stopSignal = new CountDownLatch(MAX_THREADS); // count down from 3 to 0
        
     System.out.println("The main thread is going to spawn " +&nbsp;MAX_THREADS  + " worker threads.....");  
     for (int i = 1; i &lt;= MAX_THREADS; i++) {
        Thread t = new Thread(new Worker(startSignal,stopSignal), "thread-" + i);
        Thread.sleep(300);
        t.start();
        System.out.println("Started: " + t.getName() + " but waits for other threads to start.");
     }
        
     //count down the start signal from 1 to 0, so that the waiting worker threads can start executing 
     startSignal.countDown();
     System.out.println("worker threads can now start executing as all worker threads have started.....");
     try{       
        stopSignal.await(); // wait for the worker threads to complete by counting down the stopLatch
     } catch (InterruptedException ex){
        ex.printStackTrace();
     }
     System.out.println("finished executing the worker threads and the main thread is continuing.");
     System.out.println("The main thread can execute any task here.");
        
 }
}
</pre>
<br />
<br />
The output will like:

<br />
<br />
<pre class="brush: csharp">The main thread is going to spawn 3 worker threads.....
Started: thread-1 but waiting for other threads to start.
Started: thread-2 but waiting for other threads to start.
Started: thread-3 but waiting for other threads to start.
worker threads can now start executing as all worker threads have started.....
Running: thread-1
Running: thread-3
Running: thread-2
finished executing the worker threads and the main thread is continuing.
The main thread can execute any task here.
</pre>
<br />
<br />
<span style="font-size: large;"><b>Scenario:</b></span> What if the above scenario has a specific requirement where the 3 children threads need to wait between each other? For example, if each of the 3 threads need to perform 2 tasks. Before the task 2 can be started by a thread, all the 3 child threads must finish task 1. The task 1 can be reading data from the database and task 2 could be performing some computation and finally these computations need to be consolidated and written back by a single thread.<br />
<br />
<span style="font-size: large;"><b>Solution:</b></span> &nbsp;A <b>CyclicBarrier </b>can be used if the number of children threads are know upfront and to implement waiting amongst child threads until all of them finish. &nbsp;This is useful where parallel threads need to perform a job which requires sequential execution. It has methods like cyclicBarrier.await( ) and cyclicBarrier.reset( );<br />
<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="http://1.bp.blogspot.com/-lMaMCIoIlUU/UDNElVSKzXI/AAAAAAAAAt8/6KygXoVtY-o/s1600/CyclicBarrier.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="306" src="http://1.bp.blogspot.com/-lMaMCIoIlUU/UDNElVSKzXI/AAAAAAAAAt8/6KygXoVtY-o/s640/CyclicBarrier.jpg" width="640" /></a></div>
<br />
<br />
Here is the simplified code to improve understanding. Firstly the <i>WorkerTask </i> thread.<br />
<br />
<br />
<pre class="brush: csharp">import java.util.concurrent.BrokenBarrierException;
import java.util.concurrent.CyclicBarrier;

public class WorkerTask implements Runnable {
 
 private CyclicBarrier barrier;
  
 public WorkerTask(CyclicBarrier barrier) {
  this.barrier = barrier;
 }

 @Override
 public void run() {
   String threadName = Thread.currentThread().getName();
   try {
         System.out.println(threadName + " is now performing Task-A");
         barrier.await();      //barrier point for all threads to finish Task-A
           
         System.out.println(threadName + " is now performing Task-B");
         barrier.await();     //barrier point for all threads to finish Task-B 
           
   } catch (BrokenBarrierException ex)  {
         ex.printStackTrace();
   } catch (InterruptedException e) {
      e.printStackTrace();
   }
  }
}
</pre>
<br />
<br />
Now, the test class that creates the worker threads to perform Tasak-A and Task-B, and the barrier thread for consolidation work.
<br />
<br />
<pre class="brush: csharp">import java.util.concurrent.CyclicBarrier;

public class WaitForBarrierPoint {
 
 private static final int MAX_THREADS = 3;
 private static final int NO_OF_TASKS = 2;    //Task-A and Task-B
 
 private static int taskCount = 0;
 
 //new worker thread that monitors the barrier condition, i.e. 
 //MAX_THREADS that complete a task, and performs the consolidation task.</pre>
<pre class="brush: csharp"> //This is an anonymous inner class in action
 private static CyclicBarrier cb = new CyclicBarrier(MAX_THREADS, new Runnable() {
 
   @Override
   public void run() {
     System.out.println("All " + MAX_THREADS + " threads have reached the barrier point.");
     ++taskCount;
   
     //the consolidation job starts only after both tasks are completed.
     if(taskCount == NO_OF_TASKS) {
      System.out.println("The consolidation job can start now .... ");
   }
  }
 }); 
 
 
 public static void main(String[] args) {
  Thread t = null;
  //create 3 worker threads
  for (int i = 1; i &lt;= MAX_THREADS; i++) {
   t = new Thread(new WorkerTask(cb), "Thread-" + i);
   t.start();
  }
  
  System.out.println("The main thread ends here.");
 }
 
}

</pre>
<br />
<table>
<tbody>
<tr>

<td width="25%"><script type="text/javascript"><!--
google_ad_client = "ca-pub-3764234023451771";
/* LHS - vertical bar */
google_ad_slot = "9570018680";
google_ad_width = 160;
google_ad_height = 600;
google_ad_channel ="9570018680";
//-->
</script>
<script src="http://pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script>

</td>

<td width="75%"><b>Q.</b> Why is it called a cyclic barrier?<br />
<b>A.</b>&nbsp;Because it acts as a<b> barrier point</b> for a number of worker threads to wait for each other to complete their tasks.&nbsp;The barrier is called cyclic because it can be<b> re-used </b>after all the waiting worker threads are released for the next barrier point.<br />
<br />
A barrier is constructed with the following arguments to a constructor.<br />
<ul>
<li>the number of threads that will be participating in the parallel operation.</li>
<li>an optional, amalgamation or consolidation &nbsp;routine to be run at the end of each step or iteration.</li>
</ul>
At each step (or iteration) of the operation:<br />
<ul>
<li>each thread carries out its portion of the work to complete that step.</li>
<li>after doing its portion of the work, each thread calls the barrier's await ( ) method.</li>
<li>the await( ) method returns only when&nbsp;</li>
</ul>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -- all 3 threads have called await( ).<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -- the amalgamation or consolidation &nbsp;method has run (the barrier calls this on the last thread to call<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; await( ) before&nbsp;releasing the awaiting threads).<br />
<br />
if any of the 3 threads is interrupted or times out while waiting for the barrier, then the barrier is "broken" and all other waiting threads receive a <b><i>BrokenBarrierException</i></b>. This will&nbsp; propagate to all threads and for the other steps to halt, or for the steps to be interrupted externally by interrupting just one of the threads.<br />
<br />
<b>Q.</b> So, when to use a CountDownLatch and when to use a &nbsp;CyclicBarrier?<br />
<b>A.&nbsp;</b>A <b>CountDownLatch </b>is initialized with a counter. Threads can then either count down on the latch or wait for it to reach 0. When the latch reaches 0, all waiting threads can resume.</td>
</tr>
</tbody>
</table>
<br />
If you want a set of threads to repeatedly meet at a common point, you are better served by using a <b><i>CyclicBarrier</i></b>. For example, start a bunch of threads, meet, do some stuff like data consolidation or amalgamation, meet again, validate some assertions, and do this repeatedly.<br />
<br />
A given <i>CountDownLatch </i>can only be used once, making it inconvenient for operations that occur in steps, with intermediate results from the different threads needing to be consolidated between steps. The CountDownLatch also doesn't explicitly allow one thread to tell the others to "stop waiting", which is sometimes useful, for example, if an error occurs in one of the threads.<br />
<br />
The <i>CyclicBarrier </i>is generally more useful than <i>CountDownLatch </i>in scenarios where:<br />
<ul>
<li>a multithreaded operation occurs in steps or iterations, and</li>
<li>a single-threaded operation is required between steps/iterations, for example, to combine the results of the previous multithreaded steps.</li>
</ul>
<div>
<br /></div>
<div>
Stay tuned for <b>Semaphores </b>and <b>Atomic </b>classes in the next part.</div>
<div style="clear:both; padding-bottom:0.25em"></div><p class="blogger-labels">Labels: <a rel='tag' href="http://java-success.blogspot.com/search/label/Multi-threading">Multi-threading</a></p>
    </p>
    </div>
    
    <p class="post-footer">
      <em>posted by Arulkumaran Kumaraswamipillai at 
    <a class="post-footer-link" href="http://java-success.blogspot.in/2012/08/article-scenarios-and-solutions-for_21.html" title="permanent link"> 8/22/2012 03:35:00 PM </a></em>

        <span class="item-action"><a href="https://www.blogger.com/email-post.g?blogID=35897879&postID=550338554755693482" title="Email Post"><img class="icon-action" alt="" src="https://img2.blogblog.com/img/icon18_email.gif" height="13" width="18"/></a></span><span class="item-control blog-admin pid-341905326"><a style="border:none;" href="https://www.blogger.com/post-edit.g?blogID=35897879&postID=550338554755693482&from=pencil" title="Edit Post"><img class="icon-action" alt="" src="https://img2.blogblog.com/img/icon18_edit_allbkg.gif" height="18" width="18"></a></span>
    </p>
  
  </div>
  <!-- End .post -->
  
  
  
  <!-- Begin #comments -->
 

  <div id="comments">

	<a name="comments"></a>
    
    <h4>3 Comments:</h4>
    
    <dl id="comments-block">
      
      <dt class="comment-poster" id="c5231917786771112794"><a name="c5231917786771112794"></a>
        <span style="line-height:16px" class="comment-icon blogger-comment-icon"><img src="https://img2.blogblog.com/img/b16-rounded.gif" alt="Blogger" style="display:inline;" /></span>&nbsp;<a href="https://www.blogger.com/profile/12619871741820431823" rel="nofollow">Anshul Pathak</a> said...
      </dt>

      <dd class="comment-body">
        <p>Thread knowledge booster...Thanks Sir</p>
      </dd>
      <dd class="comment-timestamp"><a href="http://java-success.blogspot.com/2012/08/article-scenarios-and-solutions-for_21.html?showComment=1345697782142#c5231917786771112794" title="comment permalink">2:56 PM, August 23, 2012</a>
	  <span class="item-control blog-admin pid-95994574"><a style="border:none;" href="https://www.blogger.com/delete-comment.g?blogID=35897879&postID=5231917786771112794" title="Delete Comment" ><span class="delete-comment-icon">&nbsp;</span></a></span>
	  </dd>
      
      <dt class="comment-poster" id="c3392051364157254292"><a name="c3392051364157254292"></a>
        <span style="line-height:16px" class="comment-icon blogger-comment-icon"><img src="https://img2.blogblog.com/img/b16-rounded.gif" alt="Blogger" style="display:inline;" /></span>&nbsp;<a href="https://www.blogger.com/profile/07761961670543628439" rel="nofollow">Eric Jackson</a> said...
      </dt>

      <dd class="comment-body">
        <p>This blog is genuinely impressive in all aspects.<br /><a href="http://articlesthread.com/" rel="nofollow">article submission</a></p>
      </dd>
      <dd class="comment-timestamp"><a href="http://java-success.blogspot.com/2012/08/article-scenarios-and-solutions-for_21.html?showComment=1361273214240#c3392051364157254292" title="comment permalink">10:26 PM, February 19, 2013</a>
	  <span class="item-control blog-admin pid-178985760"><a style="border:none;" href="https://www.blogger.com/delete-comment.g?blogID=35897879&postID=3392051364157254292" title="Delete Comment" ><span class="delete-comment-icon">&nbsp;</span></a></span>
	  </dd>
      
      <dt class="comment-poster" id="c4645786365761624413"><a name="c4645786365761624413"></a>
        <span style="line-height:16px" class="comment-icon blogger-comment-icon"><img src="https://img2.blogblog.com/img/b16-rounded.gif" alt="Blogger" style="display:inline;" /></span>&nbsp;<a href="https://www.blogger.com/profile/07103140255089555880" rel="nofollow">Gowri Pasagada</a> said...
      </dt>

      <dd class="comment-body">
        <p>Excellent blog, I have got a deep understanding of java concurrency concept after reading your through your diagrams and code. Thanks you very much sir. I appreciate it very much.</p>
      </dd>
      <dd class="comment-timestamp"><a href="http://java-success.blogspot.com/2012/08/article-scenarios-and-solutions-for_21.html?showComment=1361746764554#c4645786365761624413" title="comment permalink">9:59 AM, February 25, 2013</a>
	  <span class="item-control blog-admin pid-386597299"><a style="border:none;" href="https://www.blogger.com/delete-comment.g?blogID=35897879&postID=4645786365761624413" title="Delete Comment" ><span class="delete-comment-icon">&nbsp;</span></a></span>
	  </dd>
      
    </dl>

    
   <p class="comment-timestamp">
    <div class='comment-form'>
<a name='comment-form'></a>
<h4>Post a Comment</h4><p></p>
<a id='comment-editor-src' href='https://www.blogger.com/comment-iframe.g?blogID=35897879&postID=550338554755693482'></a><iframe id='comment-editor' src='' class='blogger-iframe-colorize' width='100%' height='410' scrolling='no' frameborder='0' allowtransparency='true'></iframe>
<script type="text/javascript" src="https://www.blogger.com/static/v1/jsbin/2702546152-iframe_colorizer.js"></script>
</div>
    </p>
    <p id="postfeeds">Subscribe to Post Comments [<a target="_blank" href="http://java-success.blogspot.com/feeds/550338554755693482/comments/default" type="application/atom+xml">Atom</a>]</p>
    	    
    
    <a name="links"></a><h4>Links to this post:</h4>
    <dl id="comments-block">
    <script type="text/javascript" src="https://www.blogger.com/dyn-js/backlink.js?blogID=35897879&postID=550338554755693482" charset="utf-8" defer="true">
</script>
<noscript><a href="http://blogsearch.google.com/?ui=blg&q=link:http://java-success.blogspot.com/2012/08/article-scenarios-and-solutions-for_21.html">See links to this post</a></noscript>
<div id="blogger-dcom-block" style="display:none">
        <dt class="comment-title">
        <span class="comment-toggler">&nbsp;</span>
        <a href="<$BlogBacklinkURL$>" rel="nofollow"><$BlogBacklinkTitle$></a> <span class="item-control blog-admin"><a style="border:none;" href="https://www.blogger.com/delete-backlink.g?blogID=35897879&amp;postID=550338554755693482&amp;backlinkURL=%3C$BlogBacklinkURLEscaped$%3E" title="Remove Link" ><span class="delete-comment-icon">&nbsp;</span></a></span>
        </dt>
        <dd class="comment-body"><$BlogBacklinkSnippet$>
        <br />
        <span class="comment-poster">
        <em><$I18NPostedByBacklinkAuthor$> @ <$BlogBacklinkDateTime$></em>
        </span>
        </dd>
    </div>
<script type="text/javascript">if (typeof BL_addOnLoadEvent == 'function') { BL_addOnLoadEvent(function() { BL_writeBacklinks(); }); }</script>

    </dl>
    <p class="comment-timestamp"><script type="text/javascript">function BlogThis() {
Q=''; x=document; y=window;
if(x.selection) {
  Q=x.selection.createRange().text;
} else if (y.getSelection) {
  Q=y.getSelection();
} else if (x.getSelection) {
  Q=x.getSelection();
}
popw = y.open('https://www.blogger.com/blog-this.g?t=' +
  escape(Q) + '&u=' + escape(location.href) + '&n=' +
  escape(document.title),'bloggerForm',
  'scrollbars=no,width=475,height=300,top=175,left=75,status=yes,resizable=yes');
void(0);
}
</script>
<a class="comment-link" href="javascript:BlogThis();" id="b-backlink">Create a Link</a></p>
    


		<p class="comment-timestamp">
	<a href="http://java-success.blogspot.in/">&lt;&lt; Home</a>
    </p>
    </div>


  <!-- End #comments -->
   

</div></div>
<!-- End #main -->







<!-- Begin #sidebar -->
<div id="sidebar"><div id="sidebar2">

  
  
  <h2 class="sidebar-title">Previous Posts</h2>
    <ul id="recently">
    
        <li><a href="http://java-success.blogspot.in/2012/08/article-scenarios-and-solutions-for.html">Article: Scenarios and solutions for better concur...</a></li>
     
        <li><a href="http://java-success.blogspot.in/2012/08/article-sample-java-resume-or-sample.html">Article: Sample Java Resume or CV</a></li>
     
        <li><a href="http://java-success.blogspot.in/2012/08/article-using-builders-instead-of.html">Article: Using Builders instead of Constructors to...</a></li>
     
        <li><a href="http://java-success.blogspot.in/2012/08/article-functional-programming-in-java.html">Article: Functional programming in Java</a></li>
     
        <li><a href="http://java-success.blogspot.in/2012/08/java-logical-thinking-code-example.html">Java logical thinking and coding questions and ans...</a></li>
     
        <li><a href="http://java-success.blogspot.in/2012/08/how-to-standout-from-other-javajee.html">How to standout from other Java/JEE professionals?...</a></li>
     
        <li><a href="http://java-success.blogspot.in/2012/08/html-and-css-interview-questions-and.html">HTML and CSS Interview Questions and Answers</a></li>
     
        <li><a href="http://java-success.blogspot.in/2012/07/javascript-common-mistakes-and-tools.html">JavaScript common mistakes and  tools</a></li>
     
        <li><a href="http://java-success.blogspot.in/2012/07/sql-interview-questions-and-answers.html">SQL Interview Questions and Answers: storing a tre...</a></li>
     
        <li><a href="http://java-success.blogspot.in/2012/07/uml-diagrams-interview-questions-and.html">UML diagrams interview questions and answers</a></li>
     
  </ul>
  
  
  
  
  
  <!-- Begin #profile-container -->
  
    <div id="profile-container"><h2 class="sidebar-title">About Me</h2>
<dl class="profile-datablock"><dt class="profile-img"><a href="https://plus.google.com/109240621969095737337"><img src="//lh3.googleusercontent.com/-XMLxx0v_R7A/AAAAAAAAAAI/AAAAAAAACxk/8BeHFmsEuy8/s80-c/photo.jpg" width="80" height="80" alt="My Photo"></a></dt>
<dd class="profile-data"><strong>Name:</strong> <a rel="author" href="https://plus.google.com/109240621969095737337"> Arulkumaran Kumaraswamipillai </a></dd>
</dl>
<p class="profile-textblock">Java freelancer from Australia. As a contractor, attended 100+ job interviews and received multiple job offers. Authored Java career books that sold over 30,000 copies.<br><br><a href="http://www.java-success.com" rel="nofollow" target="_blank">www.java-success.com</a> for 500+ Java/JEE job interview questions and answers and tutorials.<br></p>
<p class="profile-link"><a rel="author" href="https://plus.google.com/109240621969095737337">View my complete profile</a></p></div>
  
  <!-- End #profile -->

  
  <p id="powered-by"><a href="http://www.blogger.com"><img src="http://buttons.blogger.com/bloggerbutton1.gif" alt="Powered by Blogger" /></a></p>
  <p id="blogfeeds">Subscribe to<br />Posts [<a target="_blank" href="http://java-success.blogspot.com/feeds/posts/default" type="application/atom+xml">Atom</a>]</p>

  <script type="text/javascript"><!--
google_ad_client = "pub-3764234023451771";
google_ad_host = "pub-1556223355139109";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>  
   
  <!--
  <p>This is a paragraph of text that could go in the sidebar.</p>
  -->
  
  <script type="text/javascript"><!--
google_ad_client = "pub-3764234023451771";
google_ad_host = "pub-1556223355139109";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>  



</div></div>
<!-- End #sidebar -->




<!-- Begin #footer -->
<div id="footer"><hr />

  <p><!-- This is an optional footer. If you want text here, place it inside these tags, and remove this comment. -->&nbsp;</p>

  </div>
<!-- End #footer -->




</div>
<!-- End #content -->






</div></div></div></div>
<!-- End wraps -->

</body>
</html>