<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<head>
  <title>Java-Success Blog: March 2012</title>

  <link href='http://www.java-success.com' rel='canonical'/>




  <script type="text/javascript">(function() { (function(){function c(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(l){}};this.tick("start",null,a)}var a,e;window.performance&&(e=(a=window.performance.timing)&&a.responseStart);var h=0<e?new c(e):new c;window.jstiming={Timer:c,load:h};if(a){var b=a.navigationStart;0<b&&e>=b&&(window.jstiming.srt=e-b)}if(a){var d=window.jstiming.load;0<b&&e>=b&&(d.tick("_wtsrt",void 0,b),d.tick("wtsrt_","_wtsrt",
e),d.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),d&&0<b&&(d.tick("_tbnd",void 0,window.chrome.csi().startE),d.tick("tbnd_","_tbnd",b))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,d&&0<b&&(d.tick("_tbnd",void 0,window.external.startE),d.tick("tbnd_","_tbnd",b))),a&&(window.jstiming.pt=a)}catch(k){}})();window.tickAboveFold=function(c){var a=0;if(c.offsetParent){do a+=c.offsetTop;while(c=c.offsetParent)}c=a;750>=c&&window.jstiming.load.tick("aft")};var f=!1;function g(){f||(f=!0,window.jstiming.load.tick("firstScrollTime"))}window.addEventListener?window.addEventListener("scroll",g,!1):window.attachEvent("onscroll",g);
 })();</script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="Blogger" />
<link rel="icon" type="image/vnd.microsoft.icon" href="https://www.blogger.com/favicon.ico"/>
<link rel="alternate" type="application/atom+xml" title="Java-Success Blog - Atom" href="http://java-success.blogspot.com/feeds/posts/default" />
<link rel="alternate" type="application/rss+xml" title="Java-Success Blog - RSS" href="http://java-success.blogspot.com/feeds/posts/default?alt=rss" />
<link rel="service.post" type="application/atom+xml" title="Java-Success Blog - Atom" href="https://www.blogger.com/feeds/35897879/posts/default" />
<link rel="stylesheet" type="text/css" href="https://www.blogger.com/static/v1/v-css/50269083-blog_controls.css"/>
<link rel="stylesheet" type="text/css" href="https://www.blogger.com/dyn-css/authorization.css?targetBlogID=35897879&zx=32ffd7df-5810-469f-a666-048e5011b3eb"/>
<script type="text/javascript" src="https://www.blogger.com/static/v1/v-js/979395223-backlink.js"></script>
<script type="text/javascript" src="https://www.blogger.com/static/v1/v-js/4080670514-backlink_control.js"></script>
<script type="text/javascript">var BL_backlinkURL = "https://www.blogger.com/dyn-js/backlink_count.js";var BL_blogId = "35897879";</script>


  <style type="text/css">
/*
-----------------------------------------------
Blogger Template Style
Name:     Harbor
Designer: Douglas Bowman
URL:      www.stopdesign.com
Date:     24 Feb 2004
----------------------------------------------- */


body {
  background:#fff url("http://www.blogblog.com/harbor/rocks.jpg") no-repeat right bottom;
  background-attachment:fixed;
  margin:0;
  padding:0;
  font:x-small Georgia,Serif;
  color:#333;
  font-size/* */:/**/small;
  font-size: /**/small;
  }
/* Commented Backslash Hack hides rule from IE5-Mac \*/
  body {background-attachment:scroll;}
  /* End IE5-Mac hack */
a:link {
  color:#36a;
  text-decoration:none;
  }
a:visited {
  color:#764;
  text-decoration:none;
  }
a:hover {
  color:#933;
  text-decoration:underline;
  }
a img {
  border-width:0;
  }


/* Page Structure
----------------------------------------------- */
#wrap {
  background:url("http://www.blogblog.com/harbor/sky.jpg") repeat-x left top;
  min-width:740px;
  margin:0;
  padding:0;
  text-align:left;
  }
#wrap2 {
  background:url("http://www.blogblog.com/harbor/lighthouse.jpg") no-repeat left top;
  }
#wrap3 {
  background:url("http://www.blogblog.com/harbor/cloud.jpg") no-repeat 100% 75px;
  }
#wrap4 {
  background:url("http://www.blogblog.com/harbor/center_cloud.jpg") no-repeat 50% 0;
  padding:15px;
  width:100%;
  width/* */:/**/auto;
  width: /**/auto;
  }
@media all {
  #content {
    max-width:890px;
    padding:0 30px 50px;
    width:100%;
    width/* */:/**/auto;
    width: /**/auto;
    }
  html>body #content {
    border:3px double #fff;
    }
  #main {
    width:64%;
    float:right;
    }
  #main2 {
    margin:0;
    padding:0;
    }
  #sidebar {
    width:32%;
    float:left;
    }
  #sidebar2 {
    margin:0;
    padding:170px 0 20px;
    }
  }
@media handheld {
  #content {
    width:90%;
    }
  #main {
    width:100%;
    float:none;
    }
  #sidebar {
    width:100%;
    float:none;
    }
  }

/* Header
----------------------------------------------- */
@media all {
  #header {
    padding:15px 0 10px 110px;
    }
  }
@media handheld {
  #header {
    width:100%;
    padding:15px 0 10px 0;
    }
  }
#blog-title {
  margin:0 0 .25em;
  font-size:270%;
  font-weight:normal;
  color:#678;
  }
#blog-title a {
  color:#678;
  text-decoration:none;
  }
#description {
  margin:0;
  max-width:700px;
  font-size:75%;
  line-height:1.8em;
  text-transform:uppercase;
  letter-spacing:.2em;
  color:#789;
  }


/* Headings
----------------------------------------------- */
h2 {
  margin:1.5em 0 .75em;
  font:78%/1.4em Georgia,Serif;
  text-transform:uppercase;
  letter-spacing:.2em;
  color:#933;
  }


/* Posts
----------------------------------------------- */
.date-header {
  margin:2em 0 .5em;
  }
.post {
  margin:.5em 0 1.5em;
  line-height:1.6em;
  }
.post-title {
  margin:.25em 0 0;
  padding:0 0 4px;
  font-size:140%;
  font-weight:normal;
  line-height:1.4em;
  }
.post-title a, .post-title strong {
  background:url("http://www.blogblog.com/harbor/icon_lighthouse.gif") no-repeat 0 .15em;
  display:block;
  padding-left:20px;
  text-decoration:none;
  color:#368;
  font-weight:normal;
  }
.post-title strong {
  background-image:url("http://www.blogblog.com/harbor/icon_lighthouse2.gif");
  color:#000;
  }
.post-title a:hover {
  color:#933;
  }
.post-body {
  background:url("http://www.blogblog.com/harbor/divider.gif") no-repeat center top;
  padding-top:12px;
  }
.post p {
  margin:0 0 .75em;
  }
p.post-footer {
  color:#999;
  }
.post-footer em, .comment-link {
  font:78%/1.4em Georgia,Serif;
  text-transform:uppercase;
  letter-spacing:.1em;
  }
.post-footer em {
  font-style:normal;
  color:#666;
  margin-right:.4em;
  }
.comment-link strong {
  font-size:130%;
  }
.comment-link {
  margin-left:.4em;
  }
.post img {
  padding:4px;
  border:1px solid #cde;
  }


/* Comments
----------------------------------------------- */
#comments {
  background:url("http://www.blogblog.com/harbor/divider.gif") no-repeat center top;
  padding:15px 0 0;
  }
#comments h4 {
  margin:1em 0;
  font:bold 78%/1.6em Georgia,Serif;
  text-transform:uppercase;
  letter-spacing:.2em;
  color:#933;
  }
#comments h4 strong {
  font-size:130%;
  }
#comments-block {
  margin:1em 0 1.5em;
  line-height:1.4em;
  }
#comments-block dt {
  margin:.5em 0;
  }
#comments-block dd {
  margin:.25em 20px 0;
  }
#comments-block dd.comment-timestamp {
  margin:-.25em 20px 1.5em;
  font:78%/1.4em Georgia,Serif;
  text-transform:uppercase;
  letter-spacing:.1em;
  }
#comments-block dd p {
  margin:0 0 .75em;
  }
.deleted-comment {
  font-style:italic;
  color:gray;
  }


/* Sidebar Content
----------------------------------------------- */
#sidebar ul {
  background:url("http://www.blogblog.com/harbor/divider.gif") no-repeat center bottom;
  margin:0 0 15px;
  padding:0 0 15px;
  list-style:none;
  }
#sidebar li {
  margin:0;
  padding:0 0 .25em 15px;
  text-indent:-15px;
  line-height:1.5em;
  }
#sidebar p {
  color:#666;
  line-height:1.5em;
  }


/* Profile
----------------------------------------------- */
#profile-container {
  background:url("http://www.blogblog.com/harbor/divider.gif") no-repeat center bottom;
  margin:0 0 2em;
  padding:0 0 15px;
  }
.profile-datablock {
  margin:.5em 0 .5em;
  }
.profile-img {
  display:inline;
  }
.profile-img img {
  float:left;
  padding:4px;
  border:1px solid #cde;
  margin:0 8px 3px 0;
  }
.profile-data {
  margin:0;
  font:bold 78%/1.6em Georgia,Serif;
  text-transform:uppercase;
  letter-spacing:.1em;
  }
.profile-data strong {
  display:none;
  }
.profile-textblock {
  margin:0 0 .5em;
  }
.profile-link {
  font:78%/1.4em Georgia,Serif;
  text-transform:uppercase;
  letter-spacing:.1em;
  }


/* Footer
----------------------------------------------- */
#footer {
  clear:both;
  padding:15px 30px 0 50px;
  }
#footer hr {
  display:none;
  }
#footer p {
  background:url("http://www.blogblog.com/harbor/divider.gif") no-repeat center top;
  margin:0;
  padding-top:15px;
  font:78%/1.6em Georgia,Serif;
  text-transform:uppercase;
  letter-spacing:.1em;
  }


/* Feeds
----------------------------------------------- */
#blogfeeds {
  }
#postfeeds {
  }
  </style>
<!-- --><style type="text/css">@import url(https://www.blogger.com/static/v1/v-css/navbar/3334278262-classic.css);
div.b-mobile {display:none;}
</style>

</head>

<body><script type="text/javascript">
    function setAttributeOnload(object, attribute, val) {
      if(window.addEventListener) {
        window.addEventListener('load',
          function(){ object[attribute] = val; }, false);
      } else {
        window.attachEvent('onload', function(){ object[attribute] = val; });
      }
    }
  </script>
<div id="navbar-iframe-container"></div>
<script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>
<script type="text/javascript">
      gapi.load("gapi.iframes:gapi.iframes.style.bubble", function() {
        if (gapi.iframes && gapi.iframes.getContext) {
          gapi.iframes.getContext().openChild({
              url: 'https://www.blogger.com/navbar.g?targetBlogID\x3d35897879\x26blogName\x3dJava-Success+Blog\x26publishMode\x3dPUBLISH_MODE_BLOGSPOT\x26navbarType\x3dBLUE\x26layoutType\x3dCLASSIC\x26searchRoot\x3dhttp://java-success.blogspot.com/search\x26blogLocale\x3den\x26v\x3d2\x26homepageUrl\x3dhttp://java-success.blogspot.com/\x26vt\x3d2978101103701820782',
              where: document.getElementById("navbar-iframe-container"),
              id: "navbar-iframe"
          });
        }
      });
    </script>

<!-- Begin wraps -->

<div id="wrap"><div id="wrap2"><div id="wrap3"><div id="wrap4">


<!-- Begin #content -->
<div id="content">


<div id="header">

  <h1 id="blog-title">
    
	Java-Success Blog
	
  </h1>

  <p id="description">Java/JEE blog containing interview questions and answers and tutorials</p>

</div>


<!-- Begin #main -->
<div id="main"><div id="main2">

<div class='adsense' style='text-align:center; padding: 0px 3px 0.5em 3px;'>
<script type="text/javascript"><!--
google_ad_client="pub-3764234023451771";
google_ad_host="pub-1556223355139109";
google_ad_width=468;
google_ad_height=60;
google_ad_format="468x60_as";
google_ad_type="text";
google_color_border="FFFFFF";
google_color_bg="FFFFFF";
google_color_link="333333";
google_color_url="009900";
google_color_text="993333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>



</div>

<!-- Search Google -->
<center>
<form method="get" action="http://www.google.com/custom" target="_top">
<table bgcolor="#ffffff">
<tr><td nowrap="nowrap" valign="top" align="left" height="32">
<a href="http://www.google.com/">
<img src="http://www.google.com/logos/Logo_25wht.gif" border="0" alt="Google" align="middle"></img></a>
<label for="sbi" style="display: none">Enter your search terms</label>
<input type="text" name="q" size="31" maxlength="255" value="" id="sbi"></input>
<label for="sbb" style="display: none">Submit search form</label>
<input type="submit" name="sa" value="Search" id="sbb"></input>
<input type="hidden" name="client" value="pub-3764234023451771"></input>
<input type="hidden" name="forid" value="1"></input>
<input type="hidden" name="ie" value="ISO-8859-1"></input>
<input type="hidden" name="oe" value="ISO-8859-1"></input>
<input type="hidden" name="cof" value="GALT:#008000;GL:1;DIV:#336699;VLC:663399;AH:center;BGC:FFFFFF;LBGC:336699;ALC:0000FF;LC:0000FF;T:000000;GFNT:0000FF;GIMP:0000FF;FORID:1"></input>
<input type="hidden" name="hl" value="en"></input>
</td></tr></table>
</form>
</center>
<!-- Search Google -->









<script type="text/javascript"><!--
google_ad_client = "pub-3764234023451771";
google_ad_host = "pub-1556223355139109";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al";
google_ad_channel = "";
//-->
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>


  <h2 class="date-header">Mar 27, 2012</h2>

  
  
     
  <!-- Begin .post -->
  <div class="post"><a name="986279550521462415"></a>
    
         
    


    <h3 class="post-title">
	 
	 Java 5 Executor Framework - why use thread pools?
	 
    </h3>

    
     
    <div class="post-body">
    <p>
      <div style="clear:both;"></div><b>Q.</b> What is a thread pool, and how will you create them in Java? Why do you need an Executor framework?<br />
<b>A.</b> A thread pool consists of a collection of worker threads. A work queue is 
optional though most of the advanced implementations have a 
configurable work queue. The threads in the pool constantly run and&nbsp; check the work queue for new work. If there is new work to be done they execute this Runnable. <br />
<br />
In Java 5, <span style="font-size: large;"><b>Executor framework</b></span> was introduced with the java.util.concurrent.Executor interface. This was introduced to fix some of the shortcomings discussed below.<br />

<br />
<b>1.</b> The Executor framework is a framework for <b>standardizing </b>invocation, scheduling, execution, and control of asynchronous tasks according to a set of execution policies.
<br />


<br />
<br />
<b>2. </b>Even though the threads are light-weighted than creating a process, creating them utilizes a lot of resources. Also, creating a new thread for each task will consume more stack memory as each thread will have its own stack and also the CPU will spend more time in context switching. Creating a lot many threads with no bounds to the maximum threshold can cause application to run out of heap memory. So, creating a <b>ThreadPool </b>is a better solution as a finite number of threads can be pooled and reused. The runnable or callable tasks will be placed in a queue, and the finite number of threads in the pool will take turns to process the tasks in the queue. <br />

<br />
<br />
Here is the sample code:<br />
<br />
<br />
<!-- INFOLINKS_OFF-->

<br />
<pre class="brush: csharp">import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

public class Sum  implements Runnable {
 
    private static final int NO_OF_THREADS= 3;
 
    int maxNumber;
 
    public Sum(int maxNumber) {
       this.maxNumber = maxNumber;
    }
 
    /** method where the thread execution will start **/
    public void run(){
        int sum = 0;
        for (int i = 0; i = maxNumber; i++) {
           sum += maxNumber;
        } 
        
        System.out.println("Thread " + Thread.currentThread().getName() + " count is " + sum);
    }
    
    
    /** main thread. Always there by default. **/
    public static void main(String[] args) {
       ExecutorService executor = Executors.newFixedThreadPool(NO_OF_THREADS);   // create a pool of 3 threads
       for (int i = 10000; i &lt; 10100; i++) {
          Runnable worker = new Sum(i);               // create worker threads
          executor.execute(worker);                   // add runnables to the work queue 
       }
  
       // This will make the executor accept no new threads
       // and finish all existing threads in the queue
       executor.shutdown();
  
       // Wait until all threads have completed
       while (!executor.isTerminated()) {

       }
  
       System.out.println("Finished all threads");
    }

}

</pre>
<b>3.</b> The Runnable interface's void run( ) method has no way of returning any result back to the main thread. The executor framework introduced the <b>Callable </b>interface that returns a value from its <b>call( ) </b>method. This means the asynchronous task will be able to return a value once it is done executing.<br />
<br />
<pre class="brush: csharp">import java.util.ArrayList;
import java.util.List;
import java.util.concurrent.Callable;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.Future;


public class Sum  implements Callable&lt;String&gt; {
 
 private static final int NO_OF_THREADS = 3;
 
 int maxNumber;
 
 public Sum(int maxNumber) {
    this.maxNumber = maxNumber;
 }
 
  /** method where the thread execution will start
    *  this can return a value
    */
    public String call(){
        int sum = 0;
        for (int i = 0; i &lt;= maxNumber; i++) {
            sum += maxNumber;
        } 
        
        return Thread.currentThread().getName() + " count is " + sum;
    }
    
    
    /** main thread. Alwyas there by default. **/
    public static void main(String[] args) {
      ExecutorService executor = Executors.newFixedThreadPool(NO_OF_THREADS);                       // create a pool of 3 threads
      List&lt;Future&lt;String&gt;&gt; list = new ArrayList&lt;Future&lt;String&gt;&gt;(10);  // provides facility to return results asynchronously
     
      for (int i = 10000; i &lt; 10100; i++) {
        Callable&lt;String&gt; worker = new Sum(i);                 // create worker threads 
        Future&lt;String&gt; submit = executor.submit(worker);      // add callables to the work queue
        list.add(submit);                                            // provides facility to return results asynchronously
      }
  
      //process the results asynchronously when each thread completes its task
      for (Future&lt;String&gt; future : list) {
        try {
            System.out.println("Thread " + future.get());
        } catch (InterruptedException e) {
            e.printStackTrace();
        } catch (ExecutionException e) {
           e.printStackTrace();
        }
      }
  
  
      executor.shutdown();
  
      System.out.println("Finished all threads");
   }

}

</pre>
The output is something like<br />
<br />
<pre class="brush: csharp">Thread pool-1-thread-1 count is 100010000
Thread pool-1-thread-2 count is 100030002
Thread pool-1-thread-3 count is 100050006
Thread pool-1-thread-1 count is 100070012
Thread pool-1-thread-1 count is 100090020
...
</pre>
<br />
<b>4.</b> The various Executor implementations provide different execution policies to be set while executing the tasks. For example, the ThreadPool supports the following policies:<br />
<br />
<ul>
<li><b>newFixedThreadPool</b>: Creates threads as tasks are submitted, up to the maximum pool size, and then attempts to keep the pool size constant.</li>
<li><b>newCachedThreadPool</b>: Can add new threads when demand increases, no bounds on the size of the pool.</li>
<li><b>newSingleThreadExecutor</b>: Single worker thread to process tasks, Guarantees order of execution based on the queue policy (FIFO, LIFO, priority order).</li>
<li><b>newScheduledThreadPool</b>: Fixed-size, supports delayed and periodic task execution.</li>
</ul>
<b>5.</b>  The <b> ExecutorService </b>provides facilities to shut down an application gracefully, abruptly, or somewhere in-between.<br />
<br />
<b>Q.</b> What design pattern does the executor framework use? <br />
<b>A</b>. The Executor is based on the <b>producer-consumer design pattern</b>, where threads that submit tasks are producers and the threads that execute tasks are consumers. In the above examples, the <b>main thread </b>is the producer as it loops through and submits tasks to the worker threads. The "Sum" (i.e. a worker thread) is the consumer that executes the tasks submitted by the main (i.e. consumer) thread. Check<a href="http://java-success.blogspot.com.au/2012/04/how-will-you-go-about-explaining.html"> this blog to learn&nbsp; more detailed explanation on the producer-consumer design pattern</a>.<br />
<br />
<br />
<script type="text/javascript"><!--
google_ad_client = "ca-pub-3764234023451771";
google_ad_host = "pub-1556223355139109";
/* Leader -- Bottom */
google_ad_slot = "0221266263";
google_ad_width = 728;
google_ad_height = 90;
//--&gt;
</script>


<script src="http://pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script>
<div style="clear:both; padding-bottom:0.25em"></div><p class="blogger-labels">Labels: <a rel='tag' href="http://java-success.blogspot.com/search/label/Multi-threading">Multi-threading</a></p>
    </p>
    </div>
    
    <p class="post-footer">
      <em>posted by Arulkumaran Kumaraswamipillai at 
    <a class="post-footer-link" href="http://java-success.blogspot.in/2012/03/java-5-executor-framework-why-use.html" title="permanent link"> 3/27/2012 05:58:00 PM </a></em>

       |
      <a class="comment-link" href="http://java-success.blogspot.in/2012/03/java-5-executor-framework-why-use.html#comment-form"location.href=http://java-success.blogspot.com/2012/03/java-5-executor-framework-why-use.html#comment-form;><span style="text-transform:lowercase">39 Comments</span></a>
      
  <span class="item-action"><a href="https://www.blogger.com/email-post.g?blogID=35897879&postID=986279550521462415" title="Email Post"><img class="icon-action" alt="" src="https://img2.blogblog.com/img/icon18_email.gif" height="13" width="18"/></a></span><span class="item-control blog-admin pid-341905326"><a style="border:none;" href="https://www.blogger.com/post-edit.g?blogID=35897879&postID=986279550521462415&from=pencil" title="Edit Post"><img class="icon-action" alt="" src="https://img2.blogblog.com/img/icon18_edit_allbkg.gif" height="18" width="18"></a></span>
    </p>
  
  </div>
  <!-- End .post -->
  
  
  
  <!-- Begin #comments -->
 
  <!-- End #comments -->
  






<script type="text/javascript"><!--
google_ad_client = "pub-3764234023451771";
google_ad_host = "pub-1556223355139109";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al";
google_ad_channel = "";
//-->
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>


  <h2 class="date-header">Mar 26, 2012</h2>

  
  
     
  <!-- Begin .post -->
  <div class="post"><a name="5273241981817442057"></a>
    
         
    


    <h3 class="post-title">
	 
	 Java multi-threading interview questions and answers: atomic operations
	 
    </h3>

    
     
    <div class="post-body">
    <p>
      <div style="clear:both;"></div><table>
<tr>
<td width="35%">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-3764234023451771";
/* LHS - Medium Rectangle */
google_ad_slot = "1728948974";
google_ad_width = 336;
google_ad_height = 280;
google_ad_channel ="6353655268";
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>


</td>
<td width="65%">
<b>Q. </b>Can you give some examples of thread racing conditions you had experienced?<br />
<b>A. </b><br />
<br />
<b>1.</b> Declaring variables in JSP pages are not thread-safe. The declared variables in JSP pages end-up as instance variables in the converted Servlets. <br />
<br />
&lt;%! Calendar c = Calendar.getInstance(); %&gt;<br />
<br />
<b>2.</b> Decalring instance variables in Servlets is not thread safe, as Servlets are inherently multi-threaded and gets accessed by multiple-threads. Same is true for the <i><b>Action </b></i>classes in the struts framework.<br />
<br />
<b>3.</b> Some of the Java standard library classes like <i><b>SimpleDateFormat </b></i>is not thread-safe. Always check the API to see if a particular class is thread-safe. If a  particular class or library is not therad-safe, you could do one of three things.
</td>
</tr>
</table>

 


 <br />
<br />
<ul><li>Provide your own wrapper class that decorates the third-party library with proper synchronization. This is a typical use of the <b>decorator design pattern</b>.</li>
<li>Use an alternative library, which is thread-safe if available. For example, <b>Joda Time Library.&nbsp;  </b></li>
<li>Use it in a thread-safe manner. For example, you could use the <i><b>SimpleDateFormat </b></i>class as shown below within a <i><b>ThreadLocal </b></i>class.  Each thread will have its own instance of the <i>SimpleDateFormat</i> object.</li>
</ul><br />
<br />
<!-- INFOLINKS_OFF -->
<pre class="brush: csharp">public class DateFormatTest {

  //anonymous inner class. Each thread will have its own copy
  private final static ThreadLocal&lt;SimpleDateFormat&gt; shortDateFormat =  new ThreadLocal&lt;SimpleDateFormat&gt;() {
            protected SimpleDateFormat initialValue() {
                 return new SimpleDateFormat("dd/MM/yyyy");
             }
  };
   
      
 public Date convert(String strDate)
                     throws ParseException {
 
    //get the SimpleDateFormat instance for this thread and parse the date string  
    Date d = shortDateFormat.get().parse(strDate);
    return d;
  }

}

</pre><b>4. </b>The one that is very popular with the interviewers is writing the singleton classes that are not thread-safe.<br />
<br />
<b>Q</b>. Can you have a true singleton class in Java? How would you write a <b><span style="font-size: large;">thread-safe singleton</span></b> class?<br />
<b>A</b>. A singleton class is something for which only one instance exists per class loader. Single instance for a whole application cannot be guaranteed. That is just definition of what a singleton is. The one that is&nbsp; popular with the interviewers is writing a thread-safe singleton class. For example, the following singleton class is not thread-safe because before a thread creates the Singleton instance, another thread can proceed to the instantiation part of the code -- instance = new Object( );&nbsp; to create more than one instance of the Singleton object. Even though the code --&gt; instance = new Object( ); appears to be single line, the JVM has to execute a number of internal steps like allocating memory, creating a new object and assigning the newly created object to the referenced variable. Only after the completion of these steps, the condition instance == null will return false.<br />
<br />
<pre class="brush: csharp">//final so that cannot be subclassed
public final class Singleton {
 
    private static Object instance = null;
 
    //private so that it cannot be instantiated from outside this class
    private Singleton() {}
 
    public static Object getInstance() {
        if (instance == null) {
            instance = new Object(); 
        }
 
        return instance;
    }
}
</pre><br />
<br />
So, you can make the above code thread-safe in a number of ways.<br />
<br />
<br />
<b>Option 1:</b> Synchronize the whole method or the block of code. This approach is not efficient as the use of synchronized keyword in a singleton class means that only one thread will be executing the synchronized block at a time and all other threads would be waiting. <br />
<br />
<br />
<b>Option 2:</b> Eagerly initialize the singleton instance when the class is actually loaded as opposed to initializing it lazily at at run time only when it is accessed.<br />
<br />
<br />
<pre class="brush: csharp">//final so that cannot be subclassed
public final class ThreadSafeSingleton {
 
    //eager initialization and instantitiated as soon as the class is loaded by a classloader in the JVM 
    private static Object instance = new Object();
 
    //private so that it cannot be instantiated from outside this class
    private Singleton() {}
 
    public static Object getInstance() { 
        return instance;
    }
} </pre><br />
<b>Option 3</b>: You can use the "<b>Initialize-On-Demand Holder Class"</b> idiom proposed by Brian Goetz to create a thread-safe lazy-initialized Singleton as shown below by creating an inner class. <br />
<br />
<br />
<pre class="brush: csharp">public final class ThreadSafeSingleton {
&nbsp;
&nbsp;&nbsp;&nbsp; //private so that it cannot be instantiated from outside this class
&nbsp;&nbsp;&nbsp; private ThreadSafeSingleton() {}
&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp; //static inner class, invoked only when ThreadSafeSingleton.getInstance() is called
&nbsp;&nbsp;&nbsp; private static class ThreadSafeSingletonHolder {
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; private static ThreadSafeSingleton instance = new ThreadSafeSingleton();
&nbsp;&nbsp;&nbsp; }
&nbsp;
&nbsp;&nbsp;&nbsp; public static Object getInstance() { 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return ThreadSafeSingletonHolder.instance;
&nbsp;&nbsp;&nbsp; }
}

</pre><br />
<b>Option 4:</b> is to create a per thread singleton as discussed earlier with the <b><i>ThreadLocal </i></b>class for the <i>SimpledateFormat</i>.<br />
<br />
<br />
<br />
<b>Q.</b> Explain how you would get thread-safety issues due to <span style="font-size: large;"><b>non-atomic</b> operations</span> with a code example?<br />
<b>A.</b> The code snippets below demonstrates non-atomic operations producing incorrect results with code. The program below uses a shared Counter object, that is shared between three concurrent users (i.e. three threads). The Counter object is responsible for incrementing the counter. <br />
<br />
<br />
<b>Firstly</b>, the Counter class. The counted values are stored in a <i>HashMap </i>by name (i.e. thread name) as the key for later retrieval<br />
<br />
<br />
<pre class="brush: csharp">import java.util.HashMap;
import java.util.Map;

public class Counter {

 //shared variable or resource
 private Integer count = Integer.valueOf(0); 
 
 private Map&lt;String, Integer&gt; userToNumber = new HashMap&lt;String, Integer&gt;(10);

 public void  increment() {
  try {
   count = count + 1;   //increment the counter
   Thread.sleep(50);    // to imitate other operations and to make the racing condion to occur more often for the demo
   Thread thread = Thread.currentThread();
   userToNumber.put(thread.getName(), count);
  } catch (InterruptedException e) {
   e.printStackTrace();
  }

 }
 
 
 public Integer getCount(String name) {
  return userToNumber.get(name);
 }
 
}


</pre><br />
<br />
<b>Next</b>, the Runnable task where each thread will be entering and executing concurrently.<br />
<br />
<br />
<pre class="brush: csharp">public class CountingTask implements Runnable {
 
 
 private Counter counter;

 public CountingTask(Counter counter) {
  super();
  this.counter = counter;
 }

 @Override
 public void run() {
  counter.increment();
  Thread thread = Thread.currentThread();
  System.out.println(thread.getName() + " value is " + counter.getCount(thread.getName()));
  
 }

}

</pre><br />
<br />
<b>Finally</b>, the Manager class that creates 3 new threads from the main thread.<br />
<br />
<br />
<pre class="brush: csharp">public class CountingManager {
 
 public static void main(String[] args) throws InterruptedException {
  
  Counter counter = new Counter(); // create an instance of the Counter
  CountingTask task = new CountingTask(counter); // pass the counter to the runnable CountingTask

  
  //Create 10 user threads (non-daemon) from the main thread that share the counter object  
  Thread thread1 = new Thread(task, "User-1");
  Thread thread2 = new Thread(task, "User-2");
  Thread thread3 = new Thread(task, "User-3");
  
  
  //start the threads
  thread1.start();
  thread2.start();
  thread3.start();
  
  
  //observe the racing conditions in the output
  
 }

}

</pre><br />
To see the racing condition, inspect the output of the above code<br />
<br />
<br />
<pre class="brush: csharp">User-3 value is 3
User-1 value is 3
User-2 value is 3
</pre><br />
<br />
All three threads or users get assigned the same value of 3 due to racing conditions. We are expecting to see three different count values to be assigned from 1 to 3.  What happened here is that when the first thread incremented the count from 0 to 1 and entered into the sleep(50) block, the second and third threads incremented the counts from 1 to 2 and 2 to 3 respectively. This shows that the 2 operations -- the operation that increments the thread and the operation that stores the incremented value in a HashMap are not atomic, and produces incorrect results due to racing conditions.     <br />
<br />
<br />
<b>Q.</b> How will you fix the above racing issue?<br />
<b>A.</b> This can be fixed a number of ways.<br />
<br />
<br />
<b>Option 1:</b> Method level synchronization. This is the simplest. As you can see, the  increment() method is synchronized, so that the other threads must wait for the thread that already has the lock to execute that method.<br />
<br />
<pre class="brush: csharp">import java.util.HashMap;
import java.util.Map;

public class Counter {

 //shared variable or resource
 private Integer count = Integer.valueOf(0); 
 
 private Map&lt;String, Integer&gt; userToNumber = new HashMap&lt;String, Integer&gt;(10);

 public synchronized void  increment() {
  try {
   count = count + 1;
   Thread.sleep(50);
   Thread thread = Thread.currentThread();
   userToNumber.put(thread.getName(), count);
  } catch (InterruptedException e) {
   e.printStackTrace();
  }

 }
 
 
 public Integer getCount(String name) {
  return userToNumber.get(name);
 }
 
}

</pre><br />
<b>Option 2:</b> Even though the Option 1 is simple, it locks the entire method and can adversely impact performance for long running methods as each thread has to execute the entire method one at a time. So, the Option 1 can be improved by providing block level lock. Lock only those operations that are acting on the shared resource and making it non-atomic.<br />
<br />
<br />
The code below uses an Object, which has its own lock to ensure that two threads cannot execute both the Operation 1 and 2 at the same time because there is only one lock. <br />
<br />
<pre class="brush: csharp">import java.util.HashMap;
import java.util.Map;

public class Counter {

 //shared variable or resource
 private Integer count = Integer.valueOf(0); 
 
 private Map&lt;String, Integer&gt; userToNumber = new HashMap&lt;String, Integer&gt;(10);
 
 private Object mutex = new Object();   // a lock

 public void  increment() {
  try {
   synchronized(mutex) {
     count = count + 1;                         //operation 1
     Thread.sleep(50); 
     Thread thread = Thread.currentThread();
     userToNumber.put(thread.getName(), count); //operation 2
   }
   // there could be other operations here that uses the shared resource as read only
   
  } catch (InterruptedException e) {
   e.printStackTrace();
  }

 }
 
 public Integer getCount(String name) {
  return userToNumber.get(name);
 }
 
}

</pre><br />
<b>Option 3:</b> This is a very trivial, but practical example. The Java 5 introduced locks and locks are better than using just objects for more flexible locking scenarios where Locks can be used in place of synchronized blocks. Locks offer more flexibility than synchronized blocks in that a thread can unlock multiple locks it holds in a different order than the locks were obtained. Here is the code that replaces synchronized with a reentrant lock. Synchronized blocks in Java are reentrant, which means if a Java thread enters a synchronized block of code, and thereby take the lock on the object the block is synchronized on, the thread can enter other Java code blocks synchronized on the same lock object. <br />
<br />
For example, here is the demo of reentrant lock. <br />
<br />
<pre class="brush: csharp">public class Reentrant{

  public synchronized method1(){
    method2();    //calls another synchronized method on the same object
  }

  public synchronized method2(){
    //do something
  }
}

</pre><br />
<br />
Here is the<b> Option 3 </b>example using a <b>ReentrantLock</b>.<br />
<br />
<pre class="brush: csharp">import java.util.HashMap;
import java.util.Map;
import java.util.concurrent.locks.Lock;
import java.util.concurrent.locks.ReentrantLock;

public class Counter {

 // shared variable or resource
 private Integer count = Integer.valueOf(0);

 private Map&lt;String, Integer&gt; userToNumber = new HashMap&lt;String, Integer&gt;(10);

 private Lock mutex = new ReentrantLock(); // a lock

 public void increment() {
  try {
   mutex.lock();
   try {
    count = count + 1;
    Thread.sleep(50); 
    Thread thread = Thread.currentThread();
    userToNumber.put(thread.getName(), count);
   } finally {
    mutex.unlock(); // finally block is executed even if an
        // exception is thrown
   }
  } catch (InterruptedException e) {
   e.printStackTrace();
  } finally {

  }

 }

 public Integer getCount(String name) {
  return userToNumber.get(name);
 }

}

</pre><br />
<br />
Note that the locks are unlocked in a finally block as it is executed even if an exception is thrown.<br />
<br />
The output for the above 3 options will be something like shown below. The order cannot be guaranteed. But you will get unique numbers assigned for each user.<br />
<br />
<pre class="brush: csharp">User-1 value is 1
User-3 value is 2
User-2 value is 3

</pre><br />
<br />
<b>Q.</b> The following code snippet changes the Counter class to maintain individual counting as in each user counter will be incremented starting from 1. So, the Counter will no longer be the shared resource. The <i>CountingTask </i>class is also modified to loop through each user 2 times as shown below. Is there anything wrong with the code shown below?<br />
<br />
<br />
<br />
The Counter class with individual counts<br />
<br />
<pre class="brush: csharp">import java.util.HashMap;
import java.util.Map;

public class Counter {

 private Map&lt;String, Integer&gt; userToNumber = new HashMap&lt;String, Integer&gt;(10);

 public void increment() {
  Thread thread = Thread.currentThread();
  if (!userToNumber.containsKey(thread.getName())) {
   userToNumber.put(thread.getName(), Integer.valueOf(1));  //op1
  } else {
   Integer count = userToNumber.get(thread.getName());
   if (count != null) {
    ++count; // op2: increment it
    userToNumber.put(thread.getName(), count); //op3
   }
  }

 }

 public Integer getCount(String name) {
  return userToNumber.get(name);
 }
}

</pre><br />
The counting task that repeats twice for each user<br />
<br />
<pre class="brush: csharp">public class CountingTask implements Runnable {

 private Counter counter;

 public CountingTask(Counter counter) {
  super();
  this.counter = counter;
 }

 @Override
 public void run() {

  for (int i = 0; i &lt; 2; i++) {
   counter.increment();
   Thread thread = Thread.currentThread();
   System.out.println(thread.getName() + " value is "
     + counter.getCount(thread.getName()));
  }
 }

}
</pre><br />
<br />
<b>A.</b> If each user will be accessed by only one thread, then the above code is thread-safe because each user will be operating on his/her data. So, only one thread will access the map entry for User-1, and so on. But, what happens if User-3 has two threads created as shown below.<br />
<br />
The Thread 3 and 4 are User 3. In this scenario, the above code is not thread safe, and it needs to be made atomic with one of the three options discussed above. It can be quite dangerous to assume that one user will be accessed only by one thread. What if in the future, additional threads are added to improve performance per user?<br />
<br />
<pre class="brush: csharp">public class CountingManager {
 
 public static void main(String[] args) throws InterruptedException {
  
  Counter counter = new Counter(); // create an instance of the Counter
  CountingTask task = new CountingTask(counter); // pass the counter to the runnable CountingTask

  
  //Create 10 user threads (non-daemon) from the main thread that share the counter object  
  Thread thread1 = new Thread(task, "User-1");
  Thread thread2 = new Thread(task, "User-2");
  Thread thread3 = new Thread(task, "User-3"); //user 3
  Thread thread4 = new Thread(task, "User-3"); //User 3
  
  
  //start the threads
  thread1.start();
  thread2.start();
  thread3.start();
  thread4.start();
  
  
  //observe the racing conditions in the output
  
 }

}

</pre><br />
If you don't perform the operations 1 to 3 atomically (i.e. as a unit), you will get an out put like<br />
<br />
<pre class="brush: csharp">User-1 value is 1
User-1 value is 2
User-3 value is 2
User-3 value is 3
User-3 value is 2
User-3 value is 4
User-2 value is 1
User-2 value is 2

</pre><br />
<br />
As you can see, the User-3 has the value 2 repeated twice and value 1 is missing.  If you apply the one of the options outlined above, you will get an output like<br />
<br />
<pre class="brush: csharp">User-1 value is 1
User-1 value is 2
User-3 value is 1
User-3 value is 2
User-2 value is 1
User-2 value is 2
User-3 value is 3
User-3 value is 4

</pre><br />
Hence, the operations 1-3 need to be made <span style="font-size: large;"><b>atomic </b></span>if accessed concurrently by multiple threads. Those three operations are<br />
<br />
<b>1.</b> storing the initial value<br />
<b>2.</b> incrementing the counter<br />
<b>3.</b> storing the incremented value

<br/>
<br/>

<script type="text/javascript"><!--
google_ad_client = "ca-pub-3764234023451771";
google_ad_host = "pub-1556223355139109";
/* Leader -- Bottom */
google_ad_slot = "0221266263";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<div style="clear:both; padding-bottom:0.25em"></div><p class="blogger-labels">Labels: <a rel='tag' href="http://java-success.blogspot.com/search/label/Multi-threading">Multi-threading</a></p>
    </p>
    </div>
    
    <p class="post-footer">
      <em>posted by Arulkumaran Kumaraswamipillai at 
    <a class="post-footer-link" href="http://java-success.blogspot.in/2012/03/java-multi-threading-interview.html" title="permanent link"> 3/26/2012 06:06:00 PM </a></em>

       |
      <a class="comment-link" href="http://java-success.blogspot.in/2012/03/java-multi-threading-interview.html#comment-form"location.href=http://java-success.blogspot.com/2012/03/java-multi-threading-interview.html#comment-form;><span style="text-transform:lowercase">7 Comments</span></a>
      
  <span class="item-action"><a href="https://www.blogger.com/email-post.g?blogID=35897879&postID=5273241981817442057" title="Email Post"><img class="icon-action" alt="" src="https://img2.blogblog.com/img/icon18_email.gif" height="13" width="18"/></a></span><span class="item-control blog-admin pid-341905326"><a style="border:none;" href="https://www.blogger.com/post-edit.g?blogID=35897879&postID=5273241981817442057&from=pencil" title="Edit Post"><img class="icon-action" alt="" src="https://img2.blogblog.com/img/icon18_edit_allbkg.gif" height="18" width="18"></a></span>
    </p>
  
  </div>
  <!-- End .post -->
  
  
  
  <!-- Begin #comments -->
 
  <!-- End #comments -->
  






<script type="text/javascript"><!--
google_ad_client = "pub-3764234023451771";
google_ad_host = "pub-1556223355139109";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al";
google_ad_channel = "";
//-->
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>


  <h2 class="date-header">Mar 21, 2012</h2>

  
  
     
  <!-- Begin .post -->
  <div class="post"><a name="3397739854212685420"></a>
    
         
    


    <h3 class="post-title">
	 
	 Java Interview Questions and Answers - performance testing your Java application
	 
    </h3>

    
     
    <div class="post-body">
    <p>
      <div style="clear:both;"></div>

I have never been in a project or organization that is yet to have any performance or scalability issues. It is a safe bet to talk up your achievements in fixing performance or resource leak issues in job interviews.&nbsp; It is a pet subject of many job interviewers and if you are in an interview with an organization that is facing performance issue, you will be quizzed on it. Refer to

<ul>
<li><a href="http://java-success.blogspot.com.au/2012/05/java-performance-questions-and-answers.html" target="">interview questions and answers on performance overview and cpu profiling</a>. </li>
<li><a href="http://java-success.blogspot.com.au/2013/08/visual-vm-for-monitoring-java-memory.html" target="">Visual VM profile for performance.</a>. </li>
<li><a href="http://java-success.blogspot.com.au/2012/05/java-memory-profiling-questions-and.html" target="">Profiling with jconsole, jhat, and jmap</a>. </li>
<li><a href="http://java-success.blogspot.com.au/2013/12/performance-profiling-with-aspectj-aop.html" target="">Profiling with Aspectj AOP and Spring</a>. </li>

</ul>
<br/>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Center - Leader board -->
<ins class="adsbygoogle"
     style="display:inline-block;width:728px;height:90px"
     data-ad-client="ca-pub-3764234023451771"
     data-ad-slot="5678244596"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!-- INFOLINKS_OFF -->

<br />
<br />
<b>Q.</b> How would you go about performance testing your Java application?<br />
<b>A.</b><br />
<br />
<b>1.</b> Using a profiler on your running code. It should help you identify the bottlenecks. For example,  jprofiler or Netbeans profiler. A profiler is a program that examines your application as it runs. It provides you with useful run time information such as time spent in particular code blocks, memory / heap, etc. In Java 6, you could use the JConsole.<br />
<br />
<br />
<b>2.</b> You also need to set up performance test scripts with JMeter to simulate the load. Most issues relating to performance bottlenecks, memory leaks, thread-safety, deadlocks, etc only surface under certian load. The performance testing scripts can be recorded while the application is being used and then manually refined. The tools like JMeter HTTP Proxy or Badboy software can be used to trace the script.   <br />
<br />
<b>3. </b>You could provide a custom solution with the help of <b>AOP </b>(aspect oriented programming) or <b>dynamic proxies </b>to intercept your method calls. Dynamic proxies allow you to intercept method calls so you can interpose additional behavior between a class caller and its "callee". <br />
<br />
For example,<b> without AOP or dynamix proxy </b><br />
<br />
<br />
<pre class="brush: csharp">public interface Customer {
 
 public abstract void getDetails(String customerId) ;

}
</pre>
<br />
<pre class="brush: csharp">public class CustomerImpl implements Customer{

 public void getDetails(String customerId) {
  long startTime = System.currentTimeMillis();
  try {
   // Actual method body...
   Thread.sleep(2000);
  } catch (InterruptedException e) {
   e.printStackTrace();
  } finally {
   long endTime = System.currentTimeMillis();
   System.out.println("method took: " + (endTime - startTime) + "ms");
  }
 }

}
</pre>
<br />
<br />
The above approach is<b> very intrusive</b>. Imagine if you have to add this to 30 to 40 other methods. How do you turn this metrics monitoring on and off without commenting and uncommenting your actual method. With dynamic proxy or Spring based AOP, you can alleviate this problem. Here is an example of the dynamic proxy class. <br />
<br />
<br />
<pre class="brush: csharp">import java.lang.reflect.InvocationHandler;
import java.lang.reflect.Method;

//uses Java  reflection
public class PerformanceLogger implements InvocationHandler {

 protected Object delegate; //actual object that performs a function

 public PerformanceLogger(Object delegate) {
  this.delegate = delegate;
 }

 @Override
 public Object invoke(Object proxy, Method method, Object[] args)
   throws Throwable {

  long startTime = System.currentTimeMillis();
  
  try {
   Object result = method.invoke(delegate, args); // invoke the delegate
   return result;
  }

  finally {
   long endTime = System.currentTimeMillis();
   System.out.println("method took: " + (endTime - startTime) + "ms");
  }
 }

}
</pre>
<br />
<br />
<b>Note</b>: If you are using Java 5 or higher use the<b> System.nanoTime( ) </b>instead of System.currentTimeMillis(). For example,<br />
<br />
<br />
<pre class="brush: csharp">long start = System.nanoTime(); // requires java 1.5
//some process
double elapsedTimeInSec = (System.nanoTime() - start) * 1.0e-9;
</pre>
<br />
The test class that tests the above code<br />
<br />
<pre class="brush: csharp">import java.lang.reflect.Proxy;


public class PerformanceTest {
 
 
 public static void main(String[] args) {
    Customer cust = new CustomerImpl();  
    PerformanceLogger pl = new PerformanceLogger(cust); 
    cust = (Customer)Proxy.newProxyInstance(CustomerImpl.class.getClassLoader(), new Class[] {Customer.class}, pl);
    cust.getDetails("8");
      
 }

}

</pre>
<br />
With this approach, you don't need to put the System.currentTimeMillis( ) in your delegate classes. It only needs to be in PerformanceLogger, and it will intercept actual calls to the delegates to print performance metrics. If you want to make changes as to how the metrics are collected or want to turn off System.currentTimeMillis( ), you will only have to do it in one class, that is the dynamic proxy class <i>PerformanceLogger</i>.<br />
<br />
If you are using Spring, you could use the AOP based interceptors. The <a href="http://java-success.blogspot.com.au/2012/02/spring-and-hibernate-interview.html">AOP based deadlock retry using Spring</a> is using a very similar approach for dead lock retry.<br />
<br />
<b>Note</b>:I have been in interviews where the interviewer was more interested in the custom solution by asking<br />
<br />
<b>Q.</b> If you did not have a profiling tool, how would you go about gathering performance metrics?<br />
<b>A</b>. <b>AOP </b>or <b>dynamic proxy</b> based solution as discussed above. You could also mention the built-in command-line and graphical tools that come with Java&nbsp; like JConsole, jstack, jmap, hprof, vmstat, etc. But the main focus must be via interceptors.<br />
<br />
<span style="font-size: large;"><b>Design pattern</b></span>: If you are asked to describe or talk about a design pattern, you could mention this dynamic proxy class as a <b>proxy design pattern</b>. Many pick either singleton or factory design pattern. It would be nicer to pick something other than these two common patterns. Some interviewers specifically ask you to pick anything except factory and singleton design pattern.

<br />
<br />

<b>Q.</b> What tips do you give someone regarding Java performance?<br />
<b>A. </b><br />
<br />
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Center - Leader board -->
<ins class="adsbygoogle"
     style="display:inline-block;width:728px;height:90px"
     data-ad-client="ca-pub-3764234023451771"
     data-ad-slot="5678244596"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<br />
<br/>
<b>1. Don't compromise on design:</b> You should not compromise on architectural principles for just performance. You should make effort to write architecturally sound programs as opposed to writing only fast programs. If your architecture is sound enough then it would allow your program not only to scale better but also allows it to be optimized for performance if it is not fast enough. If you write applications with poor architecture but performs well for the current requirements, what will happen if the requirements grow and your architecture is not flexible enough to extend and creates a maintenance nightmare where fixing a code in one area would break your code in another area. This will cause your application to be re-written. So you should think about extendibility (i.e. ability to evolve with additional requirements), maintainability, ease of use, performance and scalability (i.e. ability to run in multiple servers or machines) during the design phase. List all possible design alternatives and pick the one which is conducive to sound design architecturally (i.e. scalable, easy to use, maintain and extend) and will allow it to be optimized later if not fast enough. Once you get the correct design, then measure with a profiler and optimize it.<br />
<br />
<b>2</b>. <b>Be aware of the death by thousand-cuts: </b>Having said<b> not to compromise on the design</b>,&nbsp; one needs to be mindful of&nbsp; performance inefficiencies that can creep in throughout the software development. For example, an  inefficient method being called 50-100 times can adversely impact  performance. A real-life example would be a JSF application that invokes  its life-cycle methods many times. So, having a long-running subroutine  within the life-cycle method might end up calling it more than once. So, know your best practices and potential pitfalls. Here are a few things to keep in mind. <br />
<br />
<ul>
<li><b>Use immutable objects where applicable</b>. Immutable objects are inherently thread-safe and can also be reused. A good candidate for implementing the flyweight design pattern. The following Java method is an example of flyweight. </li>
</ul>
<br />
<pre class="brush: csharp">Integer.valueOf(String s)
</pre>
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; It keeps some amount of the created Integers internally, so, when you pass the String that you have<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; passed before - it returns you an existing instance.<br />
<br />
<br />
<ul>
<li><b>Check your regexes and SQL</b> queries for backtracking and Cartesian joins respectively. </li>
</ul>
<br />
<br />
<ul>
<li><b>Define your objects and variables with the right scopes.</b> The variables need to be defined at the lowest scope possible (e.g local --&gt; instance --&gt; static) </li>
</ul>
<ul>
<li><b>Use proven libraries, frameworks, built-in algorithms, and data structures</b> as opposed to creating your own. For example, when handing concurrency use java.util.concurrent package. </li>
</ul>
<br />
<b>3</b>. Always have a performance focus by developing proper load testing scripts and benchmarks. The non-functional requirements should cover the relevant SLAs (i.e. Service Level Agreements). <b>Tune your application server, database server, application, etc where required</b> with proper bench marking and load testing scripts. The mission critical applications must have run time metrics gathering in place commercial tools. There are tools that can be used in production environment like YourKit for Java, JProfiler for Java, etc and for larger distributed and clustered systems with large number of nodes there are profilers like CA Wiley Introscope for Java, ClearStone for Java, and HP Performance managers. These tools are handy for proactive detection and isolation of server/application bottlenecks, historical performance trend tracking for capacity planning, and real-time monitoring of system performance.<br />
<br />
<b>Q. </b>When designing your new code, what level of importance would you give to the following attributes? Rank the above attributes in order of importance?&nbsp;&nbsp; <br />
<br />
<b>--</b> <b>Performance<br />
-- Maintainability<br />
-- Extendibility <br />
-- Ease of use<br />
-- Scalability</b><br />
<br />
<b>Rank the above attributes in order of importance?&nbsp;&nbsp; </b><br />
<br />
<b>A.</b> This is an open-ended question. There is no one correct order for this question. The order can vary from application to application, but typically if you write <b>1</b> - extendable, <b>2</b> - maintainable and <b>3</b>  ease of use code with some high level performance considerations, then it should allow you to&nbsp; optimize/tune for <b>4</b> - performance and <b>5</b> - scalability. But if you write some code, which only perform fast but not flexible enough to grow with the additional requirements, then you may end up re-writing or carrying out a major revamp to your code. <br />
<br />
<b>Note</b>: These types of questions have no right or wrong answers, but can reveal a lot about your experience, passion, and attitude towards building a quality software. Good software developers and architects are opinionated based on their past experiences.<br />
<br />
For writing&nbsp; load/performance/stress testing scripts, the JMeter is a very useful free tool. Learn more about <span style="font-size: large;"><a href="http://java-success.blogspot.com.au/2011/10/jmeter-interview-questions-and-answers.html">Java performance testing with JMeter</a></span><div style="clear:both; padding-bottom:0.25em"></div><p class="blogger-labels">Labels: <a rel='tag' href="http://java-success.blogspot.com/search/label/Core%20Java">Core Java</a>, <a rel='tag' href="http://java-success.blogspot.com/search/label/Java%20Key%20Areas">Java Key Areas</a></p>
    </p>
    </div>
    
    <p class="post-footer">
      <em>posted by Arulkumaran Kumaraswamipillai at 
    <a class="post-footer-link" href="http://java-success.blogspot.in/2012/03/java-interview-questions-and-answers.html" title="permanent link"> 3/21/2012 11:18:00 AM </a></em>

       |
      <a class="comment-link" href="http://java-success.blogspot.in/2012/03/java-interview-questions-and-answers.html#comment-form"location.href=http://java-success.blogspot.com/2012/03/java-interview-questions-and-answers.html#comment-form;><span style="text-transform:lowercase">7 Comments</span></a>
      
  <span class="item-action"><a href="https://www.blogger.com/email-post.g?blogID=35897879&postID=3397739854212685420" title="Email Post"><img class="icon-action" alt="" src="https://img2.blogblog.com/img/icon18_email.gif" height="13" width="18"/></a></span><span class="item-control blog-admin pid-341905326"><a style="border:none;" href="https://www.blogger.com/post-edit.g?blogID=35897879&postID=3397739854212685420&from=pencil" title="Edit Post"><img class="icon-action" alt="" src="https://img2.blogblog.com/img/icon18_edit_allbkg.gif" height="18" width="18"></a></span>
    </p>
  
  </div>
  <!-- End .post -->
  
  
  
  <!-- Begin #comments -->
 
  <!-- End #comments -->
  






<script type="text/javascript"><!--
google_ad_client = "pub-3764234023451771";
google_ad_host = "pub-1556223355139109";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al";
google_ad_channel = "";
//-->
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>


  <h2 class="date-header">Mar 7, 2012</h2>

  
  
     
  <!-- Begin .post -->
  <div class="post"><a name="8762366784212257197"></a>
    
         
    


    <h3 class="post-title">
	 
	 Enterprise Java Interview Questions and Answers: What is new in JEE 6?
	 
    </h3>

    
     
    <div class="post-body">
    <p>
      <div style="clear:both;"></div>It is imperative to keep track of the&nbsp; key enhancements and improvements to JEE<b>. </b>If you are interested in JEE basics the try&nbsp;<a href="http://java-success.blogspot.com.au/2011/09/enterprise-java-interview-questions-and.html">Enterprise Java frequently asked questions and answers</a>. <b><br />
</b><br />
<br />
<b>Q.</b> What is new in the Java EE 6&nbsp; (JEE 6) compared to Java EE 5 (JEE 5)?<br />
<b>A.</b> <br />
<br />
<ul><li>JEE 6 provides <b>more extensibility points</b> and service provider interfaces to plug into for the service providers. For example, "Java Authentication Service Provider interface Containers" provides a mechanism for the authentication providers to integrate with the containers. </li>
<li>JEE 5 favored convention over configuration by replacing XML with annotations and POJOs. The JEE 6 extended POJOs with dependency injection (i.e JSR 299 -- Context and Dependency Injection - <b>CDI</b>). This enables a JSF managed bean component to interact with an enterprise Java bean (i.e. EJB) component model to simplify development. It is about time all various types of managed beans are unified. In Java EE 6, the CDI builds on a new concept called "<b>managed beans</b>", which is managed by the enterprise edition container. In CDI, a managed bean is a Java EE component that can be injected into other components. The specification also provides a set of services like <b>resource injection</b>, <b>lifecycle</b> <b>callbacks</b>, and <b>interceptors</b>. &nbsp;&nbsp;</li>
<li>Any CDI managed component may <b>produce </b>and <b>consume <u>events</u></b>. This allows beans to interact in a completely decoupled fashion. Beans consume events by registering for a particular event type and qualifier. </li>
<li>The JAX-WS stack was overhauled to be an integrated stack with JAX-WS 2.x, JAXB 2.x, SAAJ 1.x, <b>JAX-RS</b> 1.x (<span style="color: red;">new </span>RESTful) and <b>JAXR </b>1.x. (<span style="color: red;">new </span>pull-parsing API).&nbsp; </li>
<li>Servlet 3.0 spec introduced the Async Servlet, file uploading functionality, and annotations based configuration.The web.xml file is optional.</li>
<li>Singleton EJBs&nbsp; (i.e. one EJB per container) and asynchronous session beans&nbsp; were introduced. The EJB was streamlined&nbsp; with fewer classes, interfaces, and simpler object to relational mapping by taking advantage of the JPA.</li>
<li>Bean based validation framework was introduced to avoid duplication.</li>
<li>Enterprise Java Beans (i.e EJBs) can be packaged directly into a WAR file. No longer required to be packaged as JAR and then included into an EAR.</li>
<li>The JSF 2.0 simplifies the development of UI components.The JSF 2.0 has integrated Ajax and CDI support. &nbsp; </li>
</ul><b>Note</b>: "<b>Convention over configuration</b>" is a design paradigm, which seeks to standardize, simplify, and decrease the number of decisions that developers need to make without compromising on flexibility. For example, ANT build tool allowed you to come up with any project structure, whereas Maven is strict on convention as to how the project is structured.<br />
<br />
<b>Q.</b> How does the new bean validation framework avoid duplication?<br />
<b>A.</b> Developers often code the same validation logic in multiple layers of an application, which is time consuming and error-prone. At times they put the validation logic in their data model, cluttering it with what is essentially metadata. JEE 6 Improves validation and duplication with a much improved annotation based bean validation. Bean Validation offers a framework for validating Java classes written according to JavaBeans conventions. You use annotations to specify constraints on a JavaBean. For example,<br />
<br />
The JavaBean is defined below<br />
<br />
<pre class="brush: csharp">public class Contact {

    @NotEmpty @Size(max=100)
    private String firstName;

    @NotEmpty @Size(max=100)
    private String surname;
    
    @NotEmpty @Pattern("[a-zA-Z]+")
    private String category;
    
    @ShortName
    private String shortName; //custom validation 

    ...

    public String getFirstName() {
        return firstName;
    }

    public void setFirstName(String firstName) {
        this.firstName = firstName;
    }

    ...
}
</pre><br />
Custom validators can be defined by defining an annotation and relevant implementation<br />
<br />
<pre class="brush: csharp">@ConstraintValidator(ShortNameValidator.class)
@Documented
@Target({ElementType.METHOD, ElementType.FIELD, ElementType.ANNOTATION_TYPE})
@Retention(RUNTIME)
public @interface ShortName {
       String message() default "Wrong name";
       String[] groups() default {};
}

</pre><br />
<br />
Next the validation implementation class<br />
<br />
<pre class="brush: csharp">public class ShortNameValidator implements ConstraintValidator &lt;Contact, String&gt; {

    private final static Pattern SHORTNAME_PATTERN = Pattern.compile("[a-zA-Z]{5,30}");

    public void initialize(Contact constraintAnnotation) {
        // nothing to initialize
    }
 
 
 public boolean isValid(String value, ConstraintValidatorContext context) {
        return SHORTNAME_PATTERN.matcher(value).matches();
    }

} 

</pre><br />
You could use the validator as shown below<br />
<br />
<pre class="brush: csharp">Contact contact = new Contact();
conatct.setFirstName("Peter");
//.... set other values

ValidatorFactory validatorFactory = Validation.buildDefaultValidatorFactory();
Validator validator = validatorFactory.getValidator();
 
Set&lt;ConstraintViolation&lt;Contact&gt;&gt; violations = validator.validate(Contact);

</pre><br />
<br />
<b>Q. </b>What are the benefits of the asynchronous processing support that was introduced in Servlet 3.0 in JEE 6?<br />
<b>A. </b><br />
<br />
<b>1.</b> If you are building an online chess game or a chat application, the client browser needs to be periodically refreshed to reflect the changes. This used to be achieved via a technique known as the <b>server-polling </b>(aka <b>client pull </b>or <b>client refresh</b>). You can use the HTML  tag &lt;META&gt; for polling the server. This tag tells the client  it must  refresh the page after a number of seconds.  <br />
<br />
<pre class="brush: csharp">&lt;META http-equiv="Refresh" content="10"; url="newPage.html" /&gt;
</pre><br />
The URL newPage.html will be refreshed every 10 seconds. This approach has the downside of wasting network bandwidth and server resources. With the  introduction of this asynchronous support, the data can be sent via the mechanism known as the <b>server push </b>as opposed to server polling. So, the client waits for the server to push the updates as opposed to frequently polling the server.<br />
<br />
<br />
<br />
<b>2.</b> The Ajax calls are integral part of any web development as it provides richer user experience. This also means that with Ajax, the clients (i.e. browsers) interact more frequently with the server compared to the page-by-page request model. If an Ajax request needs to tap into server side calls that are very time consuming (e.g. report generation), the synchronous processing of these Ajax  requests can degrade the overall performance of the application because these threads will be blocked as the servers generally use a thread pool with <u>finite number of threads</u> to service concurrent requests. The asynchronous processing will allow these time consuming requests to be throttled via a queue, and the same thread(s) to be recycled to process queued requests without having to chew up the other threads from the server thread-pool. This approach can be used for non Ajax requests as well.<br />
<br />
<br />
<b>Note</b>: In JEE 6, The EJB 3.1 can also specify a Session Bean to be asynchronous.<br />
<br />
<br />
<br />
<b>Q.</b> What are benefits of web fragements introduced in Servelt 3.0 spec? <br />
<b>A.</b> Web applications use frameworks like JSF, Struts, Spring MVC, Tapestry, etc. These frameworks normally bootsrap (i.e register) via the web.xml file using the &lt;servlet&gt; and &lt;listener&gt; tags. For example<br />
<br />
<br />
The <b>web.xml </b>file<br />
<br />
<pre class="brush: csharp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;web-app version="2.5" 
    xmlns="http://java.sun.com/xml/ns/javaee" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee 
    http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"&gt;

    &lt;servlet&gt;
        &lt;servlet-name&gt;My JSFServlet&lt;/servlet-name&gt;
        &lt;servlet-class&gt;javax.faces.webapp.FacesServlet&lt;/servlet-class&gt;
        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
    &lt;/servlet&gt;

    &lt;servlet-mapping&gt;
        &lt;servlet-name&gt;My JSFServlet&lt;/servlet-name&gt;
        &lt;url-pattern&gt;/faces/*&lt;/url-pattern&gt;
    &lt;/servlet-mapping&gt;

&lt;/web-app&gt;
</pre><br />
If a particular application uses more than one framework, the above approach is not modular as you will have to bootstrap all the frameworks within the same web.xml file, making it large and difficult to isolate framework specific descriptors. The Servlet 3.0 specification addresses this issue by introducing web fragments. A web fragment can be considered as one of the segment of the whole web.xml and it can be thought of as  one or more web fragments constituting a single web.xml file. The fragment files are stored under /META-INF/web-fragment.xml, and it is the responsibility of the container to scan the fragement files during the server start-up.<br />
<br />
The<b> web-fragment.xml </b>file<br />
<br />
<pre class="brush: csharp">&lt;web-fragment&gt;
    &lt;servlet&gt;
        &lt;servlet-name&gt;myFrameworkSpecificServlet&lt;/servlet-name&gt;
        &lt;servlet-class&gt;myFramework.myFrameworkServlet &lt;/servlet-class&gt;
    &lt;/servlet&gt;

    &lt;listener&gt;
        &lt;listener-class&gt;myFramework.myFrameworkListener&lt;/listener-class&gt;
    &lt;/listener&gt;
&lt;/web-fragment&gt;
</pre><br />
<br />
<b>Note</b>: The Servlet 3.0 specification also provides enhanced pluggability by providing an option to add servlets, filters, servlet mappings and filter mappings during the run time.<br />
<br />
<br />
<b>Q.</b> What do you understand by the term "Web profile" in Java EE 6?<br />
<b>A.</b> Java EE 6 introduces the concept of <b>profiles </b>as a way to slimming the footprint of the Java EE platform and better target it for specific audiences. Profiles are configurations of the Java EE platform that are designed for specific classes of applications. For example, the required elements for a Web profile are<br />
<br />
<ul><li>Java EE 6 (JSR-316)</li>
<li>Common Annotations for Java Platform 1.1 (JSR-250)</li>
<li>Dependency Injection for Java 1.0 (JSR-330)</li>
<li>Contexts and Dependency Injection for Java EE platform 1.0 (JSR-299)</li>
<li>Servlet 3.0 (JSR-315)</li>
<li>JavaServer Pages (JSP) 2.2 (JSR-245)</li>
<li>Expression Language (EL) 2.2 (JSR-245)</li>
<li>Debugging Support for Other Languages 1.0 (JSR-45)</li>
<li>Standard Tag Library for JavaServer Pages (JSTL) 1.2 (JSR-52)</li>
<li>JavaServer Faces (JSF) 2.0 (JSR-314)</li>
<li>Enterprise JavaBeans (EJB) 3.1 Lite (JSR-318)</li>
<li>Java Transaction API (JTA) 1.1 (JSR-907)</li>
<li>Java Persistence API (JPA) 2.0 (JSR-317)</li>
<li>Bean Validation 1.0 (JSR-303)</li>
<li>Managed Beans 1.0 (JSR-316)</li>
<li>Interceptors 1.1 (JSR-318)</li>
</ul><br />
<br />
The JEE 6 has also introduced the concept known as "<b>pruning</b>" to manage complexities. This is similar to the concept introduced in Java SE 6. Pruning is performed as a multistep process where a candidate is declared in one release but may be relegated to an optional component in the next release, depending on community reaction. For example, JAX-RPC will be pruned and replaced by JAX-WS. However, if Java EE application server vendors do include a pruned technology, they must do so in a compatible way, such that existing applications will keep running. The profiles and pruning are debatable topics and only time will tell if they work or not.<br />
<br />
More relevant JEE questions and&nbsp; answers:<br />
<br />
<ul><li><a href="http://java-success.blogspot.com.au/2011/09/enterprise-java-interview-questions-and.html">Enterprise Java interview questions and answers -- overview</a></li>
</ul><div style="clear:both; padding-bottom:0.25em"></div><p class="blogger-labels">Labels: <a rel='tag' href="http://java-success.blogspot.com/search/label/Java%20EE">Java EE</a></p>
    </p>
    </div>
    
    <p class="post-footer">
      <em>posted by Arulkumaran Kumaraswamipillai at 
    <a class="post-footer-link" href="http://java-success.blogspot.in/2012/03/enterprise-java-interview-questions-and.html" title="permanent link"> 3/07/2012 05:42:00 PM </a></em>

       |
      <a class="comment-link" href="http://java-success.blogspot.in/2012/03/enterprise-java-interview-questions-and.html#comment-form"location.href=http://java-success.blogspot.com/2012/03/enterprise-java-interview-questions-and.html#comment-form;><span style="text-transform:lowercase">1 Comments</span></a>
      
<a class="comment-link" href="http://java-success.blogspot.in/2012/03/enterprise-java-interview-questions-and.html#links"><span style="text-transform:lowercase">Links to this post</span></a>

  <span class="item-action"><a href="https://www.blogger.com/email-post.g?blogID=35897879&postID=8762366784212257197" title="Email Post"><img class="icon-action" alt="" src="https://img2.blogblog.com/img/icon18_email.gif" height="13" width="18"/></a></span><span class="item-control blog-admin pid-341905326"><a style="border:none;" href="https://www.blogger.com/post-edit.g?blogID=35897879&postID=8762366784212257197&from=pencil" title="Edit Post"><img class="icon-action" alt="" src="https://img2.blogblog.com/img/icon18_edit_allbkg.gif" height="18" width="18"></a></span>
    </p>
  
  </div>
  <!-- End .post -->
  
  
  
  <!-- Begin #comments -->
 
  <!-- End #comments -->
  






<script type="text/javascript"><!--
google_ad_client = "pub-3764234023451771";
google_ad_host = "pub-1556223355139109";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al";
google_ad_channel = "";
//-->
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>


  <h2 class="date-header">Mar 1, 2012</h2>

  
  
     
  <!-- Begin .post -->
  <div class="post"><a name="1108086149371246307"></a>
    
         
    


    <h3 class="post-title">
	 
	 Database interview questions and answers
	 
    </h3>

    
     
    <div class="post-body">
    <p>
      <div style="clear:both;"></div><script type="text/javascript"><!--
google_ad_client = "ca-pub-3764234023451771";
/* Leader board */
google_ad_slot = "4890304945";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>

<br/>
<br/>



<b>Q.</b> What do you understand by the terms clustered index and non-clustered index?<br />
<b>A.</b> When you create a clustered index on a table, all the rows in the table are stored in the order of the clustered index key. So, there can be only one clustered index per table. Non-clustered indexes have their own storage space separate from the table data storage. Clustered and non-clustered indexes are stored as binary search tree (i.e. keep data sorted and has the average performance of O(log n) for delete, inserts, and search) structures with the leaf level nodes having the index key and it's row locator for a faster retrieval.<br />
<br />
<br />
<br />
<b>Q.</b> What is the difference between primary key and unique key?<br />
<b>A.</b> Both primary key and unique key enforce uniqueness of the column on which they are defined. But by default, a primary key creates a clustered index on the column, whereas a unique key creates a non clustered index by default. Another major difference is that, a primary key doesn't allow NULL values, but unique key allows a single NULL.<br />
<br />
<b>Q.</b> What are the pros and cons of an index?<br />
<b>A. </b><br />
<br />
<b>PROS</b><br />
<br />
<ul><li>If an index does not exist on a table, a table scan must be performed for each table referenced in a database query. The larger the table, the longer a table scan takes because a table scan requires each table row to be accessed sequentially. So, indexes can improve search performance, especially for the reporting requirements.</li>
</ul><br />
<br />
<b>CONS</b><br />
<br />
<ul><li>Excessive non-clustered indexes can consume additional storage space.</li>
<li>Excessive non-clustered indexes can adversely impact performance of the INSERT, UPDATE, and DELETE statements as the indexes need to recreated after each of the above operation.</li>
</ul>So, it is essential to have a right balance based on the<b> usage pattern</b>.<br />
<ul></ul><br />
<br />
<b>Q. </b>What are the pros and cons of stored procedures?<br />
<b>A. </b><br />
<br />
<b>PROS</b><br />
<br />
<ul><li>pre-compiled and less network trips for faster performance</li>
<li>less susceptible to SQL injection attacks</li>
<li>more precise control over transactions and locking</li>
<li>can abstract complex data processing from application by acting as a <b>facade layer</b>.</li>
</ul><br />
<b>CONS</b><br />
<br />
<ul><li>There are chances of&nbsp; larger chunks of business logic and duplications creeping into stored procedures and causing maintenance issues. Writing and maintaining stored procedures is most often a specialized skill set that not all developers possess. This situation may introduce bottlenecks in the project development schedule.</li>
<li>Less portable.The stored procedures are specific to a particular database. </li>
<li>Scaling a database is much harder than scaling an application.</li>
<li>The application performance can be improved by caching the relevant data to reduce the network trips.</li>
</ul><br />
<br />
<b>So, when should stored procedures be used ?</b><br />
<br />
Stored procedures are ideal when there is a complex piece of business logic that needs complex data logic to be performed involving a lot of database operations. If this logic is required in many different places, then store procedure makes even more sense. For example, batch jobs and complex report generation that performs lots of database operations.<br />
<br />
<br />
<b>So, when shouldn't stored procedures be used ?</b><br />
<br />
When you are performing basic CRUD (Create, Read, Update, and Delete) operations. For example, in a Web application a user creates some data, read the created data, and then updates or deletes some of the created data. <br />
<br />
<br />
<br />
<b>Q.</b> How would you go about writing a stored procedure that needs to loop through a number of selected rows?<br />
<b>A.</b> You need to use a cursor. A cursor is basically a pointer to row by operation. For example, you can create a cursor by selecting a number of records into it. Then, you can fetch each row at a time and perform some operations like invoking another stored proc by passing the selected row value as an argument, etc. Once uou have looped through all the records, you need to close and deallocate the cursor. For example, the stored procedure below written in Sybase demonstrates the use of a cursor.<br />
<br />
Apply to the database "mydatabase"<br />
<br />
<pre class="brush: csharp">use mydatabase
go

</pre><br />
<br />
Drop the stored procedure if it already exists<br />
<br />
<pre class="brush: csharp">IF OBJECT_ID('dbo.temp_sp') IS NOT NULL
BEGIN 

    DROP PROCEDURE dbo.temp_sp
    IF OBJECT_ID('dbo.temp_sp') IS NOT NULL
        PRINT '&lt;&lt;&lt; FAILED DROPPING PROCEDURE dbo.temp_sp &gt;&gt;&gt;'
    ELSE
        PRINT '&lt;&lt;&lt; DROPPED PROCEDURE dbo.temp_sp &gt;&gt;&gt;'
END
go

</pre><br />
Create the stored procedure that uses cursor<br />
<br />
<br />
<pre class="brush: csharp">create proc temp_sp 

as
   DECLARE @ADVISERID char(10)
   DECLARE advisers_cur cursor 
     for select adviser_id  FROM  tbl_advisers where adviser_id like 'Z%'  -- select adviser_ids starting with 'Z'
     for read only
    
   
   open  advisers_cur                     -- open the cursor
   FETCH advisers_cur INTO @ADVISERID     -- store value(s) from the cursor into declared variables
   
   --@@sqlstatus is a sybase implcit variable that returns success/failure status of previous statement execution
   WHILE (@@sqlstatus = 0)
   BEGIN
      SELECT @ADVISERID                   -- select the adviser_id stored into  @ADVISERID
      FETCH advisers_cur INTO @ADVISERID  --store value(s) from the cursor into declared variables
   END

   close advisers_cur
   deallocate cursor advisers_cur

go

</pre><br />
Execute the stored procedure that uses a cursor<br />
<br />
<br />
<pre class="brush: csharp">exec mydatabase..temp_sp
</pre><br />
<br />
<b>Q. </b>Why should you deallocate the cursors?<br />
<b>A.</b> You need deallocate the cursor to clear the memory space occupied by the cursor.  This will enable the cleared space to be availble for other use.<br />
<br />
<br />
<b>Q.</b> How would you go about copying bulk data in and out of a database? <br />
<b>A.</b> The process is known as bulk copy, and the tools used for this are database specific. For example, in Sybase and SQLServer use a utility called "bcp", which allows you to export bulk data into comma delimited files, and then import the data in csv or any other delimited formats back into different database or table. In Oracle database, you achieve this via the SQLLoader. The DB2 database has IMPORT and LOAD command to achieve the same.<br />
<br />
<br />
<b>Q.</b> What are triggers? what are the different types of triggers?<br />
<b>A. </b>Triggers are stored procedures that are stored in the database and implicitly run, or fired, when something like INSERT, UPDATE , or DELETE happens to that table. There are 3 types of DML triggers that happens before or after events like INSERT, UPDATE, or DELETE. There could be other database specific triggers.<br />
<br />
<b>Q.</b> When to not use a trigger, and when is it appropriate to use a trigger?<br />
<b>A.</b><br />
<br />
<b>When to not use  a trigger?</b><br />
<br />
<br />
The database triggers need to be used very judiciously as they are executed every time an event like insert, update or delete occur.   Don't use a trigger  where<br />
<ul><li>database constraints like unique constraint, not null, primary key, check constraints, etc can be used to check for data validity.</li>
<li>triggers are recursive.</li>
</ul><br />
<b>Where to use a trigger?</b><br />
<br />
<ul><li>Maintaining complex integrity constraints (referential integrity) or business rules where other types of constraints cannot be used. Because triggers are executed as part of the SQL statement (and its containing transaction) causing the row change event, and because the trigger code has direct access to the changed row, you could in theory use them to correct or reject invalid data.</li>
<li>Auditing information in a table by recording the changes. Some tables are required to be audited as part of the non-functional requirement for changes.</li>
<li>Automatically signaling other programs that action needs to take place when changes are made to a table.</li>
<li>Collecting and maintaining aggregate or statistical data.&nbsp;</li>
</ul><br />
<br />
<b>Q. </b>If one of your goals is to reduce network loads, how will you about achieving it?<br />
<b>A. </b><br />
<ul><li>you can use materialized views to distribute your load from a master site to other regional sites. Instead of the entire company accessing a single database server, user load is distributed across multiple database servers with the help of multi-tier materialized views. This enables you to distribute the load to&nbsp; materialized view sites instead of master sites. To decrease the amount of data that is replicated, a materialized view can be a subset of a master table or master materialized view.</li>
</ul><br />
<ul><li>Write stored procedures to minimize network round trips.</li>
</ul><br />
<ul><li>Carefully crafting your SQL to return only required data. For example Don't do select * from tbl_mytable. Instead, specify the columns you are interested in. For example, select firstname, surname from tbl_mytable.</li>
</ul><br />
<ul><li>You can set the fetch size to an appropriate value to get the right balance between data size and number of network trips made.&nbsp;</li>
</ul><b>Q.</b> What are the other uses of materialized views?<br />
<b>A. </b><br />
<ul><li>Materialized view is one of the key SQL tuning approaches to improve performance by allowing you to pre-join complex views and pre-compute summaries for super-fast response time.</li>
</ul><br />
<ul><li>Materialized views are schema objects that can be used to summarize, precompute, replicate, and distribute data. E.g. to construct a data warehouse, reporting, etc. A materialized view can be either read-only, updatable, or writable. Users cannot perform data manipulation language (DML) statements on read-only materialized views, but they can perform DML on updatable and writable materialized views.</li>
</ul><br />
<ul><li>A materialized view provides indirect access to table data by storing the results of a query in a separate schema object. Unlike an ordinary view, which does not take up any storage space or contain any data. You can define a materialized view on a base table, partitioned table or view and you can define indexes on a materialized view. </li>
</ul><br />
<b>Q.</b> If you are working with a legacy application, and some of the database tables are not properly designed with the appropriate constraints, how will you go about rectifying the situation?<br />
<b>A.</b> One possible solution is to write triggers to perform the appropriate validation. Here is an example of an insert trigger.<br />
<br />
<pre class="brush: csharp">CREATE TRIGGER TableA_itrig
  ON TableA  FOR INSERT
AS
BEGIN
 
 IF @@rowcount = 0
  RETURN

 IF NOT EXISTS
 (
  SELECT  *
  FROM  inserted ins, TableB ol
  WHERE  ins.code = ol.code
 )
 
 BEGIN
  RAISERROR 20001, "The associated object is not found"
  ROLLBACK TRAN
  RETURN
 END
 
END
</pre><br />
<br />
<b>Q. </b>If you are working on a new application that requires stringent auditing requirements, how would you go about achieving it?<br />
<b>A.</b> Since it is a new application, there are a number of options as listed below.<br />
&nbsp; <br />
<ul><li>The application is designed from the beginning so that all changes are logged either synchronously or asynchronously. Asynchronously means publishing the auditing messages to a queue or topic, and a separate process will receive these messages and write a database or flat file. All data changes go through a data access layer of the application which logs all changes<br />
&nbsp;&nbsp;&nbsp;&nbsp;</li>
<li>The database is constructed in such a way that logging information is included in each table, perhaps set via a trigger. This approach may adversely impact performance when inserts and updates are very frequent. </li>
</ul><br />
<b>Q. </b>What if you have to work with an existing legacy application?<br />
<b>A.&nbsp;</b> Use triggers.<br />
<br />
<br />
<a href="http://java-success.blogspot.com.au/2011/10/sql-interview-questions-and-answers.html"><b>SQL Interview Questions and Answers </b></a><div style="clear:both; padding-bottom:0.25em"></div><p class="blogger-labels">Labels: <a rel='tag' href="http://java-success.blogspot.com/search/label/Database">Database</a></p>
    </p>
    </div>
    
    <p class="post-footer">
      <em>posted by Arulkumaran Kumaraswamipillai at 
    <a class="post-footer-link" href="http://java-success.blogspot.in/2012/02/database-interview-questions-and.html" title="permanent link"> 3/01/2012 01:11:00 PM </a></em>

       |
      <a class="comment-link" href="http://java-success.blogspot.in/2012/02/database-interview-questions-and.html#comment-form"location.href=http://java-success.blogspot.com/2012/02/database-interview-questions-and.html#comment-form;><span style="text-transform:lowercase">3 Comments</span></a>
      
<a class="comment-link" href="http://java-success.blogspot.in/2012/02/database-interview-questions-and.html#links"><span style="text-transform:lowercase">Links to this post</span></a>

  <span class="item-action"><a href="https://www.blogger.com/email-post.g?blogID=35897879&postID=1108086149371246307" title="Email Post"><img class="icon-action" alt="" src="https://img2.blogblog.com/img/icon18_email.gif" height="13" width="18"/></a></span><span class="item-control blog-admin pid-341905326"><a style="border:none;" href="https://www.blogger.com/post-edit.g?blogID=35897879&postID=1108086149371246307&from=pencil" title="Edit Post"><img class="icon-action" alt="" src="https://img2.blogblog.com/img/icon18_edit_allbkg.gif" height="18" width="18"></a></span>
    </p>
  
  </div>
  <!-- End .post -->
  
  
  
  <!-- Begin #comments -->
 
  <!-- End #comments -->
   

</div></div>
<!-- End #main -->







<!-- Begin #sidebar -->
<div id="sidebar"><div id="sidebar2">

  
  
  <h2 class="sidebar-title">Previous Posts</h2>
    <ul id="recently">
    
        <li><a href="http://java-success.blogspot.in/2014/11/are-you-java-beginner-why-good-java.html">Are you a Java beginner? Why good Java developers ...</a></li>
     
        <li><a href="http://java-success.blogspot.in/2014/11/java-exception-handling-beginner.html">Java exception handling beginner mistakes and best...</a></li>
     
        <li><a href="http://java-success.blogspot.in/2014/11/unix-interview-questions-and-answers.html">Unix Interview Questions and Answers for Java deve...</a></li>
     
        <li><a href="http://java-success.blogspot.in/2014/10/debugging-and-working-like-pro-with.html">Debugging and working  like a pro with a Java appl...</a></li>
     
        <li><a href="http://java-success.blogspot.in/2014/10/yammer-metrics-to-monitor-restful-web_22.html">Yammer metrics to monitor RESTful web services and...</a></li>
     
        <li><a href="http://java-success.blogspot.in/2014/10/when-to-use-which-java-collection-or.html">When to use which Java collection or data structur...</a></li>
     
        <li><a href="http://java-success.blogspot.in/2011/09/how-to-prepare-for-javajee-job.html">How to prepare or train for Java and JEE Job Inter...</a></li>
     
        <li><a href="http://java-success.blogspot.in/2014/10/yammer-metrics-to-monitor-restful-web.html">Yammer metrics to monitor RESTful web services wit...</a></li>
     
        <li><a href="http://java-success.blogspot.in/2014/09/monitoring-and-gathering-statistics.html">Monitoring and gathering statistics with JMX based...</a></li>
     
        <li><a href="http://java-success.blogspot.in/2014/08/what-are-different-ways-java-thread.html">What are the different ways a Java thread gets blo...</a></li>
     
  </ul>
  
  
  
  <h2 class="sidebar-title">Archives</h2>

    <ul class="archive-list">
   	  
    	<li><a href="http://java-success.blogspot.in/2006_10_01_archive.html">October 2006</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2006_11_01_archive.html">November 2006</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2007_05_01_archive.html">May 2007</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2007_10_01_archive.html">October 2007</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2007_12_01_archive.html">December 2007</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2008_08_01_archive.html">August 2008</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2010_02_01_archive.html">February 2010</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2010_10_01_archive.html">October 2010</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2010_11_01_archive.html">November 2010</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2010_12_01_archive.html">December 2010</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2011_01_01_archive.html">January 2011</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2011_07_01_archive.html">July 2011</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2011_09_01_archive.html">September 2011</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2011_10_01_archive.html">October 2011</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2011_11_01_archive.html">November 2011</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2011_12_01_archive.html">December 2011</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2012_01_01_archive.html">January 2012</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2012_02_01_archive.html">February 2012</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2012_03_01_archive.html">March 2012</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2012_04_01_archive.html">April 2012</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2012_05_01_archive.html">May 2012</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2012_06_01_archive.html">June 2012</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2012_07_01_archive.html">July 2012</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2012_08_01_archive.html">August 2012</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2012_09_01_archive.html">September 2012</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2012_10_01_archive.html">October 2012</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2012_11_01_archive.html">November 2012</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2012_12_01_archive.html">December 2012</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2013_01_01_archive.html">January 2013</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2013_02_01_archive.html">February 2013</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2013_03_01_archive.html">March 2013</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2013_04_01_archive.html">April 2013</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2013_05_01_archive.html">May 2013</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2013_06_01_archive.html">June 2013</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2013_07_01_archive.html">July 2013</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2013_08_01_archive.html">August 2013</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2013_09_01_archive.html">September 2013</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2013_10_01_archive.html">October 2013</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2013_11_01_archive.html">November 2013</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2013_12_01_archive.html">December 2013</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2014_01_01_archive.html">January 2014</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2014_02_01_archive.html">February 2014</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2014_03_01_archive.html">March 2014</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2014_04_01_archive.html">April 2014</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2014_05_01_archive.html">May 2014</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2014_06_01_archive.html">June 2014</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2014_07_01_archive.html">July 2014</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2014_08_01_archive.html">August 2014</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2014_09_01_archive.html">September 2014</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2014_10_01_archive.html">October 2014</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2014_11_01_archive.html">November 2014</a></li>
	  

  </ul>
  
  
  
  <!-- Begin #profile-container -->
  
    <div id="profile-container"><h2 class="sidebar-title">About Me</h2>
<dl class="profile-datablock"><dt class="profile-img"><a href="https://plus.google.com/109240621969095737337"><img src="//lh3.googleusercontent.com/-XMLxx0v_R7A/AAAAAAAAAAI/AAAAAAAACxk/8BeHFmsEuy8/s80-c/photo.jpg" width="80" height="80" alt="My Photo"></a></dt>
<dd class="profile-data"><strong>Name:</strong> <a rel="author" href="https://plus.google.com/109240621969095737337"> Arulkumaran Kumaraswamipillai </a></dd>
</dl>
<p class="profile-textblock">Java freelancer from Australia. As a contractor, attended 100+ job interviews and received multiple job offers. Authored Java career books that sold over 30,000 copies.<br><br><a href="http://www.java-success.com" rel="nofollow" target="_blank">www.java-success.com</a> for 500+ Java/JEE job interview questions and answers and tutorials.<br></p>
<p class="profile-link"><a rel="author" href="https://plus.google.com/109240621969095737337">View my complete profile</a></p></div>
  
  <!-- End #profile -->

  
  <p id="powered-by"><a href="http://www.blogger.com"><img src="http://buttons.blogger.com/bloggerbutton1.gif" alt="Powered by Blogger" /></a></p>
  <p id="blogfeeds">Subscribe to<br />Posts [<a target="_blank" href="http://java-success.blogspot.com/feeds/posts/default" type="application/atom+xml">Atom</a>]</p>

  <script type="text/javascript"><!--
google_ad_client = "pub-3764234023451771";
google_ad_host = "pub-1556223355139109";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>  
   
  <!--
  <p>This is a paragraph of text that could go in the sidebar.</p>
  -->
  
  <script type="text/javascript"><!--
google_ad_client = "pub-3764234023451771";
google_ad_host = "pub-1556223355139109";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>  



</div></div>
<!-- End #sidebar -->




<!-- Begin #footer -->
<div id="footer"><hr />

  <p><!-- This is an optional footer. If you want text here, place it inside these tags, and remove this comment. -->&nbsp;</p>

  </div>
<!-- End #footer -->




</div>
<!-- End #content -->






</div></div></div></div>
<!-- End wraps -->

</body>
</html>