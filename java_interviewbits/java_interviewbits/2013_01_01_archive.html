<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<head>
  <title>Java-Success Blog: January 2013</title>

  <link href='http://www.java-success.com' rel='canonical'/>

  


  <script type="text/javascript">(function() { (function(){function c(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(l){}};this.tick("start",null,a)}var a,e;window.performance&&(e=(a=window.performance.timing)&&a.responseStart);var h=0<e?new c(e):new c;window.jstiming={Timer:c,load:h};if(a){var b=a.navigationStart;0<b&&e>=b&&(window.jstiming.srt=e-b)}if(a){var d=window.jstiming.load;0<b&&e>=b&&(d.tick("_wtsrt",void 0,b),d.tick("wtsrt_","_wtsrt",
e),d.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),d&&0<b&&(d.tick("_tbnd",void 0,window.chrome.csi().startE),d.tick("tbnd_","_tbnd",b))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,d&&0<b&&(d.tick("_tbnd",void 0,window.external.startE),d.tick("tbnd_","_tbnd",b))),a&&(window.jstiming.pt=a)}catch(k){}})();window.tickAboveFold=function(c){var a=0;if(c.offsetParent){do a+=c.offsetTop;while(c=c.offsetParent)}c=a;750>=c&&window.jstiming.load.tick("aft")};var f=!1;function g(){f||(f=!0,window.jstiming.load.tick("firstScrollTime"))}window.addEventListener?window.addEventListener("scroll",g,!1):window.attachEvent("onscroll",g);
 })();</script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="Blogger" />
<link rel="icon" type="image/vnd.microsoft.icon" href="https://www.blogger.com/favicon.ico"/>
<link rel="alternate" type="application/atom+xml" title="Java-Success Blog - Atom" href="http://java-success.blogspot.com/feeds/posts/default" />
<link rel="alternate" type="application/rss+xml" title="Java-Success Blog - RSS" href="http://java-success.blogspot.com/feeds/posts/default?alt=rss" />
<link rel="service.post" type="application/atom+xml" title="Java-Success Blog - Atom" href="https://www.blogger.com/feeds/35897879/posts/default" />
<link rel="stylesheet" type="text/css" href="https://www.blogger.com/static/v1/v-css/50269083-blog_controls.css"/>
<link rel="stylesheet" type="text/css" href="https://www.blogger.com/dyn-css/authorization.css?targetBlogID=35897879&zx=32ffd7df-5810-469f-a666-048e5011b3eb"/>
<script type="text/javascript" src="https://www.blogger.com/static/v1/v-js/979395223-backlink.js"></script>
<script type="text/javascript" src="https://www.blogger.com/static/v1/v-js/4080670514-backlink_control.js"></script>
<script type="text/javascript">var BL_backlinkURL = "https://www.blogger.com/dyn-js/backlink_count.js";var BL_blogId = "35897879";</script>


  <style type="text/css">
/*
-----------------------------------------------
Blogger Template Style
Name:     Harbor
Designer: Douglas Bowman
URL:      www.stopdesign.com
Date:     24 Feb 2004
----------------------------------------------- */


body {
  background:#fff url("http://www.blogblog.com/harbor/rocks.jpg") no-repeat right bottom;
  background-attachment:fixed;
  margin:0;
  padding:0;
  font:x-small Georgia,Serif;
  color:#333;
  font-size/* */:/**/small;
  font-size: /**/small;
  }
/* Commented Backslash Hack hides rule from IE5-Mac \*/
  body {background-attachment:scroll;}
  /* End IE5-Mac hack */
a:link {
  color:#36a;
  text-decoration:none;
  }
a:visited {
  color:#764;
  text-decoration:none;
  }
a:hover {
  color:#933;
  text-decoration:underline;
  }
a img {
  border-width:0;
  }


/* Page Structure
----------------------------------------------- */
#wrap {
  background:url("http://www.blogblog.com/harbor/sky.jpg") repeat-x left top;
  min-width:740px;
  margin:0;
  padding:0;
  text-align:left;
  }
#wrap2 {
  background:url("http://www.blogblog.com/harbor/lighthouse.jpg") no-repeat left top;
  }
#wrap3 {
  background:url("http://www.blogblog.com/harbor/cloud.jpg") no-repeat 100% 75px;
  }
#wrap4 {
  background:url("http://www.blogblog.com/harbor/center_cloud.jpg") no-repeat 50% 0;
  padding:15px;
  width:100%;
  width/* */:/**/auto;
  width: /**/auto;
  }
@media all {
  #content {
    max-width:890px;
    padding:0 30px 50px;
    width:100%;
    width/* */:/**/auto;
    width: /**/auto;
    }
  html>body #content {
    border:3px double #fff;
    }
  #main {
    width:64%;
    float:right;
    }
  #main2 {
    margin:0;
    padding:0;
    }
  #sidebar {
    width:32%;
    float:left;
    }
  #sidebar2 {
    margin:0;
    padding:170px 0 20px;
    }
  }
@media handheld {
  #content {
    width:90%;
    }
  #main {
    width:100%;
    float:none;
    }
  #sidebar {
    width:100%;
    float:none;
    }
  }

/* Header
----------------------------------------------- */
@media all {
  #header {
    padding:15px 0 10px 110px;
    }
  }
@media handheld {
  #header {
    width:100%;
    padding:15px 0 10px 0;
    }
  }
#blog-title {
  margin:0 0 .25em;
  font-size:270%;
  font-weight:normal;
  color:#678;
  }
#blog-title a {
  color:#678;
  text-decoration:none;
  }
#description {
  margin:0;
  max-width:700px;
  font-size:75%;
  line-height:1.8em;
  text-transform:uppercase;
  letter-spacing:.2em;
  color:#789;
  }


/* Headings
----------------------------------------------- */
h2 {
  margin:1.5em 0 .75em;
  font:78%/1.4em Georgia,Serif;
  text-transform:uppercase;
  letter-spacing:.2em;
  color:#933;
  }


/* Posts
----------------------------------------------- */
.date-header {
  margin:2em 0 .5em;
  }
.post {
  margin:.5em 0 1.5em;
  line-height:1.6em;
  }
.post-title {
  margin:.25em 0 0;
  padding:0 0 4px;
  font-size:140%;
  font-weight:normal;
  line-height:1.4em;
  }
.post-title a, .post-title strong {
  background:url("http://www.blogblog.com/harbor/icon_lighthouse.gif") no-repeat 0 .15em;
  display:block;
  padding-left:20px;
  text-decoration:none;
  color:#368;
  font-weight:normal;
  }
.post-title strong {
  background-image:url("http://www.blogblog.com/harbor/icon_lighthouse2.gif");
  color:#000;
  }
.post-title a:hover {
  color:#933;
  }
.post-body {
  background:url("http://www.blogblog.com/harbor/divider.gif") no-repeat center top;
  padding-top:12px;
  }
.post p {
  margin:0 0 .75em;
  }
p.post-footer {
  color:#999;
  }
.post-footer em, .comment-link {
  font:78%/1.4em Georgia,Serif;
  text-transform:uppercase;
  letter-spacing:.1em;
  }
.post-footer em {
  font-style:normal;
  color:#666;
  margin-right:.4em;
  }
.comment-link strong {
  font-size:130%;
  }
.comment-link {
  margin-left:.4em;
  }
.post img {
  padding:4px;
  border:1px solid #cde;
  }


/* Comments
----------------------------------------------- */
#comments {
  background:url("http://www.blogblog.com/harbor/divider.gif") no-repeat center top;
  padding:15px 0 0;
  }
#comments h4 {
  margin:1em 0;
  font:bold 78%/1.6em Georgia,Serif;
  text-transform:uppercase;
  letter-spacing:.2em;
  color:#933;
  }
#comments h4 strong {
  font-size:130%;
  }
#comments-block {
  margin:1em 0 1.5em;
  line-height:1.4em;
  }
#comments-block dt {
  margin:.5em 0;
  }
#comments-block dd {
  margin:.25em 20px 0;
  }
#comments-block dd.comment-timestamp {
  margin:-.25em 20px 1.5em;
  font:78%/1.4em Georgia,Serif;
  text-transform:uppercase;
  letter-spacing:.1em;
  }
#comments-block dd p {
  margin:0 0 .75em;
  }
.deleted-comment {
  font-style:italic;
  color:gray;
  }


/* Sidebar Content
----------------------------------------------- */
#sidebar ul {
  background:url("http://www.blogblog.com/harbor/divider.gif") no-repeat center bottom;
  margin:0 0 15px;
  padding:0 0 15px;
  list-style:none;
  }
#sidebar li {
  margin:0;
  padding:0 0 .25em 15px;
  text-indent:-15px;
  line-height:1.5em;
  }
#sidebar p {
  color:#666;
  line-height:1.5em;
  }


/* Profile
----------------------------------------------- */
#profile-container {
  background:url("http://www.blogblog.com/harbor/divider.gif") no-repeat center bottom;
  margin:0 0 2em;
  padding:0 0 15px;
  }
.profile-datablock {
  margin:.5em 0 .5em;
  }
.profile-img {
  display:inline;
  }
.profile-img img {
  float:left;
  padding:4px;
  border:1px solid #cde;
  margin:0 8px 3px 0;
  }
.profile-data {
  margin:0;
  font:bold 78%/1.6em Georgia,Serif;
  text-transform:uppercase;
  letter-spacing:.1em;
  }
.profile-data strong {
  display:none;
  }
.profile-textblock {
  margin:0 0 .5em;
  }
.profile-link {
  font:78%/1.4em Georgia,Serif;
  text-transform:uppercase;
  letter-spacing:.1em;
  }


/* Footer
----------------------------------------------- */
#footer {
  clear:both;
  padding:15px 30px 0 50px;
  }
#footer hr {
  display:none;
  }
#footer p {
  background:url("http://www.blogblog.com/harbor/divider.gif") no-repeat center top;
  margin:0;
  padding-top:15px;
  font:78%/1.6em Georgia,Serif;
  text-transform:uppercase;
  letter-spacing:.1em;
  }


/* Feeds
----------------------------------------------- */
#blogfeeds {
  }
#postfeeds {
  }
  </style>
<!-- --><style type="text/css">@import url(https://www.blogger.com/static/v1/v-css/navbar/3334278262-classic.css);
div.b-mobile {display:none;}
</style>

</head>

<body><script type="text/javascript">
    function setAttributeOnload(object, attribute, val) {
      if(window.addEventListener) {
        window.addEventListener('load',
          function(){ object[attribute] = val; }, false);
      } else {
        window.attachEvent('onload', function(){ object[attribute] = val; });
      }
    }
  </script>
<div id="navbar-iframe-container"></div>
<script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>
<script type="text/javascript">
      gapi.load("gapi.iframes:gapi.iframes.style.bubble", function() {
        if (gapi.iframes && gapi.iframes.getContext) {
          gapi.iframes.getContext().openChild({
              url: 'https://www.blogger.com/navbar.g?targetBlogID\x3d35897879\x26blogName\x3dJava-Success+Blog\x26publishMode\x3dPUBLISH_MODE_BLOGSPOT\x26navbarType\x3dBLUE\x26layoutType\x3dCLASSIC\x26searchRoot\x3dhttp://java-success.blogspot.com/search\x26blogLocale\x3den\x26v\x3d2\x26homepageUrl\x3dhttp://java-success.blogspot.com/\x26vt\x3d2978101103701820782',
              where: document.getElementById("navbar-iframe-container"),
              id: "navbar-iframe"
          });
        }
      });
    </script>

<!-- Begin wraps -->

<div id="wrap"><div id="wrap2"><div id="wrap3"><div id="wrap4">


<!-- Begin #content -->
<div id="content">


<div id="header">

  <h1 id="blog-title">
    
	Java-Success Blog
	
  </h1>

  <p id="description">Java/JEE blog containing interview questions and answers and tutorials</p>

</div>


<!-- Begin #main -->
<div id="main"><div id="main2">

<div class='adsense' style='text-align:center; padding: 0px 3px 0.5em 3px;'>
<script type="text/javascript"><!--
google_ad_client="pub-3764234023451771";
google_ad_host="pub-1556223355139109";
google_ad_width=468;
google_ad_height=60;
google_ad_format="468x60_as";
google_ad_type="text";
google_color_border="FFFFFF";
google_color_bg="FFFFFF";
google_color_link="333333";
google_color_url="009900";
google_color_text="993333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>



</div>

<!-- Search Google -->
<center>
<form method="get" action="http://www.google.com/custom" target="_top">
<table bgcolor="#ffffff">
<tr><td nowrap="nowrap" valign="top" align="left" height="32">
<a href="http://www.google.com/">
<img src="http://www.google.com/logos/Logo_25wht.gif" border="0" alt="Google" align="middle"></img></a>
<label for="sbi" style="display: none">Enter your search terms</label>
<input type="text" name="q" size="31" maxlength="255" value="" id="sbi"></input>
<label for="sbb" style="display: none">Submit search form</label>
<input type="submit" name="sa" value="Search" id="sbb"></input>
<input type="hidden" name="client" value="pub-3764234023451771"></input>
<input type="hidden" name="forid" value="1"></input>
<input type="hidden" name="ie" value="ISO-8859-1"></input>
<input type="hidden" name="oe" value="ISO-8859-1"></input>
<input type="hidden" name="cof" value="GALT:#008000;GL:1;DIV:#336699;VLC:663399;AH:center;BGC:FFFFFF;LBGC:336699;ALC:0000FF;LC:0000FF;T:000000;GFNT:0000FF;GIMP:0000FF;FORID:1"></input>
<input type="hidden" name="hl" value="en"></input>
</td></tr></table>
</form>
</center>
<!-- Search Google -->









<script type="text/javascript"><!--
google_ad_client = "pub-3764234023451771";
google_ad_host = "pub-1556223355139109";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al";
google_ad_channel = "";
//-->
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>


  <h2 class="date-header">Jan 31, 2013</h2>

  
  
     
  <!-- Begin .post -->
  <div class="post"><a name="3030794854611862354"></a>
    
         
    


    <h3 class="post-title">
	 
	 Hibernate automatic dirty checking of persistent objects and handling detached objects
	 
    </h3>

    
     
    <div class="post-body">
    <p>
      <div style="clear:both;"></div>
<script type="text/javascript"><!--
google_ad_client = "ca-pub-3764234023451771";
/* Leader board */
google_ad_slot = "4890304945";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>

<script src="http://pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script>

<br/>
<br/>

<b>Q.</b> What do you understand by automatic dirty checking in Hibernate?<br />
<b>A.</b> <b>Dirty checking </b>is a feature of hibernate that saves time and effort to update the database when states of objects are modified inside a transaction. All persistent objects are monitored by hibernate.It detects which objects have been modified and then calls update statements on all updated objects.<br />
<br />
Hibernate Session contains a <b><i>PersistenceContext </i></b>object that maintains a cache of all the objects read from the database as a Map. So, when you modify an object within the same session, Hibernate compares the objects and triggers the updates when the session is flushed. The objects that are in the PersistenceContext are pesistent objects.<br />
<br />
<b>Q.</b> How do you perform dirty checks for detached objects?<br />
<b>A.</b> When the session is closed, the <i><b>PersistenceContext</b></i> is lost and so is the cached copy, and the persistent object becomes a detached object. Detached objects can be passed all the way to the presentation layer. &nbsp;When you reatch a detached object through <i>merge( ), update( ),</i> or <i>saveOrUpdate( )</i> methods, a new session is created with an empty PersistenceContext, hence there is nothing to compare against to perform the dirty check. Here is how you overcome this scenario with the help of the following annotation <b>selectBeforeUpdate = true</b>, by default it is set to false.<br />
<br />
<br />
<!--INFOLINKS_OFF-->
To save the change to a detached object, you do something like<br />
<br />
<br />
<pre class="brush: csharp">employee.setLastname("Smith");              // modifying a detached object
Session sess = sessionFactory.getSession(); // open a new session with an empty PersistenceContext
Transaction tx = sess.beginTransaction();   //begin a new transaction
sess.update(employee);                      //The detached object becomes a persistent object by reattaching
employee.setFirstName("John");              //modify the persistent object 
tx.commit();
</pre>
<br />
<br />
When the update() call is made, hibernate issues an SQL UPDATE statement. This happens irrespective of weather the object has changed after detaching or not.  One way to avoid this UPDATE statement while reattaching is by setting the select-before-update= “true”. If this is set, hibernates tries to determine if the UPDATE needed by executing the SELECT statement.

<br />
<br />
<pre class="brush: csharp">@Entity
@org.hibernate.annotations.Entity(selectBeforeUpdate = true)
@Table(name = "tbl_employee")
public class Employee extends MyAppDomainObject implements Serializable {
    .....
}
</pre>
<br />
<br />
In rare scenarios, where you are confident that a particular object can never be modified, hence you can tell hibernate that an UPDATE statement will never be needed by setting the following annotation


<br />
<br />
<pre class="brush: csharp">@Entity
@org.hibernate.annotations.Entity(mutable = false)
@Table(name = "tbl_employee")
public class Employee extends MyAppDomainObject implements Serializable {
    .....
}
</pre>
<br />
<br />
Alternatively, if you want to decide if an object's state has changed or not and then decide if a  redundant update call to be made or not, you can implement your own  <b><i>DirtyCheckInterceptor </i></b>by either implementing Hibenate's <i>Inteceptor </i>interface or extending the <i>EmptyInterceptor </i>class. The interceptor can be bootstrapped as shown below
<br />
<br />
<pre class="brush: csharp">SessionFactory.openSession( new DirtyCheckInterceptor() );
</pre>
<br />
<br />
and, Hibernate's <b><i>FlushEntityEventListener's </i></b>onFlushEntity implementation calls the registered interceptor before making an update call.

<br />
<br />
Another possible approach would be to clone the detached objects and store it somewhere in a HttpSession and then use that to populate the PersistenceContext when reattaching the object. For example,

<br />
<br />
<pre class="brush: csharp">Session sess = sessionFactory.getSession();
PersistenceContext persistenceContext = session instanceof SessionImpl ? ((SessionImpl) session).getPersistenceContext(): null;

if (persistenceContext != null) {
  addPreviouslyStoredEntitiesToPersistenceContext(persistenceContext, storedObjects);
}
</pre>
<br />
<br />
<br />
<b>Q. </b>What do you understand by the terms <b>optimistic locking</b> versus<b> pessimistic locking</b>?<br />
<b>A.&nbsp;Optimistic&nbsp;locking</b> means a specific record in the database table is open for all users/sessions. Optimistic locking uses a strategy where you read a record, make a note of the version number and check that the version number hasn't changed before you write the record back. When you write the record back, you filter the update on the version to make sure that it hasn't been updated between when you check the version and write the record to the disk. If the record is dirty (i.e. different version to yours) you abort the transaction and the user can re-start it.<br />
<br />
You could also use other strategies like checking &nbsp;the timestamp or all the modified fields (this is useful for legacy tables that don't have version number or timestamp column). <b>Note</b>: The strategy to compare version numbers and timestamp will work well with detached hibernate objects as well. Hibernate will &nbsp;automatically manage the version numbers.

<br />
<br />
In Hibernate, you can use either long number or Date for versioning
<br />
<br />
<pre class="brush: csharp">@Version
private long id;
</pre>
<br />
<br />
or
<br />
<br />
<pre class="brush: csharp">@Version
private Date version;
</pre>
<br />
<br />
and mark 
<br />
<br />
<pre class="brush: csharp">@Entity
@org.hibernate.annotations.Entity(selectBeforeUpdate = true, optimisticLock=OptimisticLockType.VERSION)
@Table(name = "tbl_employee")
public class Employee extends MyAppDomainObject implements Serializable {
    .....
}
</pre>
<br />
<br />
if you have a legacy table that does not have a version or timestamp column, then use either  
<br />
<br />
<pre class="brush: csharp">@Entity
@org.hibernate.annotations.Entity(selectBeforeUpdate = true, optimisticLock=OptimisticLockType.ALL)
@Table(name = "tbl_employee")
public class Employee extends MyAppDomainObject implements Serializable {
    .....
}
</pre>
<br />
<br />
for all fields and
<br />
<br />
<pre class="brush: csharp">@Entity
@org.hibernate.annotations.Entity(selectBeforeUpdate = true, optimisticLock=OptimisticLockType.DIRTY)
@Table(name = "tbl_employee")
public class Employee extends MyAppDomainObject implements Serializable {
    .....
}
</pre>
<br />
<br />
for dirty fileds only.
<br />
<br />
<b>Pessimistic&nbsp;locking</b> means a specific record in the database table is open for read/write only for that current session. The other session users can not edit the same because you lock the record for your exclusive use until you have finished with it. It has much better integrity than optimistic locking, but requires you to be careful with your application design to avoid deadlocks. In pessimistic locking, appropriate transaction isolation levels need to be set, so that the records can be locked at different levels. The general isolation levels are<br />
<br />
<ul>
<li>Read uncommitted isolation</li>
<li><b>Read committed isolation</b></li>
<li><b>Repeatable read isolation</b></li>
<li>Serializable isolation</li>
</ul>
<br />
<br />
It can be dangerous to use "read uncommitted isolation" as it uses one transaction’s uncommitted changes in a different transaction. The "Serializable isolation" &nbsp;is used to protect phantom reads, phantom reads are not usually problematic, and this isolation level tends to scale very poorly. So, if you are using pessimistic locking, then read commited and repeatable reads are the most common ones.<div style="clear:both; padding-bottom:0.25em"></div><p class="blogger-labels">Labels: <a rel='tag' href="http://java-success.blogspot.com/search/label/Hibernate">Hibernate</a></p>
    </p>
    </div>
    
    <p class="post-footer">
      <em>posted by Arulkumaran Kumaraswamipillai at 
    <a class="post-footer-link" href="http://java-success.blogspot.in/2013/01/hibernate-automatic-dirty-checking-of.html" title="permanent link"> 1/31/2013 10:20:00 AM </a></em>

       |
      <a class="comment-link" href="http://java-success.blogspot.in/2013/01/hibernate-automatic-dirty-checking-of.html#comment-form"location.href=http://java-success.blogspot.com/2013/01/hibernate-automatic-dirty-checking-of.html#comment-form;><span style="text-transform:lowercase">6 Comments</span></a>
      
<a class="comment-link" href="http://java-success.blogspot.in/2013/01/hibernate-automatic-dirty-checking-of.html#links"><span style="text-transform:lowercase">Links to this post</span></a>

  <span class="item-action"><a href="https://www.blogger.com/email-post.g?blogID=35897879&postID=3030794854611862354" title="Email Post"><img class="icon-action" alt="" src="https://img2.blogblog.com/img/icon18_email.gif" height="13" width="18"/></a></span><span class="item-control blog-admin pid-341905326"><a style="border:none;" href="https://www.blogger.com/post-edit.g?blogID=35897879&postID=3030794854611862354&from=pencil" title="Edit Post"><img class="icon-action" alt="" src="https://img2.blogblog.com/img/icon18_edit_allbkg.gif" height="18" width="18"></a></span>
    </p>
  
  </div>
  <!-- End .post -->
  
  
  
  <!-- Begin #comments -->
 
  <!-- End #comments -->
  






<script type="text/javascript"><!--
google_ad_client = "pub-3764234023451771";
google_ad_host = "pub-1556223355139109";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al";
google_ad_channel = "";
//-->
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>


  <h2 class="date-header">Jan 29, 2013</h2>

  
  
     
  <!-- Begin .post -->
  <div class="post"><a name="6911219848549403518"></a>
    
         
    


    <h3 class="post-title">
	 
	 Java coding -- reverse enum lookup and sorting objects with a comparator
	 
    </h3>

    
     
    <div class="post-body">
    <p>
      <div style="clear:both;"></div>This blog post covers three core Java concepts:<br />
<br />
<b>1</b>) Writing <b>value objects</b> to store data.<br />
<b>2</b>) Writing <b>enum </b>classes with <b>reverse look-up</b>.<br />
<b>3</b>) Lastly, but most importantly&nbsp; <b>custom sorting</b> your value objects with a comparator.<br />
<br />
<br />

<!-- INFOLINKS_OFF -->

<b>Step 1</b>: Writing your value object class.<br />
<br />
<pre class="brush: csharp">package com.myapp.model;

import java.io.Serializable;
import java.math.BigDecimal;
import java.util.Date;

public class CashForecastSummary implements Serializable
{
 private static final long serialVersionUID = 2663449836220393299L;
 
 private String portfolioCode;
 private Date valuationDate;
 private String accountCd; 
 private BigDecimal totalAmount = BigDecimal.ZERO;
 private String currencyCode;
 private String transactionTypeDesc;
 private ForecastDay foreCastDay;
 private Date foreCastDate;  
 private RecordType recordType;
 
 public String getPortfolioCode() {
  return portfolioCode;
 }
 public void setPortfolioCode(String portfolioCode) {
  this.portfolioCode = portfolioCode;
 }
 public Date getValuationDate() {
  return valuationDate;
 }
 public void setValuationDate(Date valuationDate) {
  this.valuationDate = valuationDate;
 }
 public String getAccountCd() {
  return accountCd;
 }
 public void setAccountCd(String accountCd) {
  this.accountCd = accountCd;
 }
 public BigDecimal getTotalAmount() {
  return totalAmount;
 }
 public void setTotalAmount(BigDecimal totalAmount) {
  this.totalAmount = totalAmount;
 }
 public String getCurrencyCode() {
  return currencyCode;
 }
 public void setCurrencyCode(String currencyCode) {
  this.currencyCode = currencyCode;
 }
 public String getTransactionTypeDesc() {
  return transactionTypeDesc;
 }
 public void setTransactionTypeDesc(String transactionTypeDesc) {
  this.transactionTypeDesc = transactionTypeDesc;
 }
 public ForecastDay getForeCastDay() {
  return foreCastDay;
 }
 public void setForeCastDay(ForecastDay foreCastDay) {
  this.foreCastDay = foreCastDay;
 } 
 public Date getForeCastDate() {
  return foreCastDate;
 }
 public void setForeCastDate(Date foreCastDate) {
  this.foreCastDate = foreCastDate;
 }
 public RecordType getRecordType() {
  return recordType;
 }
 public void setRecordType(RecordType recordType) {
  this.recordType = recordType;
 }
 
 @Override
 public String toString() 
 {
  return "CashForecastSummary [portfolioCode=" + portfolioCode
    + ", valuationDate=" + valuationDate + ", accountCd="
    + accountCd + ", totalAmount=" + totalAmount
    + ", currencyCode=" + currencyCode + ", transactionTypeDesc="
    + transactionTypeDesc + ", foreCastDay=" + foreCastDay
    + ", recordType=" + recordType + "]";
 }
 
 @Override
 public int hashCode() {
  final int prime = 31;
  int result = 1;
  result = prime * result
    + ((accountCd == null) ? 0 : accountCd.hashCode());
  result = prime * result
    + ((foreCastDay == null) ? 0 : foreCastDay.hashCode());
  result = prime
    * result
    + ((transactionTypeDesc == null) ? 0 : transactionTypeDesc
      .hashCode());
  return result;
 }
 
 @Override
 public boolean equals(Object obj) {
  if (this == obj)
   return true;
  if (obj == null)
   return false;
  if (getClass() != obj.getClass())
   return false;
  CashForecastSummary other = (CashForecastSummary) obj;
  if (accountCd == null) {
   if (other.accountCd != null)
    return false;
  } else if (!accountCd.equals(other.accountCd))
   return false;
  if (foreCastDay != other.foreCastDay)
   return false;
  if (transactionTypeDesc == null) {
   if (other.transactionTypeDesc != null)
    return false;
  } else if (!transactionTypeDesc.equals(other.transactionTypeDesc))
   return false;
  return true;
 }

}

</pre>
<br />
<br />
The<b> hashCode( )</b>, <b>equals( Object obj)</b>, and <b>toString( )</b> methods from the Java Object class are over written. It also implements the <i><b>Serializable </b></i>interface to make the object serializable (i.e. can be flattened to bytes). <br />
<br />
<b>Step 2a</b>: Writing a simple enum class.<br />
<br />
<pre class="brush: csharp">package com.myapp.model;

public enum RecordType 
{
 OPENING_BALANCE(1),
    DETAILS(2),
    CLOSING_BALANCE(3);

    private final int recordType;
    
    private RecordType(int recordType)
    {
     this.recordType = recordType;
    }
    
    public int getRecordType()
    {
        return recordType;
    }

}
</pre>
<br />
<br />
<br />
<b>Step 2b</b>: Writing an enum class with reverse look-up using a Map.<br />
<br />
<pre class="brush: csharp">package com.myapp.model;

import java.util.HashMap;
import java.util.Map;

public enum ForecastDay {
 T(0), T1(1), T2(2), T3(3), T4(4), T5(5), T6(6), T7(7), T8(8), T9(9), T10(10), T11(11), T12(12), T13(13), TN(14);

 // Reverse-lookup map for getting a day from an abbreviation
 private static final Map&lt;Integer, ForecastDay&gt; lookup = new HashMap&lt;Integer, ForecastDay&gt;();
 static {
  for (ForecastDay d : ForecastDay.values())
   lookup.put(d.getDaycount(), d);
 }

 private final int dayCount;

 private ForecastDay(int dayCount) {
  this.dayCount = dayCount;
 }

 public int getDaycount() {
  return dayCount;
 }

 public static ForecastDay getDayFromCount(int dayCount) {
  if (dayCount &gt; 13) {
   dayCount = 14;
  }
  return lookup.get(dayCount);
 }

}
</pre>
<br />
<br />
<b>Step 3</b>: Writing a comparator class to sort a collection of value objects.
<br />
<br />
<script type="text/javascript"><!--
google_ad_client = "ca-pub-3764234023451771";
/* Leader board */
google_ad_slot = "4890304945";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>

<script src="http://pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script>
<br/>
<br/>
<pre class="brush: csharp">package com.myapp.model.sort;

import java.util.Comparator;

import com.myapp.model.CashForecastSummary;

public class CashForecastSummaryComparator implements Comparator&lt;CashForecastSummary&gt; {

 @Override
 public int compare(CashForecastSummary o1, CashForecastSummary o2) {

  int result = 1;

  String accountCd1 = o1.getAccountCd();
  String accountCd2 = o2.getAccountCd();

  if (accountCd1 == null || accountCd2 == null) {
   throw new IllegalArgumentException("The account codes cannot be null " + " accountCd1=" + accountCd1 + ", accountCd2=" + accountCd2);
  }
  
  result = accountCd1.compareTo(accountCd2);
  if (result != 0) {
   return result;
  }
  
  Integer forecastDay1 = o1.getForeCastDay().getDaycount();
  Integer forecastDay2 = o2.getForeCastDay().getDaycount();

  if (forecastDay1 == null || forecastDay2 == null) {
   throw new IllegalArgumentException("The forecastDay cannot be null " + " forecastDay1=" + forecastDay1 + ", forecastDay2=" + forecastDay2);
  }

  result = forecastDay1.compareTo(forecastDay2);
  if (result != 0) {
   return result;
  }

  Integer recType1 = o1.getRecordType().getRecordType();
  Integer recType2 = o2.getRecordType().getRecordType();

  if (recType1 == null || recType2 == null) {
   throw new IllegalArgumentException("The recordType cannot be null " + " recType1=" + recType1 + ", recType2=" + recType2);
  }

  result = recType1.compareTo(recType2);
  if (result != 0) {
   return result;
  }
  
  result = o1.getTransactionTypeDesc().compareTo(o2.getTransactionTypeDesc());
  
  return result;
 }

}
</pre>
<br />
<br />
As you could see, you need to implement the <b>compare(Object obj1, Object obj2) </b>method. This method has been written with<b> fail fast</b> in mind. As you can see, the input fields are validated, and exception is thrown if validation fails.<br />
<br />
<br />
<b>Step 4</b>:&nbsp; Finally, how to use the comparator.<br />
<br />
<pre class="brush: csharp">    
 ....

    /**
 *  takes unsorted values as an argument and returns the sorted values
 */
 public List&lt;CashForecastSummary&gt; getSortedSummariesForBalanceUpdate(List&lt;CashForecastSummary&gt; values) {
  Collections.sort(values, new CashForecastSummaryComparator());
  return values;
 }
 
 
 ....
 
</pre>
<br />
<br /><div style="clear:both; padding-bottom:0.25em"></div><p class="blogger-labels">Labels: <a rel='tag' href="http://java-success.blogspot.com/search/label/Coding">Coding</a>, <a rel='tag' href="http://java-success.blogspot.com/search/label/Core%20Java">Core Java</a></p>
    </p>
    </div>
    
    <p class="post-footer">
      <em>posted by Arulkumaran Kumaraswamipillai at 
    <a class="post-footer-link" href="http://java-success.blogspot.in/2013/01/java-coding-reverse-enum-lookup-and.html" title="permanent link"> 1/29/2013 09:57:00 PM </a></em>

       |
      <a class="comment-link" href="http://java-success.blogspot.in/2013/01/java-coding-reverse-enum-lookup-and.html#comment-form"location.href=http://java-success.blogspot.com/2013/01/java-coding-reverse-enum-lookup-and.html#comment-form;><span style="text-transform:lowercase">0 Comments</span></a>
      
<a class="comment-link" href="http://java-success.blogspot.in/2013/01/java-coding-reverse-enum-lookup-and.html#links"><span style="text-transform:lowercase">Links to this post</span></a>

  <span class="item-action"><a href="https://www.blogger.com/email-post.g?blogID=35897879&postID=6911219848549403518" title="Email Post"><img class="icon-action" alt="" src="https://img2.blogblog.com/img/icon18_email.gif" height="13" width="18"/></a></span><span class="item-control blog-admin pid-341905326"><a style="border:none;" href="https://www.blogger.com/post-edit.g?blogID=35897879&postID=6911219848549403518&from=pencil" title="Edit Post"><img class="icon-action" alt="" src="https://img2.blogblog.com/img/icon18_edit_allbkg.gif" height="18" width="18"></a></span>
    </p>
  
  </div>
  <!-- End .post -->
  
  
  
  <!-- Begin #comments -->
 
  <!-- End #comments -->
  






<script type="text/javascript"><!--
google_ad_client = "pub-3764234023451771";
google_ad_host = "pub-1556223355139109";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al";
google_ad_channel = "";
//-->
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>


  <h2 class="date-header">Jan 21, 2013</h2>

  
  
     
  <!-- Begin .post -->
  <div class="post"><a name="6428644531318070552"></a>
    
         
    


    <h3 class="post-title">
	 
	 Top 20+ Java EE interview questions and answers that experienced Java developers must know
	 
    </h3>

    
     
    <div class="post-body">
    <p>
      <div style="clear:both;"></div>
<h2>
Java Interview Questions and Answers</h2>
<table bgcolor="#FFFFCC" border="2" cell-padding="10px" style="width: 100%;">
<tbody>
<tr>
<td><a href="http://java-success.blogspot.com/2013/01/top-20-java-technical-interview.html"> <span style="font-size: large;"><b>1-5 </b></span>for experienced developers </a> </td>

<td><a href="http://java-success.blogspot.com/2014/02/top-20-java-technical-interview.html"><span style="font-size: large;"><b> 6-10</b></span> for experienced developers </a></td>

<td><a href="http://java-success.blogspot.com/2013/05/top-20-java-technical-interview.html"> <span style="font-size: large;"><b>11-16</b></span> for experienced developers </a></td>

<td><a href="http://java-success.blogspot.com/2014/02/top-20-java-technical-interview_23.html"> <span style="font-size: large;"><b>17-20</b></span> for experienced developers </a></td>
</tr>
</tbody></table>
<br />
<span style="font-size: large;"><span style="color: #38761d;">If you are an interviewer</span></span> -- it really pays to ask well rounded questions to judge the real experience of the candidate as opposed to just relying on the number of years.<br />
<br />
<b><span style="font-size: large;"><span style="color: #38761d;">If you are an interviewee</span></span></b> -- You have no control over what questions will be asked in Java job interviews, but there are a
few Java interview questions that are very frequently asked in job interviews, and it really pays to prepare for those questions. Here are a few such questions. This is based on some of my recent interviews. Brushing up on these answers will boost your success rate in Java job interviews.
<br />
<br />
The focus is on <b>judging your experience</b> and technical strength. So, go through your resume and reflect back on your hands-on experience. Many of these answers will also serve you well in selling your technical strengths to open ended questions like -- <b>tell me about yourself? </b>, <b>why do you like software development?</b>, <b>when reviewing others' work, what do you look for?</b>, <b>what was your most significant accomplishment?</b>, etc
<br />
<br />
<b>Q1</b>. Can you describe the high level&nbsp;architecture of the application that you had worked on recently? or Can you give a 100 feet bird's eye view of the application you were involved in as a developer or designer?<br />
<br />
<b>A1</b>. The purpose is to judge your overall experience. Here are a few links that will prepare for this most sought-after question, especially for the experienced professionals. <br />
<ul>
<li><span style="font-size: small;"><span style="font-size: large;"><a href="http://java-success.blogspot.com/2011/09/enterprise-java-interview-questions-and.html">3 to n-tier enterprise Java architecture, the MVC-2 design pattern, the&nbsp;distinction&nbsp;between physical and logical tiers, and the layered architecture</a></span>.The <b>logical tiers </b>shown in the diagrams for the above link are basically layers, and the layers are used for organizing your code. Typical layers include <b>Presentation</b>, <b>Business </b>and <b>Data </b>– the same as the traditional 3-tier model. But when&nbsp; talk about layers, we’re only talking about <u><b>logical </b></u>organization of code. <b>Physical tiers </b>however, are only about where the code gets deployed and run as war, ear or jar. Specifically, tiers are places where layers are deployed and where layers run. In other words, tiers are the <b>physical deployment of layers</b>.</span></li>
<li><span style="font-size: large;"><a href="http://java-success.blogspot.com/2011/10/java-interview-questions-and-answers-on.html">high level architectural patterns and the pros and cons of each approach</a>.</span> Discusses a number different architectual styles like <b>MVC</b>, <b>SOA</b>, <b>UI Component</b>, <b>RESTful data composition</b>, <b>HTML data composition</b>, <b>Plug-in architecture</b>, and Event Driven Architecture (<b>EDA</b>). Also, covers a sample enterprise architecture, which is a hybrid of a number of architectural styles. 
</li>
<li><span style="font-size: small;"><a href="http://java-success.blogspot.com/2012/06/server-side-versus-client-side.html">Single page web design</a><b>. </b>A single rich web page loading different sections (e.g tabs) of the page by making different ajax calls to relevant RESTful web services to get the JSON data to render the relevant sections.<b><br /></b></span></li>
<li><span style="font-size: small;"><span style="font-size: large;"><a href="http://java-success.blogspot.com/2012/02/java-web-services-interview-questions.html">Understanding of various types of application integration styles</a></span>. Enterprise applications need to be integrated with other systems, and this post covers different integration styles like sharing the same database, feed based, RPC style (e.g. web services), and exchanging JMS messages.</span></li>
</ul>
<br />
<br />
<b>Q2</b>. How would you go about deciding between <b>SOAP based web service</b> and <b>RESTful </b>web service?<br />
<b>A2</b>. Web services are very popular and widely used to integrate disparate systems. It is imperative to understand the differences, pros, and cons between each approach. Recently, I have been asked these questions very frequently, here is the<span style="font-size: small;"> <span style="font-size: large;"><a href="http://java-success.blogspot.com/2012/11/soap-versus-restful-web-service.html" target="">answer that discusses the pros and cons of SOAP vs. RESTful web services in detail</a></span>. &nbsp; </span><br />
<br />
<b>Q3</b>.How will you go about ensuring that you build a more robust application? or How do you improve quality of your application?<br />
<b>A3</b>. This question is very popular with the interviewers because they want to hire candidates who write good quality application. Here are some useful links to prepare for this question.<br />
<ul>
<li><span style="font-size: large;"><a href="http://java-success.blogspot.com/2011/10/judging-java-experience-questions-and.html">Java interview questions and answers on code quality.</a></span> Gives a high level over view as to things you can do and tools you can use to improve code quality. A common popular job interview question answered is -- <b>What is the difference between fake objects, mock objects, and stubs?</b></li>
<li><a href="http://java-success.blogspot.com/2011/10/unit-testing-with-mock-objects.html">Unit testing with mock objects interview questions and answers</a>. Tutorial that explains how to write <b>JUnit </b>tests with mock objects using the <b>Mockito </b>and <b>Power mock</b> frameworks. </li>
<li><span style="font-size: large;"><a href="http://java-success.blogspot.com/2012/03/java-interview-questions-and-answers.html">Java Interview Questions and Answers - performance testing your Java application</a></span>. A high level overview as to how you can go about monitoring performance. Many applications face performance issues and this is a very popular question with the interviewers.&nbsp; </li>
</ul>
<b>Q4</b>. What are some of the best practices regarding SDLC? Have you worked in an agile development environment? Did you use test driven development and continuous integration?<br />
<b>A4</b>.&nbsp; <br />
<ul>
<li><a href="http://java-success.blogspot.com/2012/09/interview-questions-and-answers-on-sdlc.html">Know the SDLC and the best practices</a>. Gives a high level overview of <b>SDLC</b>.</li>
</ul>
<br />
<br />
<b>Q5</b>: Can you write code? How would you go about implementing .....?<br />
<b>A5</b>:&nbsp; You will be asked to write a small function or a program. The interviewer will be looking for things like<br />
<ul>
<li>How well you analyze the requirements and the solution? Ask relevant questions if the requirements are not clear. Think out loud so that the interviewer knows that how you are approaching the problem.The approach is more important that arriving at the correct solution.</li>
<li>List all possible alternatives.</li>
<li>Write pseudo code.</li>
<li>Write unit tests.</li>
<li>Where required, brainstorm with the interviewer.</li>
<li>Find ways to improve your initial solution. Talk through thread safety and best practices where applicable. </li>
</ul>
Here are some links to popular coding questions and answers. <br />
<ul>
<li><a href="http://java-success.blogspot.com/2011/09/java-coding-interview-questions-and.html">Java coding interview questions and answers:</a>. Covers a number of coding questions with answers. These are some of the popular coding interview questions like reversing a string, calculating the Fibonacci number, recursion vs iteration, equals versus ==, etc.</li>
</ul>
<b><span style="font-size: large;">Coding Questions and Answers worth brushing up on</span></b>, especially before the screening written tests. <br />
<ul>
<li><a href="http://java-success.blogspot.com/2013/07/core-java-multi-thread-coding-printing_19.html">Printing 1 to 10 in order with 2 separate threads. One thread prints odd numbers and the other thread prints even numbers</a>.</li>
<li><a href="http://java-success.blogspot.com/2013/10/java-preorder-tree-traversal-recursive.html">How will you flatten a pre-order tree structure in Java using both recursion and iteration?</a></li>
<li><a href="http://java-success.blogspot.com/2013/10/java-tree-structure-interview-questions.html">Can you create a Tree class that can work with different types like <b><i>String</i></b>, <b><i>File</i></b>, <b><i>Person</i></b>, etc and supports the following methods</a></li>
</ul>
<b>Q</b>. Can you write Java code to compute a collection of numbers 
supplied to it? The computation could be addition, subtraction, etc. Use
 recursion to compute the numbers. Here are some requirements to take 
into considerations.<br />
<br />
1. It should be flexible enough to convert from Recursion to iteration if required.<br />
2. Computation will initially be "addition", but should be extendable to multiplication, subtraction, etc.<br />
3. Should handle integers and floating point numbers.<br />
4. Make use of <b>generics</b>.<br />
<br />
<b>A</b>. <a href="http://java-success.blogspot.com/2013/11/java-coding-question-on-recursion-and.html">Java coding with recursion and generics</a><br />
<br />
<b>Q</b>. The <i>SimpleDateFormatter</i> and <i>DecimalFormatter</i> are not thread-safe. How will you use them in a thread-safe manner?<br />
<b>A</b>. Using the <a href="http://java-success.blogspot.com/2014/01/when-and-how-to-use-java-threadlocal.html"><i>ThreadLocal</i> class as demonstrated in this tutorial</a>.<br />
<script async="" src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<br />
<br />
<b>Q</b>. If Java did not have its own Map or Set implementation, how will you go about implementing your own?<br />
<b>A</b>. Covered in detail with diagrams and code in "Core Java Career Essentials" book.<br />
<br />
<h2>
Java Interview Questions and Answers</h2>
<table bgcolor="#FFFFCC" border="2" cell-padding="10px" style="width: 100%;">
<tbody>
<tr>
<td><a href="http://java-success.blogspot.com/2013/01/top-20-java-technical-interview.html"> <span style="font-size: large;"><b>1-5 </b></span>for experienced developers </a> </td>

<td><a href="http://java-success.blogspot.com/2014/02/top-20-java-technical-interview.html"><span style="font-size: large;"><b> 6-10</b></span> for experienced developers </a></td>

<td><a href="http://java-success.blogspot.com/2013/05/top-20-java-technical-interview.html"> <span style="font-size: large;"><b>11-16</b></span> for experienced developers </a></td>

<td><a href="http://java-success.blogspot.com/2014/02/top-20-java-technical-interview_23.html"> <span style="font-size: large;"><b>17-20</b></span> for experienced developers </a></td>
</tr>
</tbody></table>

<br/>

<div style="clear:both; padding-bottom:0.25em"></div><p class="blogger-labels">Labels: <a rel='tag' href="http://java-success.blogspot.com/search/label/Java%20Interview">Java Interview</a>, <a rel='tag' href="http://java-success.blogspot.com/search/label/Java%20Interview%20Answers">Java Interview Answers</a>, <a rel='tag' href="http://java-success.blogspot.com/search/label/Java%20Interview%20Questions">Java Interview Questions</a></p>
    </p>
    </div>
    
    <p class="post-footer">
      <em>posted by Arulkumaran Kumaraswamipillai at 
    <a class="post-footer-link" href="http://java-success.blogspot.in/2013/01/top-20-java-technical-interview.html" title="permanent link"> 1/21/2013 12:32:00 AM </a></em>

       |
      <a class="comment-link" href="http://java-success.blogspot.in/2013/01/top-20-java-technical-interview.html#comment-form"location.href=http://java-success.blogspot.com/2013/01/top-20-java-technical-interview.html#comment-form;><span style="text-transform:lowercase">9 Comments</span></a>
      
  <span class="item-action"><a href="https://www.blogger.com/email-post.g?blogID=35897879&postID=6428644531318070552" title="Email Post"><img class="icon-action" alt="" src="https://img2.blogblog.com/img/icon18_email.gif" height="13" width="18"/></a></span><span class="item-control blog-admin pid-341905326"><a style="border:none;" href="https://www.blogger.com/post-edit.g?blogID=35897879&postID=6428644531318070552&from=pencil" title="Edit Post"><img class="icon-action" alt="" src="https://img2.blogblog.com/img/icon18_edit_allbkg.gif" height="18" width="18"></a></span>
    </p>
  
  </div>
  <!-- End .post -->
  
  
  
  <!-- Begin #comments -->
 
  <!-- End #comments -->
  






<script type="text/javascript"><!--
google_ad_client = "pub-3764234023451771";
google_ad_host = "pub-1556223355139109";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al";
google_ad_channel = "";
//-->
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>


  <h2 class="date-header">Jan 18, 2013</h2>

  
  
     
  <!-- Begin .post -->
  <div class="post"><a name="6725558705909559152"></a>
    
         
    


    <h3 class="post-title">
	 
	 Identifying Java concurrency issues -- thread starvation, dead lock, and contention
	 
    </h3>

    
     
    <div class="post-body">
    <p>
      <div style="clear:both;"></div><br />
<div align="JUSTIFY" style="background: transparent; line-height: 0.49cm; margin-bottom: 0cm;">
<span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: large;">

</span></span></div>
<div align="JUSTIFY" style="background: transparent; line-height: 0.49cm; margin-bottom: 0cm;">
<span style="font-family: inherit;">Concurrency is very
important in any modern system, and this is one topic many software
engineers struggle to have a good grasp. The complexity in
concurrency programming stems from the fact that the threads often
need to operate on the common data. Each thread has its own sequence
of execution, but accesses common data.</span></div>
<br />
<div align="JUSTIFY" style="background: none repeat scroll 0% 0% transparent; line-height: 0.49cm; margin-bottom: 0cm;">
<span style="font-family: inherit;"><br /></span></div>
<div align="JUSTIFY" style="background: none repeat scroll 0% 0% transparent; line-height: 0.49cm; margin-bottom: 0cm;">
<span style="font-family: inherit;">Debugging concurrency
issues and fixing any thread starvation, dead lock, and contention
require skills and experience to identify and reproduce these hard to
resolve issues. Here are some techniques to detect concurrency
issues.</span></div>
<br />
<ul>
<li><div align="JUSTIFY" style="background: transparent; line-height: 0.49cm; margin-bottom: 0cm;">
<span style="font-family: inherit;">Manually reviewing the
 code for any obvious thread-safety issues. There are static analysis
 tools like <b>Sonar</b>, <b><i>ThreadCheck</i></b>, etc for catching concurrency
 bugs at compile-time by analyzing their byte code.</span></div>
</li>
<li><div align="JUSTIFY" style="background: none repeat scroll 0% 0% transparent; line-height: 0.49cm; margin-bottom: 0cm; page-break-before: auto;">
<span style="font-family: inherit;">List all possible causes
 and <b>add extensive log statements </b>and write test cases to prove or
 disprove your theories.</span></div>
</li>
<li><div align="JUSTIFY" style="background: none repeat scroll 0% 0% transparent; line-height: 0.49cm; margin-bottom: 0cm; page-break-before: auto;">
<span style="font-family: inherit;"><b>Thread dumps </b>are very
 useful for diagnosing synchronization problems such as deadlocks.
 The trick is to take 5 or 6 sets of thread dumps at an interval of 5
 seconds between each to have a log file that has 25 to 30 seconds
 worth of runtime action. For thread dumps, use kill -3 <pid>
 in Unix and CTRL+BREAK in Windows. There are tools like <b><i>Thread</i>
 </b><i><b>Dump Analyzer</b> (TDA), Samurai, etc. </i>to derive useful
 information from the thread dumps to find where the problem is. For
 example, Samurai colors idle threads in grey, blocked threads in
 red, and running threads in green. You must pay more attention to
 those red threads.</pid></span></div>
</li>
<li><div align="JUSTIFY" style="background: none repeat scroll 0% 0% transparent; line-height: 0.49cm; margin-bottom: 0cm; page-break-before: auto;">
<span style="font-family: inherit;">There are tools like <b>JDB</b>
 (i.e. Java DeBugger) <b>where a “watch” can be set up on the
 suspected variable</b>. When ever the application is modifying that
 variable, a thread dump will be printed.</span></div>
</li>
<li><div align="JUSTIFY" style="background: none repeat scroll 0% 0% transparent; line-height: 0.49cm; margin-bottom: 0cm; page-break-before: auto;">
<span style="font-family: inherit;">There are dynamic analysis
 tools like <b>jstack</b> and <b>JConsole</b>, which is a JMX compliant GUI tool to
 get a thread dump on the fly. The JConsole GUI tool does have handy
 features like “detect deadlock” button to perform deadlock
 detection operations and ability to inspect the threads and objects
 in error states. Similar tools are available for other languages as
 well.</span></div>
</li>
</ul>
<br />
<div style="margin-bottom: 0cm;">
<span style="font-size: x-large;"><span style="font-family: Arial,Helvetica,sans-serif;"><span style="color: #38761d;">Here
are some best practices to keep in mind relating to writing
concurrent programs. </span></span></span>
</div>
<div align="JUSTIFY" style="background: transparent; line-height: 0.49cm; margin-bottom: 0cm; page-break-before: auto;">
<br /></div>
<ul>
<li><div align="JUSTIFY" style="background: transparent; line-height: 0.49cm; margin-bottom: 0cm; page-break-before: auto;">
<span style="font-family: inherit;">Favor <b>immutable objects </b>as
 they are inherently thread-safe.</span></div>
</li>
<li><div align="JUSTIFY" style="background: transparent; line-height: 0.49cm; margin-bottom: 0cm; page-break-before: auto;">
<span style="font-family: inherit;">If you need to use mutable
 objects, and share them among threads, then a key element of
 thread-safety is <b>locking access to shared data</b> while it is being
 operated on by a thread. For example, in Java you can use the
 synchronized  keyword.</span></div>
</li>
<li><div align="JUSTIFY" style="background: transparent; line-height: 0.49cm; margin-bottom: 0cm; page-break-before: auto;">
<span style="font-family: inherit;">Generally try to <b>keep your
 locking for as shorter duration as possible to minimize any thread
 contention issues</b> if you have many threads running.
 Putting
 a big, fat lock right at the start of the function and unlocking it
 at the end of the function is useful on functions that are rarely
 called, but can adversely impact performance on frequently called
 functions. Putting one or many larger locks in the function around
 the data that actually need protection is a finer grained approach
 <span style="font-style: normal;">that</span><span style="color: black;"><i>
 </i></span><span style="color: black;"><span style="font-style: normal;">works
 better than the coarse grained approach, especially when there are
 only a few places in the function that actually need protection and
 there are larger areas that are thread-safe and can be carried out
 concurrently.</span></span></span></div>
</li>
<li><div align="JUSTIFY" style="background: transparent; line-height: 0.49cm; margin-bottom: 0cm; page-break-before: auto;">
<span style="font-family: inherit;">
 <b>Use proven concurrency
 libraries </b>(e.g. <i>java.util.concurrency</i>) as opposed to writing
 your own. Well written concurrency libraries provide concurrent
 access to reads, while restricting concurrent writes. </span>
 </div>
</li>
</ul>
<br />
<br/>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Center - Leader board -->
<ins class="adsbygoogle"
     style="display:inline-block;width:728px;height:90px"
     data-ad-client="ca-pub-3764234023451771"
     data-ad-slot="5678244596"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<br/>
<br />
<span style="font-size: x-large;"><span style="font-family: Arial,Helvetica,sans-serif;"><span style="color: #38761d;">Fixing production issues </span></span></span><br />
<span style="font-size: x-large;"><span style="font-family: Arial,Helvetica,sans-serif;"><span style="color: #38761d;"><br /></span></span></span>
<span style="font-family: inherit;">There could be general
 run time production issues that either slow down or make a system to
 hang. In these situations, the general approach for troubleshooting
 would be to analyze the thread dumps to isolate the threads which
 are causing the slow-down or hang. For example, a Java thread dump
 gives you a snapshot of all threads running inside a Java Virtual
 Machine. There are graphical tools like  <i>Samurai</i>  to help you
 analyze the thread dumps more effectively.
</span><br />
<span style="font-family: inherit;"><br /></span>
<br />
<ul>
<li>
<span style="font-family: inherit;"><b>Application seems to
consume 100% CPU and throughput has drastically reduced – </b><span style="font-weight: normal;">Get
a series of thread dumps, say 7 to 10  at a particular interval, say
5 -8 seconds and analyze these thread dumps by inspecting closely 
the “runnable” threads to ensure that if a particular thread is
progressing well. If a particular thread is executing the same method
through all the thread dumps, then that particular method could be
the root cause. You can now continue your investigation by inspecting
the code.</span></span></li>
</ul>
<br />
<ul>
<li>
<span style="font-family: inherit;"><b>Application consumes
very less CPU and response times are very poor due to heavy I/O
operations like file or database read/write operations</b><span style="font-weight: normal;">
– Get a series of thread dumps and inspect for threads that are in
“</span><b>blocked</b><span style="font-weight: normal;">” status.
This analysis can also be used for situations where the application
server hangs due to running out of all runnable threads due to a
deadlock or a thread is holding a lock on an object and never returns
it while other threads are waiting for the same lock.</span></span></li>
</ul>
<span style="font-family: inherit;">The solution to the above
problems could vastly vary from fixing the thread safety issue(s) to
reducing the size of synchronization granularity, and from
implementing appropriate caching strategies to setting the
appropriate connection timeouts, and  other reasons discussed in the
last section.

</span><br />
<br />
<br />
<br />
You may also like:<br />
<br />
<ul>
<li><span style="font-size: large;"><a href="http://java-success.blogspot.com/2012/08/article-scenarios-and-solutions-for.html">Scenarios and solutions for better concurrency and thread safety in Java</a></span></li>
<li><a href="http://java-success.blogspot.com/2014/06/understanding-java-locks-multi.html"><span style="font-size: large;">What do you need to know about Java locks and synchronized keyword&nbsp;</span></a></li>
<li><span style="font-size: large;"><a href="http://java-success.blogspot.com/2014/06/how-java-threads-communicate-with-each.html">How do Java threads communicate with each other?</a></span></li>
<li><a href="http://java-success.blogspot.com/2011/09/java-multi-threading-interview.html"><span style="font-size: large;">Java multi-threading interview questions and answers</span></a></li>
</ul><div style="clear:both; padding-bottom:0.25em"></div><p class="blogger-labels">Labels: <a rel='tag' href="http://java-success.blogspot.com/search/label/Java%20Key%20Areas">Java Key Areas</a></p>
    </p>
    </div>
    
    <p class="post-footer">
      <em>posted by Arulkumaran Kumaraswamipillai at 
    <a class="post-footer-link" href="http://java-success.blogspot.in/2013/01/identifying-java-concurrency-issues.html" title="permanent link"> 1/18/2013 01:35:00 AM </a></em>

       |
      <a class="comment-link" href="http://java-success.blogspot.in/2013/01/identifying-java-concurrency-issues.html#comment-form"location.href=http://java-success.blogspot.com/2013/01/identifying-java-concurrency-issues.html#comment-form;><span style="text-transform:lowercase">0 Comments</span></a>
      
  <span class="item-action"><a href="https://www.blogger.com/email-post.g?blogID=35897879&postID=6725558705909559152" title="Email Post"><img class="icon-action" alt="" src="https://img2.blogblog.com/img/icon18_email.gif" height="13" width="18"/></a></span><span class="item-control blog-admin pid-341905326"><a style="border:none;" href="https://www.blogger.com/post-edit.g?blogID=35897879&postID=6725558705909559152&from=pencil" title="Edit Post"><img class="icon-action" alt="" src="https://img2.blogblog.com/img/icon18_edit_allbkg.gif" height="18" width="18"></a></span>
    </p>
  
  </div>
  <!-- End .post -->
  
  
  
  <!-- Begin #comments -->
 
  <!-- End #comments -->
  






<script type="text/javascript"><!--
google_ad_client = "pub-3764234023451771";
google_ad_host = "pub-1556223355139109";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al";
google_ad_channel = "";
//-->
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>


  <h2 class="date-header">Jan 8, 2013</h2>

  
  
     
  <!-- Begin .post -->
  <div class="post"><a name="2966533127508627603"></a>
    
         
    


    <h3 class="post-title">
	 
	 XML processing in Java and reading XML data with a Stax Reader
	 
    </h3>

    
     
    <div class="post-body">
    <p>
      <div style="clear:both;"></div><script type="text/javascript">
<!--
google_ad_client = "ca-pub-3764234023451771";
/* Leader board image and text */
google_ad_slot = "4890304945";
google_ad_width = 728;
google_ad_height = 90;
google_ad_channel ="4262872872";
google_page_url = "http://java-success.blogspot.com.au/p/core-java-q.html";
//--&gt
</script>
<script src="http://pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script>

<br />
<br />
<b>Q. </b>What APIs do Java provide to process XML? What are the pros and cons of each, and when to use what?<b></b><br />
<b>A</b><b>.&nbsp;</b><br />
<b><br /></b>
<b>SAX: Pros</b>: Memory efficient and faster than the DOM parser. Good for very large files. Supports schema validation.<br />
<b>SAX: Cons: </b>You can use it for reading only. It does not have xpath support. You have to write more code to get things done as there is no object model mapping and you have to tap into the events and create your self.<br />
<br />
<b>DOM: Pros: </b>Simple to use, bi-directional(read &amp; write) and supports schema validation. The read XML is kept in memory allowing XML manipulation and preserves element order. Supports CRUD operation.<br />
<b>DOM: Cons: </b>Not suited for large XML files as it consumes more memory. You will have to map to your object model as it supports generic model incorporating nodes.<br />
<br />
<b>Stax: Pros:&nbsp;</b> Gives you the best of SAX (i.e. memory efficient) and DOM (i.e. ease of use). Supports both reading and writing. Very efficient processing as it can read multiple documents same time in one single thread, and also can process XML in parallel on multiple threads. If you need speed, using a Stax parser is the best way.<br />
<b>Stax: Cons:&nbsp; </b>You have to write more code to get things done and you have to get used to process xml in streams.<br />
<b>&nbsp; <br />JAXB: Pros: </b>Allows you to access and process XML data without having to know XML by binding Java objects to XML through annotations. Supports both reading &amp; writing and more memory efficient than a DOM (as DOM is a generic model)<br />
<b>JAXB: Cons: </b>It can only parse valid XML documents.<br />
<br />
SAX, DOM, Stax, and JAXB are just specifications. There are many open source and commercial implementations of these specifications. For example, the JAXB API has implementations like <b>Metro </b>(The reference implementation, included in Java SE 6), <b>EclipseLink MOXy</b>, and <b>JaxMe</b>.<br />
<br />
There are other XML to object mapping frameworks like <b>xtream </b>from thoughtworks and <b>JiBX </b>(very efficient and uses byte code injection).
<br />
<br />
The StAX has the following implementation libraries&nbsp; --&nbsp;<b> </b>The reference implementation (i.e.<b> </b>http://stax.codehaus.org), the <b>Woodstox</b> implementation (i.e. http://woodstox.codehaus.org), and Sun's <b>SJSXP </b>implementation (https://sjsxp.dev.java.net/).<br />
<br />
If you want to transform XML from one format to another, then use a <b>TrAX</b>. TrAX is based on XSLT, which is a rule-based language. A TrAX source document may be created via SAX or DOM. TrAX needs both <b>Java </b>and <b>XSLT </b>knowledge.<b><br /></b><br />
<b><br /></b>
<br />
<b>Q.</b> What is the main difference between a StAX and SAX API ?<br />
<b>A. </b><span class="st">The main differences between the <i>StAX</i> and SAX API's are</span><br />
<span class="st"><i></i></span><br />
<ul>
<li><span class="st"><i>StAX</i> is a "pull" API. SAX is a "push" API.&nbsp;</span></li>
<li><span class="st"><i>StAX</i> can do both XML <i>reading</i> and writing. SAX can only do reading.</span></li>
</ul>
<br />
<b>SAX is a push style </b>API, which means SAX parser iterates through the XML and calls methods on the handler object provided by you. For instance, when the SAX parser encounters the beginning of an XML element, it calls the startElement on your handler object. It "pushes" the information from the XML into your object. Hence the name "push" style API. This is also referred to as an "event driven" API.<br />
<br />
<b>StAX is a pull style API</b>, which means that you have to move the StAX parser from item to item in the XML file yourself, just like you do with a standard Iterator or JDBC ResultSet. You can then access the XML information via the StAX parser for each such "item" encountered in the XML file . <br />
<br />
<b>Q. Why do you need StAX when you alread have SAX and DOM?</b><br />
<br />
<b>A.</b> The primary goal of the StAX API is to give "parsing control to the programmer by exposing a simple iterator based API. This allows the programmer to ask for the next event (pull the event) and allows state to be stored in procedural fashion." StAX was created to address limitations in the two most prevalent parsing APIs, SAX and DOM. <br />
<br />
<b>Q.</b> What is the issue with the DOM parser?<br />
<b>A</b>. The DOM model involves creating in-memory objects representing an entire document tree and the complete data set&nbsp; state for an XML document. Once in memory, DOM trees can be navigated freely and parsed arbitrarily, and as such provide maximum flexibility for developers. However the cost of this flexibility is a potentially large memory footprint and significant processor requirements, as the entire representation of the document must be held in memory as objects for the duration of the document processing. So, this approach will not be suited for larger XML documents.<br />
<br />
<br />
<b>Q. </b>What is the issue with a "push" parser?<br />
<b>A</b>. Pull parsing provides several advantages over push parsing when working with XML streams:<br />
<ul>
<li>With pull parsing, the invoking application controls the application thread, and can call methods on the parser when needed. By contrast, with push processing, the parser controls the application thread, and the client can only accept invocations from the parser.</li>
<li>Pull parsing libraries can be much smaller and the client code to interact with those libraries much simpler than with push libraries, even for more complex documents.</li>
<li>Pull clients can read multiple documents at one time with a single thread.</li>
<li>A StAX pull parser can filter XML documents such that elements unnecessary to the client can be ignored, and it can support XML views of non-XML data.</li>
</ul>
<br />
<br />
<span class="st">Now that you know why a StAX parser is more useful. here is an example of using the StAX API to read an XML snippet. The XML snippet is as shown below:&nbsp;</span><br />
<br />
<pre class="brush: csharp"> 
&lt;metadata BatchJobId='17232674' ParentBatchJobId='17232675' BatchCode='SOME_JOB_NAME' /&gt;

</pre>
<br />
Now the StAX parser code

<br />
<br />
<pre class="brush: csharp">package com.myapp.item.reader;

import java.io.ByteArrayInputStream;
import java.io.InputStream;
import java.util.Iterator;

import javax.xml.stream.XMLEventReader;
import javax.xml.stream.XMLInputFactory;
import javax.xml.stream.XMLStreamException;
import javax.xml.stream.events.Attribute;
import javax.xml.stream.events.StartElement;
import javax.xml.stream.events.XMLEvent;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import com.myapp.model.BatchJobMeta;

public class CashForecastJobMetaStaxReader {

 private final static Logger logger = LoggerFactory.getLogger(CashForecastJobMetaStaxReader.class);

 private static final String BATCH_JOB_ID = "BatchJobId";
 private static final String PARENT_BATCH_JOB_ID = "ParentBatchJobId";
 private static final String BATCH_CODE = "BatchCode";
 

 public BatchJobMeta readBatchJobMetaInfo(String input) {

  //First create a new XMLInputFactory
  XMLInputFactory inputFactory = XMLInputFactory.newInstance();
  InputStream in = new ByteArrayInputStream(input.getBytes());
  BatchJobMeta item = null;
  try {
   XMLEventReader eventReader = inputFactory.createXMLEventReader(in);
   item = new BatchJobMeta();

   while (eventReader.hasNext()) {
    XMLEvent event = eventReader.nextEvent();

    if (event.isStartElement()) {
     StartElement startElement = event.asStartElement();
     @SuppressWarnings("unchecked")
     Iterator&lt;Attribute&gt; attributes = startElement.getAttributes();
     while (attributes.hasNext()) {
      @SuppressWarnings("unused")
      Attribute attribute = attributes.next();
      if (attribute.getName().toString().equals(BATCH_JOB_ID)) {
       item.setBatchJobId(Long.valueOf(attribute.getValue()));
      }

      if (attribute.getName().toString().equals(PARENT_BATCH_JOB_ID)) {
       item.setParentBatchJobId(Long.valueOf(attribute.getValue()));
      }

      if (attribute.getName().toString().equals(BATCH_CODE)) {
       item.setBatchCode(attribute.getValue());
      }
     }
    }
   }

  } catch (XMLStreamException e) {
   logger.error("", e);
  }

  return item;

 }

}

</pre>
<br />
<br />
Finally, the JUnit test class that tests the above XML reader code.


<br />
<br />
<pre class="brush: csharp"> 

package com.myapp.item.reader;

import org.junit.Assert;
import org.junit.Test;

import com.myapp.model.BatchJobMeta;

public class CashForecastJobMetaStaxReaderTest {
 private static final String META_SNIPPET = "&lt;metadata batchcode="CSHFR" batchjobid="17232674" parentbatchjobid="17232675"&gt;";

 @Test
 public void testReadBatchJobMetaInfo() {
  CashForecastJobMetaStaxReader staxReader = new CashForecastJobMetaStaxReader();
  BatchJobMeta readBatchJobMetaInfo = staxReader.readBatchJobMetaInfo(META_SNIPPET);

  Assert.assertNotNull(readBatchJobMetaInfo);

  Assert.assertEquals("Failed on Job Id", 17232674L, readBatchJobMetaInfo.getBatchJobId());
  Assert.assertEquals("Failed on Parent Job Id", 17232675L, readBatchJobMetaInfo.getParentBatchJobId());
  Assert.assertEquals("Failed on batch code", "CSHFR", readBatchJobMetaInfo.getBatchCode());
 }

}

</pre>
<br />
<b>You may also like</b>:<br />
<br />
<ul>
<li><a href="http://java-success.blogspot.com.au/2013/10/jaxb-interview-questions-and-answers.html">JAXB Interview Questions and Answers - Unmarshalling</a></li>
<li><a href="http://java-success.blogspot.com.au/2013/11/jaxb-interview-questions-and-answers.html">JAXB Interview Questions and Answers: Marshalling</a></li>
<li><a href="http://java-success.blogspot.com.au/2014/01/jaxb-interview-questions-and-answers.html">JAXB Interview Questions and Answers -- power of MOXy</a></li>
</ul>
<div style="clear:both; padding-bottom:0.25em"></div><p class="blogger-labels">Labels: <a rel='tag' href="http://java-success.blogspot.com/search/label/XML">XML</a></p>
    </p>
    </div>
    
    <p class="post-footer">
      <em>posted by Arulkumaran Kumaraswamipillai at 
    <a class="post-footer-link" href="http://java-success.blogspot.in/2013/01/xml-processing-in-java-and-reading-xml.html" title="permanent link"> 1/08/2013 12:00:00 PM </a></em>

       |
      <a class="comment-link" href="http://java-success.blogspot.in/2013/01/xml-processing-in-java-and-reading-xml.html#comment-form"location.href=http://java-success.blogspot.com/2013/01/xml-processing-in-java-and-reading-xml.html#comment-form;><span style="text-transform:lowercase">0 Comments</span></a>
      
  <span class="item-action"><a href="https://www.blogger.com/email-post.g?blogID=35897879&postID=2966533127508627603" title="Email Post"><img class="icon-action" alt="" src="https://img2.blogblog.com/img/icon18_email.gif" height="13" width="18"/></a></span><span class="item-control blog-admin pid-341905326"><a style="border:none;" href="https://www.blogger.com/post-edit.g?blogID=35897879&postID=2966533127508627603&from=pencil" title="Edit Post"><img class="icon-action" alt="" src="https://img2.blogblog.com/img/icon18_edit_allbkg.gif" height="18" width="18"></a></span>
    </p>
  
  </div>
  <!-- End .post -->
  
  
  
  <!-- Begin #comments -->
 
  <!-- End #comments -->
  






<script type="text/javascript"><!--
google_ad_client = "pub-3764234023451771";
google_ad_host = "pub-1556223355139109";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al";
google_ad_channel = "";
//-->
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>


  <h2 class="date-header">Jan 7, 2013</h2>

  
  
     
  <!-- Begin .post -->
  <div class="post"><a name="6115757426474297216"></a>
    
         
    


    <h3 class="post-title">
	 
	 Working with Java Calendar and Dates - coding Q&A
	 
    </h3>

    
     
    <div class="post-body">
    <p>
      <div style="clear:both;"></div><script type="text/javascript">
<!--
google_ad_client = "ca-pub-3764234023451771";
/* Leader board image and text */
google_ad_slot = "4890304945";
google_ad_width = 728;
google_ad_height = 90;
google_ad_channel ="4262872872";
google_page_url = "http://java-success.blogspot.com.au/p/core-java-q.html";
//
--></script>

<script src="http://pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script>

<br/>
<br/>


<b>Q</b>. Can you write  a Java program to return the next week day for a given date?<br />
<b>A.</b><br />
<br />
<pre class="brush: csharp">package com.myapp.accounting.util;

import java.util.Calendar;
import java.util.Date;

public class CashforecastingUtil {
 
 public static Date getNextWeekday(Date inputDate) {
  Calendar cal = Calendar.getInstance();
  cal.setTime(inputDate);
  int dayOfWeek = cal.get(Calendar.DAY_OF_WEEK);
  switch (dayOfWeek) {
  case Calendar.FRIDAY:
   cal.add(Calendar.DAY_OF_WEEK, 3);
   break;
  case Calendar.SATURDAY:
   cal.add(Calendar.DAY_OF_WEEK, 2);
   break;
  default:
   cal.add(Calendar.DAY_OF_WEEK, 1);
   break;
  }
  
  return cal.getTime();
 }

}
</pre>
<br />
<br />
The unit test class will be something like <br />
<br />
<br />
<pre class="brush: csharp">import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;

import junit.framework.Assert;

import org.junit.Test;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;


public class CAshforecastingUtilTest {
 
 private final static Logger logger = LoggerFactory.getLogger(CAshforecastingUtilTest.class);
 
 
 @Test
 public void testGetNextWeekday() {
  SimpleDateFormat sdf = new SimpleDateFormat("dd/MM/yyyy hh:mm:ss");
  Calendar cal = Calendar.getInstance();
  cal.set(2012,Calendar.DECEMBER,5);
  
  Date nextCalcWkday = CashforecastingUtil.getNextWeekday(cal.getTime());
  logger.info(sdf.format(nextCalcWkday));
  cal.set(2012,Calendar.DECEMBER,6);
  logger.info(sdf.format(cal.getTime()));
  Assert.assertTrue("Dates don't match-1", cal.getTime().equals(nextCalcWkday));
  
  nextCalcWkday = CashforecastingUtil.getNextWeekday(cal.getTime());
  cal.set(2012,Calendar.DECEMBER,7);
  Assert.assertTrue("Dates don't match-2", cal.getTime().equals(nextCalcWkday));
  
  nextCalcWkday = CashforecastingUtil.getNextWeekday(cal.getTime());
  cal.set(2012,Calendar.DECEMBER,10);
  Assert.assertTrue("Dates don't match-3", cal.getTime().equals(nextCalcWkday));
  
  cal.set(2012,Calendar.DECEMBER,8);
  nextCalcWkday = CashforecastingUtil.getNextWeekday(cal.getTime());
  cal.set(2012,Calendar.DECEMBER,10);
  Assert.assertTrue("Dates don't match-4", cal.getTime().equals(nextCalcWkday));
  
  cal.set(2012,Calendar.DECEMBER,9);
  nextCalcWkday = CashforecastingUtil.getNextWeekday(cal.getTime());
  cal.set(2012,Calendar.DECEMBER,10);
  Assert.assertTrue("Dates don't match-5", cal.getTime().equals(nextCalcWkday));
  
  nextCalcWkday = CashforecastingUtil.getNextWeekday(cal.getTime());
  cal.set(2012,Calendar.DECEMBER,11);
  Assert.assertTrue("Dates don't match-6", cal.getTime().equals(nextCalcWkday));
  
  nextCalcWkday = CashforecastingUtil.getNextWeekday(cal.getTime());
  cal.set(2012,Calendar.DECEMBER,12);
  Assert.assertTrue("Dates don't match-7", cal.getTime().equals(nextCalcWkday));
  
  nextCalcWkday = CashforecastingUtil.getNextWeekday(cal.getTime());
  cal.set(2012,Calendar.DECEMBER,13);
  Assert.assertTrue("Dates don't match-8", cal.getTime().equals(nextCalcWkday));
 }

}

</pre>

<b>Note </b>that the  Calendar.DECEMBER is used instead of 12 for the month as the months are zero based. So, it is 11 for Decemebr. If you have to perform lots of date manipulation, then use the Joda library, which is more intuitive and easier to work with.&nbsp;
<br/>
<br/>
<b>Q.</b> Why are there two Date classes in Java --  one in java.util package and another in java.sql package?
<br/>
<br/>
<b>A </b>java.util.Date represents date and time of a day, whereas java.sql.Date only represents a date without the time. java.sql.Time, only represents a time of day, and java.sql.Timestamp represents both date and time 
<br/>
<br/>

<b>Q.</b> Can you write a function to compare two given dates and return the difference between the two dates in number of days?
<br/>
<b>A.</b> This where the new <b>Joda date library</b> introduced in java 7 shines.

<br/>
<br/>

<b>Step 1:</b> Write the function that takes two dates and return the difference in days. The assumption is to ignore the time and reset both times to midnight.

<br/>
<br/>
<pre class="brush: csharp">
package com.myapp.util;

import java.util.Calendar;
import java.util.Date;

import org.joda.time.DateTime;
import org.joda.time.Days;


public class MyAppUtil {
 
  
 /**
  * returns the number of days between two given dates
  * @param currentDate
  * @param curOrFutureDate
  * @return
  */
 public static int diffDays(Date currentDate, Date curOrFutureDate) {
  if(currentDate == null || curOrFutureDate == null){
   throw new IllegalArgumentException("Dates to be compared cannot be null! date1=" + currentDate + ", date2=" + curOrFutureDate );
  }
  
  if(curOrFutureDate.before(currentDate)) {
   throw new IllegalArgumentException("The curOrFutureDate cannot be bfore currentDate. date1=" + currentDate + ", date2=" + curOrFutureDate );
  }
  
  currentDate = resetTimeToMidnight(currentDate);
  curOrFutureDate = resetTimeToMidnight(curOrFutureDate);
  
  return Days.daysBetween(new DateTime(currentDate), new DateTime(curOrFutureDate)).getDays();
 }
 
 
 private static Date resetTimeToMidnight(Date inputDate){
  Calendar cal = Calendar.getInstance();
  cal.setTime(inputDate);
  cal.set(Calendar.HOUR_OF_DAY, 00);
  cal.set(Calendar.MINUTE, 00);
  cal.set(Calendar.SECOND, 00);
  cal.set(Calendar.MILLISECOND, 00);
  return cal.getTime();
 }

}

</pre>

<br/>
<br/>

<b>Step 2:</b>


<br/>
<br/>
<pre class="brush: csharp">
package com.myapp.util;

import java.util.Calendar;
import java.util.Date;

import junit.framework.Assert;

import org.junit.Test;

public class MyAppUtilTest {
 
 
 @Test
 public void testDiffDays() {
  Date now = new Date();
  
  Calendar cal = Calendar.getInstance();
  cal.setTime(now);
  
  cal.add(Calendar.DAY_OF_MONTH, -1);
  cal.set(Calendar.HOUR_OF_DAY, 00);
  Date yesterday = cal.getTime();
  
  cal.add(Calendar.DAY_OF_MONTH, -2);
  cal.set(Calendar.HOUR_OF_DAY, 5);
  Date _3daysAgo = cal.getTime();
  
  cal.add(Calendar.DAY_OF_MONTH, -4);
  cal.set(Calendar.HOUR_OF_DAY, 15);
  Date _7daysAgo = cal.getTime();
  
  Assert.assertEquals(0, MyAppUtil.diffDays(now, now));
  Assert.assertEquals(1, MyAppUtil.diffDays(yesterday,now));
  Assert.assertEquals(3, MyAppUtil.diffDays(_3daysAgo,now));
  Assert.assertEquals(7, MyAppUtil.diffDays(_7daysAgo,now));
  Assert.assertEquals(4, MyAppUtil.diffDays(_7daysAgo,_3daysAgo));
 }
 
 
 @Test(expected=IllegalArgumentException.class)
 public void testNegative1DiffDays() {
  Date now = new Date();
  
  Calendar cal = Calendar.getInstance();
  cal.setTime(now);
  
  cal.add(Calendar.DAY_OF_MONTH, -1);
  cal.set(Calendar.HOUR_OF_DAY, 00);
  Date yesterday = cal.getTime();
  
  Assert.assertEquals(1, MyAppUtil.diffDays(now,yesterday));
 }
 
 @Test(expected=IllegalArgumentException.class)
 public void testNegative2DiffDays() {
  Date now = new Date();
  
  Assert.assertEquals(1, MyAppUtil.diffDays(now,null));
 }

}
</pre>
<br/>
<br/>

<b>Note: </b>Working with dates can be tricky and you will need to consider things like:

<br/>
<br/>

1. Time zones.
2. Day light savings.
<div style="clear:both; padding-bottom:0.25em"></div><p class="blogger-labels">Labels: <a rel='tag' href="http://java-success.blogspot.com/search/label/Coding">Coding</a>, <a rel='tag' href="http://java-success.blogspot.com/search/label/Core%20Java">Core Java</a></p>
    </p>
    </div>
    
    <p class="post-footer">
      <em>posted by Arulkumaran Kumaraswamipillai at 
    <a class="post-footer-link" href="http://java-success.blogspot.in/2013/01/working-with-java-calendar-and-dates.html" title="permanent link"> 1/07/2013 07:35:00 PM </a></em>

       |
      <a class="comment-link" href="http://java-success.blogspot.in/2013/01/working-with-java-calendar-and-dates.html#comment-form"location.href=http://java-success.blogspot.com/2013/01/working-with-java-calendar-and-dates.html#comment-form;><span style="text-transform:lowercase">0 Comments</span></a>
      
<a class="comment-link" href="http://java-success.blogspot.in/2013/01/working-with-java-calendar-and-dates.html#links"><span style="text-transform:lowercase">Links to this post</span></a>

  <span class="item-action"><a href="https://www.blogger.com/email-post.g?blogID=35897879&postID=6115757426474297216" title="Email Post"><img class="icon-action" alt="" src="https://img2.blogblog.com/img/icon18_email.gif" height="13" width="18"/></a></span><span class="item-control blog-admin pid-341905326"><a style="border:none;" href="https://www.blogger.com/post-edit.g?blogID=35897879&postID=6115757426474297216&from=pencil" title="Edit Post"><img class="icon-action" alt="" src="https://img2.blogblog.com/img/icon18_edit_allbkg.gif" height="18" width="18"></a></span>
    </p>
  
  </div>
  <!-- End .post -->
  
  
  
  <!-- Begin #comments -->
 
  <!-- End #comments -->
  






<script type="text/javascript"><!--
google_ad_client = "pub-3764234023451771";
google_ad_host = "pub-1556223355139109";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al";
google_ad_channel = "";
//-->
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>


  <h2 class="date-header">Jan 3, 2013</h2>

  
  
     
  <!-- Begin .post -->
  <div class="post"><a name="742844087065187374"></a>
    
         
    


    <h3 class="post-title">
	 
	 Spring Integration -- polling for a file and processing the file
	 
    </h3>

    
     
    <div class="post-body">
    <p>
      <div style="clear:both;"></div><script type="text/javascript">
<!--
google_ad_client = "ca-pub-3764234023451771";
/* Leader board image and text */
google_ad_slot = "4890304945";
google_ad_width = 728;
google_ad_height = 90;
google_ad_channel ="4262872872";
google_page_url = "http://java-success.blogspot.com.au/p/core-java-q.html";
//
--></script>

<script src="http://pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script>

<br/>
<br/>



<b>Q. </b>What are the main differences and similarities between 
light-weight integration frameworks like Spring Integration, Apache 
Camel, etc and an ESB like Oracle Service Bus, Mule, etc?<br />
<br />
<br />
<b>A</b>. The core concepts are about the same, and based on the 
Enterprise integration patterns (EIP) book, and you can do the things 
mentioned there in the book. These are all about connectivity using 
different protocols, routing and messaging patterns, transformation, 
orchestration, business rules engine, and business and technical 
monitoring. The real difference lies where the ESBs are more powerful in
 the space of orchestration, business rules engine, and business 
monitoring compared to the light-weight integration frameworks.<br />
<br />
Some of the commercial ESBs provide graphical drag and drop feature for routing and orchestration to model the system. So, the ESBs are more suited for more complex orchestration and BPM (Business Process Management). These extra enterprise level flexibility and features do come at additional cost and effort.<br />
<br />
<b>Q</b>. Why do you need integration frameworks?Can you give an example where you used an integration framework?<br />
<br />
<b>A</b>. Data exchanges between and within companies are very common. The number of applications which must be integrated require different technologies, protocols and data formats to be handled uniformly and efficiently. There are 3  integration frameworks available in the JVM environment : Spring Integration, Mule ESB and Apache Camel. These frameworks implement the well-known <b>Enteprise Integration Patterns </b>(<b>EIP</b>) and therefore offer a standardized, domain-specific language (<b>DSL</b>) to integrate applications. These integration frameworks can be used in almost every integration project within the JVM environment – no matter  which technologies, transport protocols or data formats are used. If you know one of these frameworks, you can learn the others very easily as they use similar concepts. Each framework has its on pros and cons, it is always pays to do a "proof of concept" to see if it serves your purpose.<br />
<br />
This blog entry provides a simple example as to how to make use of <b>Spring integration </b>to<b> </b>write a file polling task. Spring integration framework is used for watching for file that ends with ".end" or ".END" in a given folder and once the file arrives, kick off a method to process that file.<br />
<br />
<b>Step 1</b>: Define the <b>applicationContext-myapp.xml </b>file to define the Spring integration channel, <i>MyappInputFileHandler </i>bean, etc.<br />
<br />
<pre class="brush: csharp"> 
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:batch="http://www.springframework.org/schema/batch"
 xmlns:task="http://www.springframework.org/schema/task" xmlns:context="http://www.springframework.org/schema/context"
 xmlns:tx="http://www.springframework.org/schema/tx" xmlns:aop="http://www.springframework.org/schema/aop"
 xmlns:int="http://www.springframework.org/schema/integration"
 xmlns:file="http://www.springframework.org/schema/integration/file"
 xmlns:util="http://www.springframework.org/schema/util"
 xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
 http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd
 http://www.springframework.org/schema/task http://www.springframework.org/schema/task/spring-task-3.0.xsd
 http://www.springframework.org/schema/batch http://www.springframework.org/schema/batch/spring-batch.xsd
 http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd
 http://www.springframework.org/schema/integration http://www.springframework.org/schema/integration/spring-integration-2.0.xsd
 http://www.springframework.org/schema/integration/file http://www.springframework.org/schema/integration/file/spring-integration-file-2.0.xsd
 http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-2.0.xsd
 http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd"&gt;


 &lt;context:property-placeholder location="classpath:myapp.properties" /&gt;
 &lt;tx:annotation-driven /&gt;

 &lt;!-- INTEGRATION BEANS --&gt;

 &lt;bean id="myappInputFileHandler"
  class="com.myapp.MyappInputFileHandler"&gt;
  &lt;constructor-arg value="${myapp.file.path}" /&gt;
  &lt;constructor-arg value="${myapp.file.regex}" /&gt;
 &lt;/bean&gt;
 
 &lt;int:channel id="fileIn"&gt;&lt;/int:channel&gt;

 &lt;file:inbound-channel-adapter id="inputChannelAdapter"
  channel="fileIn" directory="${myapp.file.path}"
  prevent-duplicates="false" filename-regex="${myapp.file.regex}"&gt;

  &lt;int:poller id="poller" fixed-delay="5000" /&gt;

 &lt;/file:inbound-channel-adapter&gt;


 &lt;int:service-activator id="inputFileServiceActivator"
  input-channel="fileIn" method="processFile" ref="myappInputFileHandler" /&gt;

  
&lt;/beans&gt; 
</pre>
<br />
<br />
<b>Step 2</b>: Define the <b>myapp.properties</b> file. These properties are used by both the spring context file and the <b><i>MyappInputFileHandler </i></b>Java class. <br />
<pre class="brush: csharp"> 
#read from within spring context file
myapp.file.path=C:\\TEMP\\myapp\\
myapp.file.regex=.*\\.(end|END)

#properties read from the MyappInputFileHandler
cashforecast.job.lock.retry.count=5
cashforecast.job.lock.retry.wait.duration=20000
</pre>
<br />
<br />
<b>Step 3</b>: The final step is to define the <b><i>MyappInputFileHandler </i></b> class and the <i>processFile(..) </i>method that gets invoked.<br />
<pre class="brush: csharp"> 
package com.myapp;

import java.io.File;
import java.io.IOException;
import java.util.concurrent.Semaphore;

import org.apache.commons.io.FileUtils;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Value;


public class MyappInputFileHandler {

 private final static Logger logger = LoggerFactory.getLogger(MyappInputFileHandler.class);

 private static final String CSV_EXT = ".CSV";
 private static final String METACSV_EXT = ".META_CSV";

 private static final Semaphore mutex = new Semaphore(1);

 @Value("${myapp.job.lock.retry.wait.duration}")
 private long lockRetryWaitDuration;

 @Value("${myapp.job.lock.retry.count}")
 private long lockRetryCount;

 public MyappInputFileHandler(String path, String fileRegEx) {

  logger.info("Launching Job CashForecasting. Polling Folder: ".concat(path).concat(" for file ").concat(fileRegEx));
 }

 public void processFile(File file) {
  try {
   String fileNameNoExtension = file.getAbsolutePath().substring(0, file.getAbsolutePath().length() - 8);

   // Delete .end file and Move .META_CSV and .CSV File to process
   // folder
   mutex.acquire();

   File csvFile = new File(fileNameNoExtension.concat(CSV_EXT));
   File metaCsvFile = new File(fileNameNoExtension.concat(METACSV_EXT));
   file.delete();

   mutex.release();

   // Create Lock File
   File lockFile = createLockFile(csvFile);

   // further file processing ....................

  } catch (Exception ex) {
   logger.error("Error processing myapp: ", ex);
   throw new RuntimeException(ex);
  }
 }

 private File createLockFile(File csvFile) {

  if (!csvFile.exists()) {
   throw new RuntimeException("File not found: " + csvFile.getAbsolutePath());
  }

  String feedKey = "some key";

  File lockFile = new File(csvFile.getParent() + File.separator + feedKey.concat(".lock"));
  boolean fileCreated = false;

  int count = 0;
  while (lockFile.exists()) {
   try {
    Thread.sleep(lockRetryWaitDuration);
   } catch (InterruptedException e) {
    logger.error("Interrupted ", e);
   }

   if (++count &gt; lockRetryCount) {
    throw new RuntimeException("Timedout acquiring a lock file for file : " + csvFile.getAbsolutePath() + " and "
      + "input data: " + feedKey);
   }
  }

  try {
      //Apache io library 
   FileUtils.touch(lockFile);
  } catch (IOException e) {
   logger.error("Error creating a lock file: " + lockFile.getAbsolutePath(), e);
   throw new RuntimeException(e);
  }

  if (logger.isDebugEnabled() &amp;&amp; fileCreated) {
   logger.debug("Lock file created: " + lockFile.getAbsolutePath());
  }

  return lockFile;

 }

}
</pre>
<br />
<br />
Another alternative to achieve similar behavior is to use <i><b>Apache Camel</b></i>.&nbsp; Both Apache Camel and Spring Integration are light weight integration frameworks. It is very common in polling for a file in batch processes. Spring batch is a good fit for writing batch jobs in Java. You could also use this approach to transfer internal data files to/from external parties which usually requires format conversions and sending it using ftp/sftp/scp, etc or attaching it to an email and sending it out. <br />
<br />
Another typical use case is to write your own automated custom end to end application integration testing framework using a light weight integration testing framework like Apache Camel. Your custom integration testing framework will have routes defined&nbsp; for testing different tasks in an end to end manner. <br />
<br />
1. Extracting files from System A.<br />
2. Transforming the extracts to format that Systems B and C&nbsp; can understand.<br />
3. Publish the message to a JMS queue so that Systems B and C can load that data &nbsp; into their databases.<br />
4. Invoke a RESTful Web Service on System B to produce a report that needs to be emailed to a number of recipients.<br />
<br />
So, good knowledge of integration frameworks like <i><b>Spring Integration</b></i>, <i><b>Apache Camel,</b></i> etc and enterprise service buses like <i><b>Mule </b></i>will be a plus to sell yourself in the job interviews.<br />
<br />
<br /><div style="clear:both; padding-bottom:0.25em"></div><p class="blogger-labels">Labels: <a rel='tag' href="http://java-success.blogspot.com/search/label/Spring">Spring</a>, <a rel='tag' href="http://java-success.blogspot.com/search/label/Spring%20Integration">Spring Integration</a></p>
    </p>
    </div>
    
    <p class="post-footer">
      <em>posted by Arulkumaran Kumaraswamipillai at 
    <a class="post-footer-link" href="http://java-success.blogspot.in/2013/01/spring-integration-polling-for-file-and.html" title="permanent link"> 1/03/2013 06:14:00 PM </a></em>

       |
      <a class="comment-link" href="http://java-success.blogspot.in/2013/01/spring-integration-polling-for-file-and.html#comment-form"location.href=http://java-success.blogspot.com/2013/01/spring-integration-polling-for-file-and.html#comment-form;><span style="text-transform:lowercase">0 Comments</span></a>
      
<a class="comment-link" href="http://java-success.blogspot.in/2013/01/spring-integration-polling-for-file-and.html#links"><span style="text-transform:lowercase">Links to this post</span></a>

  <span class="item-action"><a href="https://www.blogger.com/email-post.g?blogID=35897879&postID=742844087065187374" title="Email Post"><img class="icon-action" alt="" src="https://img2.blogblog.com/img/icon18_email.gif" height="13" width="18"/></a></span><span class="item-control blog-admin pid-341905326"><a style="border:none;" href="https://www.blogger.com/post-edit.g?blogID=35897879&postID=742844087065187374&from=pencil" title="Edit Post"><img class="icon-action" alt="" src="https://img2.blogblog.com/img/icon18_edit_allbkg.gif" height="18" width="18"></a></span>
    </p>
  
  </div>
  <!-- End .post -->
  
  
  
  <!-- Begin #comments -->
 
  <!-- End #comments -->
  






<script type="text/javascript"><!--
google_ad_client = "pub-3764234023451771";
google_ad_host = "pub-1556223355139109";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al";
google_ad_channel = "";
//-->
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>


  <h2 class="date-header">Jan 2, 2013</h2>

  
  
     
  <!-- Begin .post -->
  <div class="post"><a name="2044147097065475819"></a>
    
         
    


    <h3 class="post-title">
	 
	 Java writing code -- compare two CSV files in Java
	 
    </h3>

    
     
    <div class="post-body">
    <p>
      <div style="clear:both;"></div><b>Q</b>. How will you go about writing code for a scenario where you need to compare two <b>CSV </b>files? assume that both CSV files are converted to "<i>List<string></string></i><string>" for both target and generate. Duplicate entries are allowed, and you need to list differences between the target file and the generated file.</string><br />
<br />
<b>A</b>.&nbsp; You can use a CSV framework like <i><b>OpenCSV </b></i>to convert a csv file to <i>List<string></string></i>. The method below tales this list compare the values.<br />
<br />

<table>
<tbody>
<tr>

<td width="50%"><script type="text/javascript"><!--
google_ad_client = "ca-pub-3764234023451771";
/* LHS - Medium Rectangle */
google_ad_slot = "1728948974";
google_ad_width = 336;
google_ad_height = 280;
google_ad_channel ="6353655268";
google_page_url = "http://java-success.blogspot.com.au/2011/09/java-multi-threading-interview.html";
//-->
</script>
<script src="http://pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script>
</td>
<td>

<b>Possible scenarios are</b><br /><br />
<ul>
<li>Target and generated files could have different no of records</li>
<li>Target and generated files could have same no of records but the content might be different</li>
<li>Generated file could have a few rows removed ( this is treated as record deleted)</li>
<li>Generated file could have a few new rows added ( this is treated as record inserted)</li>
<li>With or without duplicate records </li>
</ul>
<br/>
<br/>
One approach to doing this would be to use Java's Set interface (e.g. Set<String[]>) and , then do a removeAll() with the target set on the generated set, thus retaining the rows which differ. This, of course, assumes that there are no duplicate rows in the files.
</td>
</tr>
</tbody>
</table>
<br/>
<br/>
<pre class="brush: csharp"> 
// using FileUtils to read in the files.
HashSet&lt;String[]&gt; target = new HashSet&lt;String[]&gt;();
//...populate target via OpenCSV
HashSet&lt;String[]&gt; generated = new HashSet&lt;String[]&gt;();
//...populate generated via OpenCSV
generated.removeAll(target); // generated now contains only the lines which are not in target
</pre>
<br/>
<br/>
The above solution would not work if duplicates are allowed. Here is the one possible solution when there are duplicates.

<br/>

Firstly, write down the logical steps before start coding
<br/>
<br/>
<b>1. </b>Compare the number of items in both target and generated lists. <br/>
<b>2.</b> If the number of items are same, compare each item.<br/>
<b>3. </b>If no if items or any contents of individual items differ, the contents are not same, and identify the contents that differ.<br/>

<br/>
<br/>

<b>3.1</b>. To identify the contents that differ, both the target and generated lists need to be sorted.<br/>
<b>3.2</b>. Loop through and compare each item from both the lists. If either all the target or generated list has been completed exit the loop.<br/>
<b>3.3</b>. If there are any target or generated items not processed yet, process them in a new loop.

<br/>

<br/>
<b>3.2.1</b> Inside the loop 3.2, there are 3 possible outcomes. <br/>
<br/>
<b>A.</b> The item is in target but not in generated.<br/>
<b>B.</b> The item is in both target and generated. <br/>
<b>C.</b> The item is not in generated but is in target.<br/>


<br/>
<br/>

The <b>compareTo(..)</b> method is used as it will return 0, -1, or 1 meaning contents are equal, target is less than generated, and target is greater than the generated.

<br/>
<br/>
<pre class="brush: csharp"> 

package com.myapp.compare;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collections;
import java.util.Comparator;
import java.util.List;

import org.springframework.stereotype.Component;

@Component(value = "simpleCSVCompare")
public class SimpleCSVCompareImpl implements SimpleCSVCompare {

 
 //compare target and generated CSV lines
 public CSVCompareResult compareCSVLines(List&lt;String[]&gt; targetLines, List&lt;String[]&gt; generatedLines, CSVCompareResult result){
  
  //Step1: Number of lines differ
  if(targetLines.size() != generatedLines.size()){
   result.addMismatchingLines("Line sizes don't match: " + " target=" + targetLines.size() + ", generated=" + generatedLines.size());
   result.setStatus(CSVCompareResult.FileCompareStatus.UNMATCHED);
  }
  
  //Step 2: Contents differ
  if(targetLines.size() == generatedLines.size()){
   for (int i = 0; i &lt; targetLines.size(); i++) {
    String[] targetLine = targetLines.get(i);
    String[] genLine = generatedLines.get(i);
    
    if(!Arrays.deepEquals(targetLine, genLine)){
     result.addMismatchingLines("Line contents don't match.");
     result.setStatus(CSVCompareResult.FileCompareStatus.UNMATCHED);
     break;
    } 
   }
  }
  
  //Step 3: Identify the differing lines
  if(CSVCompareResult.FileCompareStatus.UNMATCHED == result.getStatus()){
   sortedList(targetLines);
   sortedList(generatedLines);
   evaluateCSVLineDifferences(targetLines,generatedLines,result);
  }
  
  return result;
  
 }
 
 public CSVCompareResult evaluateCSVLineDifferences(List&lt;String[]&gt; targetLines, List&lt;String[]&gt; generatedLines, CSVCompareResult result) {

  result.setNoOfGeneratedLines(generatedLines.size());
  result.setNoOfTargetLines(targetLines.size());

  int genIndex = 0;
  int targIndex = 0;

  String[] lineTarget = targetLines.get(targIndex);
  String[] lineGen = generatedLines.get(genIndex);

  boolean targetDone = false;
  boolean generatedDone = false;

  while (!targetDone &amp;&amp; !generatedDone) {

   //target line is less than the generated line
   if (Arrays.deepToString(lineTarget).compareTo(Arrays.deepToString(lineGen)) &lt; 0) {
    while (Arrays.deepToString(lineTarget).compareTo(Arrays.deepToString(lineGen)) &lt; 0 &amp;&amp; !targetDone) {
     result.addMismatchingLines("TARGET:" + Arrays.deepToString(lineTarget));
     if (targIndex &lt; targetLines.size() - 1) {
      lineTarget = targetLines.get(++targIndex);
     } else {
      targetDone = true;
     }
    }

   //target and generated lines are same 
   } else if (Arrays.deepToString(lineTarget).compareTo(Arrays.deepToString(lineGen)) == 0) {
    if (targIndex &lt; targetLines.size() - 1) {
     lineTarget = targetLines.get(++targIndex);
    } else {
     targetDone = true;
    }
    if (genIndex &lt; generatedLines.size() - 1) {
     lineGen = generatedLines.get(++genIndex);
    } else {
     generatedDone = true;
    }

   //target line is greater than the generated line 
   } else if (Arrays.deepToString(lineTarget).compareTo(Arrays.deepToString(lineGen)) &gt; 0) {
    while (Arrays.deepToString(lineTarget).compareTo(Arrays.deepToString(lineGen)) &gt; 0 &amp;&amp; !generatedDone) {
     result.addMismatchingLines("GENERATED:" + Arrays.deepToString(lineGen));
     if (genIndex &lt; generatedLines.size() - 1) {
      lineGen = generatedLines.get(++genIndex);
     } else {
      generatedDone = true;
     }
    }
   }

  }

  //process any target lines not processed
  while (!targetDone) {
   result.addMismatchingLines("TARGET:" + Arrays.deepToString(lineTarget));
   if (targIndex &lt; targetLines.size() - 1) {
    lineTarget = targetLines.get(++targIndex);
   } else {
    targetDone = true;
   }
  }

  //process any generated lines not processed
  while (!generatedDone) {
   result.addMismatchingLines("GENERATED:" + Arrays.deepToString(lineGen));
   if (genIndex &lt; generatedLines.size() - 1) {
    lineGen = generatedLines.get(++genIndex);
   } else {
    generatedDone = true;
   }
  }

  return result;
 }
 
 
 public void sortedList(List&lt;String[]&gt; input){
   Collections.sort(input, new Comparator&lt;String[]&gt;() {

   @Override
   public int compare(String[] o1, String[] o2) {
    return Arrays.deepToString(o1).compareTo(Arrays.deepToString(o2));
   }
  });
   
 }

 public static void main(String[] args) {
  String[] targA1 = { "a1" };
  String[] genA1 = { "a1" };

  String[] targA2 = { "a2" };
  String[] genA2 = { "a2" };

  String[] targA3 = { "a3" };
  String[] genA3 = { "a3" };

  String[] targA4 = { "a4" };
  String[] genA4 = { "a4" };

  String[] targA5 = { "a5" };

  String[] genA6 = { "a6" };

  List&lt;String[]&gt; targetLines = new ArrayList&lt;String[]&gt;();
  List&lt;String[]&gt; generatedLines = new ArrayList&lt;String[]&gt;();

  targetLines.add(targA1);
  targetLines.add(targA2);
  targetLines.add(targA2);
  targetLines.add(targA3);
  targetLines.add(targA4);
  targetLines.add(targA5);

  generatedLines.add(genA1);
  generatedLines.add(genA2);
  generatedLines.add(genA3);
  generatedLines.add(genA4);
  generatedLines.add(genA6);

  CSVCompareResult result = new CSVCompareResult();

  new SimpleCSVCompareImpl().evaluateCSVLineDifferences(targetLines, generatedLines, result);

  System.out.println(result.getMismatchingLines());

 }

}

</pre>
<br />
The results can be added to a value object like

<br />
<br />
<pre class="brush: csharp"> 
package com.myapp.compare;

import java.util.ArrayList;
import java.util.List;

public class CSVCompareResult {

 public enum FileCompareStatus {
  MATCHED, UNMATCHED
 };

 private String generatedFileName;
 private String targetFileName;
 private int noOfTargetLines;
 private int noOfGeneratedLines;
 private FileCompareStatus status = FileCompareStatus.MATCHED;

 private List&lt;String&gt; mismatchingLines = new ArrayList&lt;String&gt;(20);

 public String getGeneratedFileName() {
  return generatedFileName;
 }

 public void setGeneratedFileName(String generatedFileName) {
  this.generatedFileName = generatedFileName;
 }

 public String getTargetFileName() {
  return targetFileName;
 }

 public void setTargetFileName(String targetFileName) {
  this.targetFileName = targetFileName;
 }

 public int getNoOfTargetLines() {
  return noOfTargetLines;
 }

 public void setNoOfTargetLines(int noOfTargetLines) {
  this.noOfTargetLines = noOfTargetLines;
 }

 public int getNoOfGeneratedLines() {
  return noOfGeneratedLines;
 }

 public void setNoOfGeneratedLines(int noOfGeneratedLines) {
  this.noOfGeneratedLines = noOfGeneratedLines;
 }

 public List&lt;String&gt; getMismatchingLines() {
  return mismatchingLines;
 }

 public void setMismatchingLines(List&lt;String&gt; mismatchingLineNumbers) {
  this.mismatchingLines = mismatchingLineNumbers;
 }

 public void addMismatchingLines(String lineNumber) {
  mismatchingLines.add(lineNumber);
 }

 public FileCompareStatus getStatus() {
  return status;
 }

 public void setStatus(FileCompareStatus status) {
  this.status = status;
 }
 
 public String outputResultsAsString(){
  StringBuilder sb = new StringBuilder();
  sb.append("Files Compared: " + " target=" + targetFileName + ", generated=" + generatedFileName);
  sb.append("\n");
  sb.append("Status:" + status);
  sb.append("\n");
  
  List&lt;String&gt; mismatchingLines = getMismatchingLines();
  
  for (String msg : mismatchingLines) {
   sb.append(msg);
   sb.append("\n");
  }
  
  return sb.toString();
 }

}

</pre>
<br />
<br /><div style="clear:both; padding-bottom:0.25em"></div><p class="blogger-labels">Labels: <a rel='tag' href="http://java-success.blogspot.com/search/label/Coding">Coding</a>, <a rel='tag' href="http://java-success.blogspot.com/search/label/Core%20Java">Core Java</a></p>
    </p>
    </div>
    
    <p class="post-footer">
      <em>posted by Arulkumaran Kumaraswamipillai at 
    <a class="post-footer-link" href="http://java-success.blogspot.in/2013/01/java-writing-code-compare-two-csv-files.html" title="permanent link"> 1/02/2013 11:53:00 AM </a></em>

       |
      <a class="comment-link" href="http://java-success.blogspot.in/2013/01/java-writing-code-compare-two-csv-files.html#comment-form"location.href=http://java-success.blogspot.com/2013/01/java-writing-code-compare-two-csv-files.html#comment-form;><span style="text-transform:lowercase">2 Comments</span></a>
      
<a class="comment-link" href="http://java-success.blogspot.in/2013/01/java-writing-code-compare-two-csv-files.html#links"><span style="text-transform:lowercase">Links to this post</span></a>

  <span class="item-action"><a href="https://www.blogger.com/email-post.g?blogID=35897879&postID=2044147097065475819" title="Email Post"><img class="icon-action" alt="" src="https://img2.blogblog.com/img/icon18_email.gif" height="13" width="18"/></a></span><span class="item-control blog-admin pid-341905326"><a style="border:none;" href="https://www.blogger.com/post-edit.g?blogID=35897879&postID=2044147097065475819&from=pencil" title="Edit Post"><img class="icon-action" alt="" src="https://img2.blogblog.com/img/icon18_edit_allbkg.gif" height="18" width="18"></a></span>
    </p>
  
  </div>
  <!-- End .post -->
  
  
  
  <!-- Begin #comments -->
 
  <!-- End #comments -->
   

</div></div>
<!-- End #main -->







<!-- Begin #sidebar -->
<div id="sidebar"><div id="sidebar2">

  
  
  <h2 class="sidebar-title">Previous Posts</h2>
    <ul id="recently">
    
        <li><a href="http://java-success.blogspot.in/2014/11/are-you-java-beginner-why-good-java.html">Are you a Java beginner? Why good Java developers ...</a></li>
     
        <li><a href="http://java-success.blogspot.in/2014/11/java-exception-handling-beginner.html">Java exception handling beginner mistakes and best...</a></li>
     
        <li><a href="http://java-success.blogspot.in/2014/11/unix-interview-questions-and-answers.html">Unix Interview Questions and Answers for Java deve...</a></li>
     
        <li><a href="http://java-success.blogspot.in/2014/10/debugging-and-working-like-pro-with.html">Debugging and working  like a pro with a Java appl...</a></li>
     
        <li><a href="http://java-success.blogspot.in/2014/10/yammer-metrics-to-monitor-restful-web_22.html">Yammer metrics to monitor RESTful web services and...</a></li>
     
        <li><a href="http://java-success.blogspot.in/2014/10/when-to-use-which-java-collection-or.html">When to use which Java collection or data structur...</a></li>
     
        <li><a href="http://java-success.blogspot.in/2011/09/how-to-prepare-for-javajee-job.html">How to prepare or train for Java and JEE Job Inter...</a></li>
     
        <li><a href="http://java-success.blogspot.in/2014/10/yammer-metrics-to-monitor-restful-web.html">Yammer metrics to monitor RESTful web services wit...</a></li>
     
        <li><a href="http://java-success.blogspot.in/2014/09/monitoring-and-gathering-statistics.html">Monitoring and gathering statistics with JMX based...</a></li>
     
        <li><a href="http://java-success.blogspot.in/2014/08/what-are-different-ways-java-thread.html">What are the different ways a Java thread gets blo...</a></li>
     
  </ul>
  
  
  
  <h2 class="sidebar-title">Archives</h2>

    <ul class="archive-list">
   	  
    	<li><a href="http://java-success.blogspot.in/2006_10_01_archive.html">October 2006</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2006_11_01_archive.html">November 2006</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2007_05_01_archive.html">May 2007</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2007_10_01_archive.html">October 2007</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2007_12_01_archive.html">December 2007</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2008_08_01_archive.html">August 2008</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2010_02_01_archive.html">February 2010</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2010_10_01_archive.html">October 2010</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2010_11_01_archive.html">November 2010</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2010_12_01_archive.html">December 2010</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2011_01_01_archive.html">January 2011</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2011_07_01_archive.html">July 2011</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2011_09_01_archive.html">September 2011</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2011_10_01_archive.html">October 2011</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2011_11_01_archive.html">November 2011</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2011_12_01_archive.html">December 2011</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2012_01_01_archive.html">January 2012</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2012_02_01_archive.html">February 2012</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2012_03_01_archive.html">March 2012</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2012_04_01_archive.html">April 2012</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2012_05_01_archive.html">May 2012</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2012_06_01_archive.html">June 2012</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2012_07_01_archive.html">July 2012</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2012_08_01_archive.html">August 2012</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2012_09_01_archive.html">September 2012</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2012_10_01_archive.html">October 2012</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2012_11_01_archive.html">November 2012</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2012_12_01_archive.html">December 2012</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2013_01_01_archive.html">January 2013</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2013_02_01_archive.html">February 2013</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2013_03_01_archive.html">March 2013</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2013_04_01_archive.html">April 2013</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2013_05_01_archive.html">May 2013</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2013_06_01_archive.html">June 2013</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2013_07_01_archive.html">July 2013</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2013_08_01_archive.html">August 2013</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2013_09_01_archive.html">September 2013</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2013_10_01_archive.html">October 2013</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2013_11_01_archive.html">November 2013</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2013_12_01_archive.html">December 2013</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2014_01_01_archive.html">January 2014</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2014_02_01_archive.html">February 2014</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2014_03_01_archive.html">March 2014</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2014_04_01_archive.html">April 2014</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2014_05_01_archive.html">May 2014</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2014_06_01_archive.html">June 2014</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2014_07_01_archive.html">July 2014</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2014_08_01_archive.html">August 2014</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2014_09_01_archive.html">September 2014</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2014_10_01_archive.html">October 2014</a></li>
	  
    	<li><a href="http://java-success.blogspot.in/2014_11_01_archive.html">November 2014</a></li>
	  

  </ul>
  
  
  
  <!-- Begin #profile-container -->
  
    <div id="profile-container"><h2 class="sidebar-title">About Me</h2>
<dl class="profile-datablock"><dt class="profile-img"><a href="https://plus.google.com/109240621969095737337"><img src="//lh3.googleusercontent.com/-XMLxx0v_R7A/AAAAAAAAAAI/AAAAAAAACxk/8BeHFmsEuy8/s80-c/photo.jpg" width="80" height="80" alt="My Photo"></a></dt>
<dd class="profile-data"><strong>Name:</strong> <a rel="author" href="https://plus.google.com/109240621969095737337"> Arulkumaran Kumaraswamipillai </a></dd>
</dl>
<p class="profile-textblock">Java freelancer from Australia. As a contractor, attended 100+ job interviews and received multiple job offers. Authored Java career books that sold over 30,000 copies.<br><br><a href="http://www.java-success.com" rel="nofollow" target="_blank">www.java-success.com</a> for 500+ Java/JEE job interview questions and answers and tutorials.<br></p>
<p class="profile-link"><a rel="author" href="https://plus.google.com/109240621969095737337">View my complete profile</a></p></div>
  
  <!-- End #profile -->

  
  <p id="powered-by"><a href="http://www.blogger.com"><img src="http://buttons.blogger.com/bloggerbutton1.gif" alt="Powered by Blogger" /></a></p>
  <p id="blogfeeds">Subscribe to<br />Posts [<a target="_blank" href="http://java-success.blogspot.com/feeds/posts/default" type="application/atom+xml">Atom</a>]</p>

  <script type="text/javascript"><!--
google_ad_client = "pub-3764234023451771";
google_ad_host = "pub-1556223355139109";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>  
   
  <!--
  <p>This is a paragraph of text that could go in the sidebar.</p>
  -->
  
  <script type="text/javascript"><!--
google_ad_client = "pub-3764234023451771";
google_ad_host = "pub-1556223355139109";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>  



</div></div>
<!-- End #sidebar -->




<!-- Begin #footer -->
<div id="footer"><hr />

  <p><!-- This is an optional footer. If you want text here, place it inside these tags, and remove this comment. -->&nbsp;</p>

  </div>
<!-- End #footer -->




</div>
<!-- End #content -->






</div></div></div></div>
<!-- End wraps -->

</body>
</html>